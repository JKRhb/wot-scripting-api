<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.7.27">
  <meta charset="utf-8">
  <meta name="generator" content="ReSpec 25.18.3">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1, shrink-to-fit=no">
  <style>
  span.example-title{text-transform:none}
  aside.example,div.example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
  div.illegal-example{color:red}
  div.illegal-example p{color:#000}
  aside.example,div.example{padding:.5em;border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
  aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
  aside.example div.example span.example-title{color:#999}
  </style>
  <style>
  .issue-label{text-transform:initial}
  .warning>p:first-child{margin-top:0}
  .warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
  span.warning{padding:.1em .5em .15em}
  .issue.closed span.issue-number{text-decoration:line-through}
  .warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
  .warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
  li.task-list-item{list-style:none}
  input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
  .issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
  </style>
  <style>
  pre.idl{padding:1em;position:relative}
  @media print{
  pre.idl{white-space:pre-wrap}
  }
  .idlHeader{display:block;width:150px;background:#8ccbf2;color:#fff;font-family:sans-serif;font-weight:700;margin:-1em 0 1em -1em;height:28px;line-height:28px}
  .idlHeader a.self-link{margin-left:.3cm;text-decoration:none;border-bottom:none}
  .idlID{font-weight:700;color:#005a9c}
  .idlType{color:#005a9c}
  .idlName{color:#ff4500}
  .idlName a{color:#ff4500;border-bottom:1px dotted #ff4500;text-decoration:none}
  a.idlEnumItem{color:#000;border-bottom:1px dotted #ccc;text-decoration:none}
  .idlSuperclass{font-style:italic;color:#005a9c}
  .idlDefaultValue,.idlParamName{font-style:italic}
  .extAttr{color:#666}
  .idlSectionComment{color:gray}
  .idlIncludes a{font-weight:700}
  .respec-button-copy-paste:focus{text-decoration:none;border-color:#51a7e8;outline:0;box-shadow:0 0 5px rgba(81,167,232,.5)}
  .respec-button-copy-paste.selected:focus,.respec-button-copy-paste:focus:hover{border-color:#51a7e8}
  .respec-button-copy-paste.zeroclipboard-is-active,.respec-button-copy-paste.zeroclipboard-is-hover,.respec-button-copy-paste:active,.respec-button-copy-paste:hover{text-decoration:none;background-color:#ddd;background-image:linear-gradient(#eee,#ddd);border-color:#ccc}
  .respec-button-copy-paste.selected,.respec-button-copy-paste.zeroclipboard-is-active,.respec-button-copy-paste:active{background-color:#dcdcdc;background-image:none;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}
  .respec-button-copy-paste.selected:hover{background-color:#cfcfcf}
  .respec-button-copy-paste.disabled,.respec-button-copy-paste.disabled:hover,.respec-button-copy-paste:disabled,.respec-button-copy-paste:disabled:hover{color:rgba(102,102,102,.5);cursor:default;background-color:rgba(229,229,229,.5);background-image:none;border-color:rgba(197,197,197,.5);box-shadow:none}
  @media print{
  .respec-button-copy-paste{visibility:hidden}
  }
  </style>
  <style>
  dfn{cursor:pointer}
  .dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font:small Helvetica Neue,sans-serif,Droid Sans Fallback;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
  .dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
  .dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
  .dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
  .dfn-panel *{margin:0}
  .dfn-panel b{display:block;color:#000;margin-top:.25em}
  .dfn-panel ul a[href]{color:#333}
  .dfn-panel>div{display:flex}
  .dfn-panel a.self-link{font-weight:700;margin-right:auto}
  .dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
  .dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
  .dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
  .dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
  .dfn-panel a[href]:hover{border-bottom-width:1px}
  .dfn-panel ul{padding:0}
  .dfn-panel li{margin-left:1em}
  .dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
  </style>
  <title>Web of Things (WoT) Scripting API</title>
  <style id="respec-mainstyle">
  @keyframes pop{
  0%{transform:scale(1,1)}
  25%{transform:scale(1.25,1.25);opacity:.75}
  100%{transform:scale(1,1)}
  }
  .hljs{background:0 0!important}
  a abbr,h1 abbr,h2 abbr,h3 abbr,h4 abbr,h5 abbr,h6 abbr{border:none}
  dfn{font-weight:700}
  a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
  a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
  a.bibref{text-decoration:none}
  .respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
  .respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
  @supports not (text-decoration:red wavy underline){
  .respec-offending-element:not(pre){display:inline-block}
  .respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
  }
  #references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
  cite .bibref{font-style:normal}
  code{color:#c63501}
  th code{color:inherit}
  a[href].orcid{padding-left:4px;padding-right:4px}
  a[href].orcid>svg{margin-bottom:-2px}
  .toc a,.tof a{text-decoration:none}
  a .figno,a .secno{color:#000}
  ol.tof,ul.tof{list-style:none outside none}
  .caption{margin-top:.5em;font-style:italic}
  table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
  .simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
  .simple th a{color:#fff;padding:3px 5px;text-align:left}
  .simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
  .simple td{padding:3px 10px;border-top:1px solid #ddd}
  .simple tr:nth-child(even){background:#f0f6ff}
  .section dd>p:first-child{margin-top:0}
  .section dd>p:last-child{margin-bottom:0}
  .section dd{margin-bottom:1em}
  .section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
  #issue-summary>ul{column-count:2}
  #issue-summary li{list-style:none;display:inline-block}
  details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
  details.respec-tests-details>*{padding-right:2em}
  details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
  details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
  details.respec-tests-details>ul{width:100%;margin-top:-.3em}
  details.respec-tests-details>li{padding-left:1em}
  a[href].self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
  h2,h3,h4,h5,h6{position:relative}
  aside.example .marker>a.self-link{color:inherit}
  h2>a.self-link,h3>a.self-link,h4>a.self-link,h5>a.self-link,h6>a.self-link{border:none;color:inherit;font-size:83%;height:2em;left:-1.6em;opacity:.5;position:absolute;text-align:center;text-decoration:none;top:0;transition:opacity .2s;width:2em}
  h2>a.self-link::before,h3>a.self-link::before,h4>a.self-link::before,h5>a.self-link::before,h6>a.self-link::before{content:"§";display:block}
  @media (max-width:767px){
  dd{margin-left:0}
  h2>a.self-link,h3>a.self-link,h4>a.self-link,h5>a.self-link,h6>a.self-link{left:auto;top:auto}
  }
  @media print{
  .removeOnSave{display:none}
  }
  </style>
  <meta name="description" content=
  "The Web of Things is made of entities (Things) that can describe their capabilities in a machine-interpretable Thing Description (TD) and expose these capabilities through the WoT Interface, that is, network interactions modeled as Properties (for reading and writing values), Actions (to execute remote procedures with or without return values) and Events (for signaling notifications).">
  <link rel="canonical" href=
  "https://www.w3.org/TR/wot-scripting-api/">
  <style>
  .hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
  .hljs-comment,.hljs-quote{color:#717277;font-style:italic}
  .hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
  .hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
  .hljs-literal{color:#0b76c5}
  .hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
  .hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
  .hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
  .hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
  .hljs-emphasis{font-style:italic}
  .hljs-strong{font-weight:700}
  .hljs-link{text-decoration:underline}
  </style>
  <style>
  var{position:relative;cursor:pointer}
  var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
  var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
  var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
  var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
  </style>
  <script id="initialUserConfig" type="application/json">
  {
  "specStatus": "NOTE",
  "shortName": "wot-scripting-api",
  "group": "wg/wot",
  "copyrightStart": 2017,
  "noLegacyStyle": true,
  "publishDate": "",
  "previousPublishDate": "",
  "previousMaturity": "",
  "edDraftURI": "https://w3c.github.io/wot-scripting-api/",
  "crEnd": "",
  "inlineCSS": true,
  "noIDLIn": true,
  "editors": [
    {
      "name": "Zoltan Kis",
      "w3cid": "57789",
      "company": "Intel",
      "companyURL": "https://www.intel.com/"
    },
    {
      "name": "Daniel Peintner",
      "w3cid": "39497",
      "company": "Siemens AG",
      "companyURL": "https://www.siemens.com/"
    },
    {
      "name": "Cristiano Aguzzi",
      "w3cid": "105495",
      "company": "Invited Expert",
      "companyURL": "https://github.com/relu91"
    },
    {
      "name": "Johannes Hund",
      "w3cid": "74472",
      "note": "Former Editor, when at Siemens AG"
    },
    {
      "name": "Kazuaki Nimura",
      "w3cid": "59208",
      "note": "Former Editor, at Fujitsu Ltd."
    }
  ],
  "issueBase": "https://www.github.com/w3c/wot-scripting-api/issues/",
  "githubAPI": "https://api.github.com/repos/w3c/wot-scripting-api",
  "otherLinks": [
    {
      "key": "Repository",
      "data": [
        {
          "value": "On GitHub",
          "href": "https://github.com/w3c/wot-scripting-api"
        },
        {
          "value": "File a bug",
          "href": "https://github.com/w3c/wot-scripting-api/issues"
        }
      ]
    },
    {
      "key": "Contributors",
      "data": [
        {
          "value": "Contributors on GitHub",
          "href": "https://github.com/w3c/wot-scripting-api/graphs/contributors"
        }
      ]
    }
  ],
  "xref": [
    "web-platform",
    "streams",
    "wot-architecture",
    "wot-thing-description",
    "wot-binding-templates"
  ],
  "localBiblio": {
    "WOT-ARCHITECTURE": {
      "href": "https://www.w3.org/TR/2020/REC-wot-architecture-20200409/",
      "title": "Web of Things Architecture",
      "publisher": "W3C",
      "date": "9 April 2020",
      "id": "wot-architecture"
    },
    "WOT-TD": {
      "href": "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/",
      "title": "Web of Things Thing Description",
      "publisher": "W3C",
      "date": "9 April 2020",
      "id": "wot-td"
    },
    "WOT-PROTOCOL-BINDINGS": {
      "href": "https://w3c.github.io/wot-binding-templates/",
      "title": "Web of Things Binding Templates",
      "publisher": "W3C",
      "date": "22 July 2020",
      "id": "wot-protocol-bindings"
    },
    "WOT-SECURITY": {
      "href": "https://w3c.github.io/wot-security/",
      "title": "Web of Things Security and Privacy Guidelines",
      "publisher": "W3C",
      "date": "11 August 2020",
      "id": "wot-security"
    },
    "TYPESCRIPT": {
      "href": "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md",
      "title": "TypeScript Language Specification",
      "publisher": "Microsoft",
      "date": "1 October 2012",
      "id": "typescript"
    },
    "WEBAPPSEC": {
      "href": "https://w3c.github.io/webappsec/specs/powerfulfeatures",
      "title": "Secure Contexts",
      "publisher": "W3C",
      "date": "17 July 2015",
      "id": "webappsec"
    }
  },
  "publishISODate": "2020-11-24T00:00:00.000Z",
  "generatedSubtitle": "Working 24 November 2020"
  }
  </script>
  <link rel="stylesheet" href=
  "https://www.w3.org/StyleSheets/TR/2016/W3C-WG-NOTE">
</head>
<body class="h-entry toc-inline" data-cite=
"WebIDL web-platform streams wot-architecture wot-thing-description wot-binding-templates">
  <div class="head">
    <a class="logo" href="https://www.w3.org/"><img alt="W3C"
    width="72" height="48" src=
    "https://www.w3.org/StyleSheets/TR/2016/logos/W3C"></a>
    <h1 id="title" class="title">Web of Things (WoT) Scripting
    API</h1>
    <h2>W3C Working Group Note <time class="dt-published" datetime=
    "2020-11-24">24 November 2020</time></h2>
    <dl>
      <dt>This version:</dt>
      <dd>
        <a class="u-url" href=
        "https://www.w3.org/TR/2020/NOTE-wot-scripting-api-20201124/">
         https://www.w3.org/TR/2020/NOTE-wot-scripting-api-20201124/</a>
      </dd>
      <dt>Latest published version:</dt>
      <dd>
        <a href=
        "https://www.w3.org/TR/wot-scripting-api/">https://www.w3.org/TR/wot-scripting-api/</a>
      </dd>
      <dt>Latest editor's draft:</dt>
      <dd>
        <a href=
        "https://w3c.github.io/wot-scripting-api/">https://w3c.github.io/wot-scripting-api/</a>
      </dd>
      <dt>Previous version:</dt>
      <dd>
        <a class="u-url" href=
        "https://www.w3.org/TR/2019/WD-wot-scripting-api-20191028/">
         https://www.w3.org/TR/2019/WD-wot-scripting-api-20191028/</a>
      </dd>
      <dt>Editors:</dt>
      <dd class="p-author h-card vcard" data-editor-id="57789">
        <span class="p-name fn">Zoltan Kis</span> (<a class=
        "p-org org h-org h-card" href=
        "https://www.intel.com/">Intel</a>)
      </dd>
      <dd class="p-author h-card vcard" data-editor-id="39497">
        <span class="p-name fn">Daniel Peintner</span> (<a class=
        "p-org org h-org h-card" href=
        "https://www.siemens.com/">Siemens AG</a>)
      </dd>
      <dd class="p-author h-card vcard" data-editor-id="105495">
        <span class="p-name fn">Cristiano Aguzzi</span> (<a class=
        "p-org org h-org h-card" href=
        "https://github.com/relu91">Invited Expert</a>)
      </dd>
      <dd class="p-author h-card vcard" data-editor-id="74472">
      <span class="p-name fn">Johannes Hund</span> (Former Editor,
      when at Siemens AG)</dd>
      <dd class="p-author h-card vcard" data-editor-id="59208">
      <span class="p-name fn">Kazuaki Nimura</span> (Former Editor,
      at Fujitsu Ltd.)</dd>
      <dt>Repository:</dt>
      <dd>
        <a href="https://github.com/w3c/wot-scripting-api">On
        GitHub</a>
      </dd>
      <dd>
        <a href=
        "https://github.com/w3c/wot-scripting-api/issues">File a
        bug</a>
      </dd>
      <dt>Contributors:</dt>
      <dd>
        <a href=
        "https://github.com/w3c/wot-scripting-api/graphs/contributors">
        Contributors on GitHub</a>
      </dd>
    </dl>
    <p class="copyright"><a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    © 2017-2020 <a href="https://www.w3.org/"><abbr title=
    "World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
    (<a href="https://www.csail.mit.edu/"><abbr title=
    "Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="https://www.ercim.eu/"><abbr title=
    "European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
    <a href="https://www.keio.ac.jp/">Keio</a>, <a href=
    "https://ev.buaa.edu.cn/">Beihang</a>). W3C <a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">
    liability</a>, <a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">
    trademark</a> and <a rel="license" href=
    "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">
    permissive document license</a> rules apply.</p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory">
    <h2>Abstract</h2>
    <p>The Web of Things is made of entities (<a href="#dfn-things"
    class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-things-1">Thing</a>s) that can describe their
    capabilities in a machine-interpretable <a href=
    "#dfn-thing-descriptions" class="internalDFN" data-link-type=
    "dfn" id="ref-for-dfn-thing-descriptions-1">Thing
    Description</a> (TD) and expose these capabilities through the
    <a href="#dfn-wot-interface" class="internalDFN"
    data-link-type="dfn" id="ref-for-dfn-wot-interface-1">WoT
    Interface</a>, that is, network interactions modeled as
    <a href="#dfn-properties" class="internalDFN" data-link-type=
    "dfn" id="ref-for-dfn-properties-1">Properties</a> (for reading
    and writing values), <a href="#dfn-actions" class="internalDFN"
    data-link-type="dfn" id="ref-for-dfn-actions-1">Action</a>s (to
    execute remote procedures with or without return values) and
    <a href="#dfn-events" class="internalDFN" data-link-type="dfn"
    id="ref-for-dfn-events-1">Event</a>s (for signaling
    notifications).</p>
    <p>The main <a href="#dfn-web-of-things" class="internalDFN"
    data-link-type="dfn" id="ref-for-dfn-web-of-things-1">Web of
    Things</a> (WoT) concepts are described in the <cite><a href=
    "https://www.w3.org/TR/2020/REC-wot-architecture-20200409/">Web
    of Things Architecture</a></cite> specification.</p>
    <p>Scripting is an optional building block in WoT and it is
    typically used in gateways or browsers that are able to run a
    <a href="#dfn-wot-runtime" class="internalDFN" data-link-type=
    "dfn" id="ref-for-dfn-wot-runtime-1">WoT Runtime</a> and
    <a href=
    "https://github.com/w3c/wot-scripting-api/tree/master/applications/script-manager">
    script management</a>, providing a convenient way to extend WoT
    support to new types of endpoints and implement WoT
    applications such as <a href=
    "https://github.com/w3c/wot-scripting-api/tree/master/applications/thing-directory">
    Thing Directory</a>.</p>
    <p>This specification describes an application programming
    interface (API) representing the <a href="#dfn-wot-interface"
    class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-wot-interface-2">WoT Interface</a> that allows
    scripts to discover, operate <a href="#dfn-things" class=
    "internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-things-2">Thing</a>s and to expose locally defined
    <a href="#dfn-things" class="internalDFN" data-link-type="dfn"
    id="ref-for-dfn-things-3">Thing</a>s characterized by <a href=
    "#dfn-wot-interaction" class="internalDFN" data-link-type="dfn"
    id="ref-for-dfn-wot-interaction-1">WoT Interactions</a>
    specified by a script.</p>
    <p>The APIs defined in this document deliberately follow the
    <cite><a href=
    "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
    Web of Things Thing Description</a></cite> specification
    closely. It is possible to implement more abstract APIs on top
    of them, or implementing directly the WoT network facing
    interface (i.e. the <a href="#dfn-wot-interface" class=
    "internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-wot-interface-3">WoT Interface</a>).</p>
    <div class="note" id="issue-container-generatedID">
      <div role="heading" class="ednote-title marker" id="h-ednote"
      aria-level="3">
        <span>Editor's note</span>
      </div>
      <p class="">This specification is implemented at least by the
      <a href="http://www.thingweb.io/">Eclipse Thingweb</a>
      project also known as <a href=
      "https://github.com/eclipse/thingweb.node-wot">node-wot</a>,
      which is considered the reference open source implementation
      at the moment. Check its <a href=
      "https://github.com/eclipse/thingweb.node-wot">source
      code</a>, including <a href=
      "https://github.com/eclipse/thingweb.node-wot/examples">examples</a>.</p>
    </div>
  </section>
  <section id="sotd" class="introductory">
    <h2>Status of This Document</h2>
    <p><em>This section describes the status of this document at
    the time of its publication. Other documents may supersede this
    document. A list of current <abbr title=
    "World Wide Web Consortium">W3C</abbr> publications and the
    latest revision of this technical report can be found in the
    <a href="https://www.w3.org/TR/"><abbr title=
    "World Wide Web Consortium">W3C</abbr> technical reports
    index</a> at https://www.w3.org/TR/.</em></p>
    <p>Implementers need to be aware that this specification is
    considered unstable. Vendors interested in implementing this
    specification before it eventually reaches the Candidate
    Recommendation phase should subscribe to the <a href=
    "https://github.com/w3c/wot-scripting-api">repository</a> and
    take part in the discussions.</p>
    <div class="note" id="issue-container-generatedID-0">
      <div role="heading" class="ednote-title marker" id=
      "h-ednote-0" aria-level="3">
        <span>Editor's note</span><span class="issue-label">: The
        W3C WoT WG is asking for feedback</span>
      </div>
      <p class="">Please contribute to this draft using the
      <a href="https://github.com/w3c/wot-scripting-api/issues">GitHub
      Issues</a> page of the <a href=
      "https://github.com/w3c/wot-scripting-api/">WoT Scripting
      API</a> repository. For feedback on security and privacy
      considerations, please use the <a href=
      "https://github.com/w3c/wot-security/issues">WoT Security and
      Privacy</a> Issues.</p>
    </div>
    <p>This document was published by the <a href=
    "https://www.w3.org/WoT/WG/">Web of Things Working Group</a> as
    a Working Group Note.</p>
    <p>Publication as an Editor's Draft does not imply endorsement
    by the <abbr title="World Wide Web Consortium">W3C</abbr>
    Membership.</p>
    <p data-deliverer="95969">This is a draft document and may be updated, replaced or
    obsoleted by other documents at any time. It is inappropriate
    to cite this document as other than work in progress.</p>
    <p>This document was produced by a group operating under the
    <a href=
    "https://www.w3.org/Consortium/Patent-Policy-20170801/">1
    August 2017 <abbr title="World Wide Web Consortium">W3C</abbr>
    Patent Policy</a>. <abbr title=
    "World Wide Web Consortium">W3C</abbr> maintains a <a rel=
    "disclosure" href=
    "https://www.w3.org/2004/01/pp-impl/95969/status">public list
    of any patent disclosures</a> made in connection with the
    deliverables of the group; that page also includes instructions
    for disclosing a patent. An individual who has actual knowledge
    of a patent which the individual believes contains <a href=
    "https://www.w3.org/Consortium/Patent-Policy-20170801/#def-essential">
    Essential Claim(s)</a> must disclose the information in
    accordance with <a href=
    "https://www.w3.org/Consortium/Patent-Policy-20170801/#sec-Disclosure">
    section 6 of the <abbr title=
    "World Wide Web Consortium">W3C</abbr> Patent Policy</a>.</p>
    <p>This document is governed by the <a id=
    "w3c_process_revision" href=
    "https://www.w3.org/2020/Process-20200915/">15 September 2020
    <abbr title="World Wide Web Consortium">W3C</abbr> Process
    Document</a>.</p>
  </section>
  <nav id="toc">
    <h2 class="introductory" id="table-of-contents">Table of
    Contents</h2>
    <ol class="toc">
      <li class="tocline">
        <a class="tocxref" href="#introduction"><bdi class=
        "secno">1.</bdi> Introduction</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#use-cases"><bdi class=
        "secno">2.</bdi> Use Cases</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#consuming-a-thing"><bdi class="secno">2.1</bdi>
            Consuming a Thing</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#exposing-a-thing"><bdi class=
            "secno">2.2</bdi> Exposing a Thing</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#discovery"><bdi class=
            "secno">2.3</bdi> Discovery</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#conformance"><bdi class=
        "secno">3.</bdi> Conformance</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#the-thingdescription-type"><bdi class="secno">4.</bdi>
        The <span data-export="" data-dfn-type="typedef" data-idl=
        "typedef" data-title="ThingDescription" data-dfn-for=
        ""><code>ThingDescription</code></span> type</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#fetching-a-thing-description"><bdi class=
            "secno">4.1</bdi> Fetching a Thing Description</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#expanding-a-thing-description"><bdi class=
            "secno">4.2</bdi> Expanding a Thing Description</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#validating-a-thing-description"><bdi class=
            "secno">4.3</bdi> Validating a Thing Description</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#the-wot-namespace"><bdi class=
        "secno">5.</bdi> The <span data-export="" data-dfn-type=
        "namespace" data-idl="namespace" data-title="WOT"
        data-dfn-for=""><code>WOT</code></span> namespace</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#the-consume-method"><bdi class="secno">5.1</bdi> The
            <span data-export="" data-dfn-type="method" data-idl=
            "operation" data-title="consume()" data-dfn-for="WOT"
            data-type="Promise" data-lt="consume()|consume(td)"
            data-local-lt=
            "WOT.consume|WOT.consume()|consume"><code>consume()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-produce-method"><bdi class="secno">5.2</bdi> The
            <span data-export="" data-dfn-type="method" data-idl=
            "operation" data-title="produce()" data-dfn-for="WOT"
            data-type="Promise" data-lt="produce()|produce(td)"
            data-local-lt=
            "WOT.produce|WOT.produce()|produce"><code>produce()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-discover-method"><bdi class="secno">5.3</bdi> The
            <span data-export="" data-dfn-type="method" data-idl=
            "operation" data-title="discover()" data-dfn-for="WOT"
            data-type="ThingDiscovery" data-lt=
            "discover()|discover(, filter)" data-local-lt=
            "WOT.discover|WOT.discover()|discover"><code>discover()</code></span>
            method</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#handling-interaction-data"><bdi class="secno">6.</bdi>
        Handling interaction data</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#the-interactioninput-type"><bdi class=
            "secno">6.1</bdi> The <span data-export=""
            data-dfn-type="typedef" data-idl="typedef" data-title=
            "InteractionInput" data-dfn-for=
            ""><code>InteractionInput</code></span> type</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-interactionoutput-interface"><bdi class=
            "secno">6.2</bdi> The <span data-export=""
            data-dfn-type="interface" data-idl="interface"
            data-title="InteractionOutput" data-dfn-for=
            ""><code>InteractionOutput</code></span> interface</a>
            <ol class="toc">
              <li class="tocline">
                <a class="tocxref" href=
                "#the-value-function"><bdi class=
                "secno">6.2.1</bdi> The <span data-export=""
                data-dfn-type="method" data-idl="operation"
                data-title="value()" data-dfn-for=
                "InteractionOutput" data-type="Promise" data-lt=
                "value()" data-local-lt=
                "InteractionOutput.value|InteractionOutput.value()|value">
                <code>value()</code></span> function</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#the-arraybuffer-function"><bdi class=
                "secno">6.2.2</bdi> The <span data-export=""
                data-dfn-type="method" data-idl="operation"
                data-title="arrayBuffer()" data-dfn-for=
                "InteractionOutput" data-type="Promise" data-lt=
                "arrayBuffer()" data-local-lt=
                "InteractionOutput.arrayBuffer|InteractionOutput.arrayBuffer()|arrayBuffer">
                <code>arrayBuffer()</code></span> function</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#the-check-data-schema-algorithm"><bdi class=
                "secno">6.2.3</bdi> The <span>check data
                schema</span> algorithm</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#the-create-interaction-request-algorithm"><bdi class="secno">
                6.2.4</bdi> The <span>create interaction
                request</span> algorithm</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#the-parse-interaction-response-algorithm"><bdi class="secno">
                6.2.5</bdi> The <span>parse interaction
                response</span> algorithm</a>
              </li>
            </ol>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#using-interactioninput-and-interactionoutput"><bdi class="secno">
            6.3</bdi> Using <span data-xref-type="_IDL_"
            data-link-type="idl" class=
            "formerLink"><code><code>InteractionInput</code></code></span>
            and <span data-xref-type="_IDL_" data-link-type="idl"
            class=
            "formerLink"><code><code>InteractionOutput</code></code></span></a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#error-handling"><bdi class=
            "secno">6.4</bdi> Error handling</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#the-consumedthing-interface"><bdi class="secno">7.</bdi>
        The <span data-export="" data-dfn-type="interface"
        data-idl="interface" data-title="ConsumedThing"
        data-dfn-for=""><code>ConsumedThing</code></span>
        interface</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#internal-slots-for-consumedthing"><bdi class=
            "secno">7.1</bdi> Internal slots for ConsumedThing</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#constructing-consumedthing"><bdi class=
            "secno">7.2</bdi> Constructing
            <code>ConsumedThing</code></a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-getthingdescription-method"><bdi class=
            "secno">7.3</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "getThingDescription()" data-dfn-for="ConsumedThing"
            data-type="ThingDescription" data-lt=
            "getThingDescription()" data-local-lt=
            "ConsumedThing.getThingDescription|ConsumedThing.getThingDescription()|getThingDescription">
            <code>getThingDescription()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-readproperty-method"><bdi class="secno">7.4</bdi>
            The <span data-export="" data-dfn-type="method"
            data-idl="operation" data-title="readProperty()"
            data-dfn-for="ConsumedThing" data-type="Promise"
            data-lt=
            "readProperty()|readProperty(propertyName)|readProperty(propertyName, options)"
            data-local-lt=
            "ConsumedThing.readProperty|ConsumedThing.readProperty()|readProperty">
            <code>readProperty()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-readmultipleproperties-method"><bdi class=
            "secno">7.5</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "readMultipleProperties()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "readMultipleProperties()|readMultipleProperties(propertyNames)|readMultipleProperties(propertyNames, options)"
            data-local-lt=
            "ConsumedThing.readMultipleProperties|ConsumedThing.readMultipleProperties()|readMultipleProperties">
            <code>readMultipleProperties()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-readallproperties-method"><bdi class=
            "secno">7.6</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "readAllProperties()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "readAllProperties()|readAllProperties(, options)"
            data-local-lt=
            "ConsumedThing.readAllProperties|ConsumedThing.readAllProperties()|readAllProperties">
            <code>readAllProperties()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-writeproperty-method"><bdi class=
            "secno">7.7</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "writeProperty()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "writeProperty()|writeProperty(propertyName, value)|writeProperty(propertyName, value, options)"
            data-local-lt=
            "ConsumedThing.writeProperty|ConsumedThing.writeProperty()|writeProperty">
            <code>writeProperty()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-writemultipleproperties-method"><bdi class=
            "secno">7.8</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "writeMultipleProperties()" data-dfn-for=
            "ConsumedThing" data-type="Promise" data-lt=
            "writeMultipleProperties()|writeMultipleProperties(valueMap)|writeMultipleProperties(valueMap, options)"
            data-local-lt=
            "ConsumedThing.writeMultipleProperties|ConsumedThing.writeMultipleProperties()|writeMultipleProperties">
            <code>writeMultipleProperties()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-observeproperty-method"><bdi class=
            "secno">7.9</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "observeProperty()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "observeProperty()|observeProperty(name, listener)|observeProperty(name, listener, onerror)|observeProperty(name, listener, onerror, options)"
            data-local-lt=
            "ConsumedThing.observeProperty|ConsumedThing.observeProperty()|observeProperty">
            <code>observeProperty()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-invokeaction-method"><bdi class=
            "secno">7.10</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "invokeAction()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "invokeAction()|invokeAction(actionName)|invokeAction(actionName, params)|invokeAction(actionName, params, options)"
            data-local-lt=
            "ConsumedThing.invokeAction|ConsumedThing.invokeAction()|invokeAction">
            <code>invokeAction()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-subscribeevent-method"><bdi class=
            "secno">7.11</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "subscribeEvent()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "subscribeEvent()|subscribeEvent(name, listener)|subscribeEvent(name, listener, onerror)|subscribeEvent(name, listener, onerror, options)"
            data-local-lt=
            "ConsumedThing.subscribeEvent|ConsumedThing.subscribeEvent()|subscribeEvent">
            <code>subscribeEvent()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-interactionoptions-dictionary"><bdi class=
            "secno">7.12</bdi> The <span data-export=""
            data-dfn-type="dictionary" data-idl="dictionary"
            data-title="InteractionOptions" data-dfn-for=
            ""><code>InteractionOptions</code></span>
            dictionary</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-propertymap-type"><bdi class="secno">7.13</bdi>
            The <span data-export="" data-dfn-type="typedef"
            data-idl="typedef" data-title="PropertyMap"
            data-dfn-for=""><code>PropertyMap</code></span>
            type</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-interactionlistener-callback"><bdi class=
            "secno">7.14</bdi> The <span data-export=""
            data-dfn-type="callback" data-idl="callback"
            data-title="InteractionListener" data-dfn-for=
            ""><code>InteractionListener</code></span> callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-errorlistener-callback"><bdi class=
            "secno">7.15</bdi> The <span data-export=""
            data-dfn-type="callback" data-idl="callback"
            data-title="ErrorListener" data-dfn-for=
            ""><code>ErrorListener</code></span> callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-subscription-interface"><bdi class=
            "secno">7.16</bdi> The <span data-export=""
            data-dfn-type="interface" data-idl="interface"
            data-title="Subscription" data-dfn-for=
            ""><code>Subscription</code></span> interface</a>
            <ol class="toc">
              <li class="tocline">
                <a class="tocxref" href=
                "#internal-slots-for-subscription"><bdi class=
                "secno">7.16.1</bdi> Internal slots for
                <span data-xref-type="_IDL_" data-link-type="idl"
                class=
                "formerLink"><code><code>Subscription</code></code></span></a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#the-stop-method"><bdi class="secno">7.16.2</bdi>
                The <span data-export="" data-dfn-type="method"
                data-idl="operation" data-title="stop()"
                data-dfn-for="Subscription" data-type="Promise"
                data-lt="stop()|stop(, options)" data-local-lt=
                "Subscription.stop|Subscription.stop()|stop"><code>stop()</code></span>
                method</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#finding-an-unsubscribe-form"><bdi class=
                "secno">7.16.3</bdi> Finding an unsubscribe
                <span class="formerLink" data-link-type=
                "dfn">Form</span></a>
              </li>
            </ol>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#consumedthing-examples"><bdi class="secno">7.17</bdi>
            ConsumedThing Examples</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#the-exposedthing-interface"><bdi class="secno">8.</bdi>
        The <span data-export="" data-dfn-type="interface"
        data-idl="interface" data-title="ExposedThing"
        data-dfn-for=""><code>ExposedThing</code></span>
        interface</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#internal-slots-for-exposedthing"><bdi class=
            "secno">8.1</bdi> Internal slots for ExposedThing</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#constructing-exposedthing"><bdi class=
            "secno">8.2</bdi> Constructing <span data-xref-type=
            "_IDL_" data-link-type="idl" class=
            "formerLink"><code><code>ExposedThing</code></code></span></a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-getthingdescription-method-0"><bdi class=
            "secno">8.3</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "getThingDescription()" data-dfn-for="ExposedThing"
            data-type="ThingDescription" data-lt=
            "getThingDescription()" data-local-lt=
            "ExposedThing.getThingDescription|ExposedThing.getThingDescription()|getThingDescription">
            <code>getThingDescription()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-propertyreadhandler-callback"><bdi class=
            "secno">8.4</bdi> The <span data-export=""
            data-dfn-type="callback" data-idl="callback"
            data-title="PropertyReadHandler" data-dfn-for=
            ""><code>PropertyReadHandler</code></span> callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-setpropertyreadhandler-method"><bdi class=
            "secno">8.5</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "setPropertyReadHandler()" data-dfn-for="ExposedThing"
            data-type="ExposedThing" data-lt=
            "setPropertyReadHandler()|setPropertyReadHandler(name, handler)"
            data-local-lt=
            "ExposedThing.setPropertyReadHandler|ExposedThing.setPropertyReadHandler()|setPropertyReadHandler">
            <code>setPropertyReadHandler()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-requests-for-reading-a-property"><bdi class=
            "secno">8.6</bdi> Handling requests for reading a
            Property</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-requests-for-reading-multiple-properties"><bdi class="secno">
            8.7</bdi> Handling requests for reading multiple
            Properties</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-requests-for-reading-all-properties"><bdi class="secno">
            8.8</bdi> Handling requests for reading all
            Properties</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-setpropertyobservehandler-method"><bdi class=
            "secno">8.9</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "setPropertyObserveHandler()" data-dfn-for=
            "ExposedThing" data-type="ExposedThing" data-lt=
            "setPropertyObserveHandler()|setPropertyObserveHandler(name, handler)"
            data-local-lt=
            "ExposedThing.setPropertyObserveHandler|ExposedThing.setPropertyObserveHandler()|setPropertyObserveHandler">
            <code>setPropertyObserveHandler()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-property-observe-requests"><bdi class=
            "secno">8.10</bdi> Handling <span class="formerLink"
            data-link-type="dfn">Property</span> observe
            requests</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-setpropertyunobservehandler-method"><bdi class=
            "secno">8.11</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "setPropertyUnobserveHandler()" data-dfn-for=
            "ExposedThing" data-type="ExposedThing" data-lt=
            "setPropertyUnobserveHandler()|setPropertyUnobserveHandler(name, handler)"
            data-local-lt=
            "ExposedThing.setPropertyUnobserveHandler|ExposedThing.setPropertyUnobserveHandler()|setPropertyUnobserveHandler">
            <code>setPropertyUnobserveHandler()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-property-unobserve-requests"><bdi class=
            "secno">8.12</bdi> Handling <span class="formerLink"
            data-link-type="dfn">Property</span> unobserve
            requests</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-emitpropertychange-method"><bdi class=
            "secno">8.13</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "emitPropertyChange()" data-dfn-for="ExposedThing"
            data-type="Promise" data-lt=
            "emitPropertyChange()|emitPropertyChange(name)"
            data-local-lt=
            "ExposedThing.emitPropertyChange|ExposedThing.emitPropertyChange()|emitPropertyChange">
            <code>emitPropertyChange()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-propertywritehandler-callback"><bdi class=
            "secno">8.14</bdi> The <span data-export=""
            data-dfn-type="callback" data-idl="callback"
            data-title="PropertyWriteHandler" data-dfn-for=
            ""><code>PropertyWriteHandler</code></span>
            callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-setpropertywritehandler-method"><bdi class=
            "secno">8.15</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "setPropertyWriteHandler()" data-dfn-for="ExposedThing"
            data-type="ExposedThing" data-lt=
            "setPropertyWriteHandler()|setPropertyWriteHandler(name, handler)"
            data-local-lt=
            "ExposedThing.setPropertyWriteHandler|ExposedThing.setPropertyWriteHandler()|setPropertyWriteHandler">
            <code>setPropertyWriteHandler()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-requests-for-writing-a-property"><bdi class=
            "secno">8.16</bdi> Handling requests for writing a
            Property</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-requests-for-writing-multiple-properties"><bdi class="secno">
            8.17</bdi> Handling requests for writing multiple
            Properties</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-actionhandler-callback"><bdi class=
            "secno">8.18</bdi> The <span data-export=""
            data-dfn-type="callback" data-idl="callback"
            data-title="ActionHandler" data-dfn-for=
            ""><code>ActionHandler</code></span> callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-setactionhandler-method"><bdi class=
            "secno">8.19</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "setActionHandler()" data-dfn-for="ExposedThing"
            data-type="ExposedThing" data-lt=
            "setActionHandler()|setActionHandler(name, action)"
            data-local-lt=
            "ExposedThing.setActionHandler|ExposedThing.setActionHandler()|setActionHandler">
            <code>setActionHandler()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-action-requests"><bdi class=
            "secno">8.20</bdi> Handling <span class="formerLink"
            data-link-type="dfn">Action</span> requests</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-eventlistenerhandler-callback"><bdi class=
            "secno">8.21</bdi> The <span data-export=""
            data-dfn-type="callback" data-idl="callback"
            data-title="EventListenerHandler" data-dfn-for=
            ""><code>EventListenerHandler</code></span>
            callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-eventsubscriptionhandler-callback"><bdi class=
            "secno">8.22</bdi> The <span data-export=""
            data-dfn-type="callback" data-idl="callback"
            data-title="EventSubscriptionHandler" data-dfn-for=
            ""><code>EventSubscriptionHandler</code></span>
            callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-seteventsubscribehandler-method"><bdi class=
            "secno">8.23</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "setEventSubscribeHandler()" data-dfn-for=
            "ExposedThing" data-type="ExposedThing" data-lt=
            "setEventSubscribeHandler()|setEventSubscribeHandler(name, handler)"
            data-local-lt=
            "ExposedThing.setEventSubscribeHandler|ExposedThing.setEventSubscribeHandler()|setEventSubscribeHandler">
            <code>setEventSubscribeHandler()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-event-subscribe-requests"><bdi class=
            "secno">8.24</bdi> Handling <span class="formerLink"
            data-link-type="dfn">Event</span> subscribe
            requests</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-seteventunsubscribehandler-method"><bdi class=
            "secno">8.25</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "setEventUnsubscribeHandler()" data-dfn-for=
            "ExposedThing" data-type="ExposedThing" data-lt=
            "setEventUnsubscribeHandler()|setEventUnsubscribeHandler(name, handler)"
            data-local-lt=
            "ExposedThing.setEventUnsubscribeHandler|ExposedThing.setEventUnsubscribeHandler()|setEventUnsubscribeHandler">
            <code>setEventUnsubscribeHandler()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-event-unsubscribe-requests"><bdi class=
            "secno">8.26</bdi> Handling <span class="formerLink"
            data-link-type="dfn">Event</span> unsubscribe
            requests</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-seteventhandler-method"><bdi class=
            "secno">8.27</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "setEventHandler()" data-dfn-for="ExposedThing"
            data-type="ExposedThing" data-lt=
            "setEventHandler()|setEventHandler(name, eventHandler)"
            data-local-lt=
            "ExposedThing.setEventHandler|ExposedThing.setEventHandler()|setEventHandler">
            <code>setEventHandler()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#handling-events"><bdi class=
            "secno">8.28</bdi> Handling <span class="formerLink"
            data-link-type="dfn">Events</span></a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-emitevent-method"><bdi class="secno">8.29</bdi>
            The <span data-export="" data-dfn-type="method"
            data-idl="operation" data-title="emitEvent()"
            data-dfn-for="ExposedThing" data-type="Promise"
            data-lt="emitEvent()|emitEvent(name, data)"
            data-local-lt=
            "ExposedThing.emitEvent|ExposedThing.emitEvent()|emitEvent">
            <code>emitEvent()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-expose-method"><bdi class="secno">8.30</bdi> The
            <span data-export="" data-dfn-type="method" data-idl=
            "operation" data-title="expose()" data-dfn-for=
            "ExposedThing" data-type="Promise" data-lt="expose()"
            data-local-lt=
            "ExposedThing.expose|ExposedThing.expose()|expose"><code>
            expose()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-destroy-method"><bdi class="secno">8.31</bdi> The
            <span data-export="" data-dfn-type="method" data-idl=
            "operation" data-title="destroy()" data-dfn-for=
            "ExposedThing" data-type="Promise" data-lt="destroy()"
            data-local-lt=
            "ExposedThing.destroy|ExposedThing.destroy()|destroy"><code>
            destroy()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#exposedthing-examples"><bdi class="secno">8.32</bdi>
            ExposedThing Examples</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#the-thingdiscovery-interface"><bdi class="secno">9.</bdi>
        The <span data-export="" data-dfn-type="interface"
        data-idl="interface" data-title="ThingDiscovery"
        data-dfn-for=""><code>ThingDiscovery</code></span>
        interface</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#constructing-thingdiscovery"><bdi class=
            "secno">9.1</bdi> Constructing <span data-xref-type=
            "_IDL_" data-link-type="idl" class=
            "formerLink"><code><code>ThingDiscovery</code></code></span></a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-discoverymethod-enumeration"><bdi class=
            "secno">9.2</bdi> The <span data-export=""
            data-dfn-type="typedef" data-idl="typedef" data-title=
            "DiscoveryMethod" data-dfn-for=
            ""><code>DiscoveryMethod</code></span> enumeration</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-thingfilter-dictionary"><bdi class=
            "secno">9.3</bdi> The <span data-export=""
            data-dfn-type="dictionary" data-idl="dictionary"
            data-title="ThingFilter" data-dfn-for=
            ""><code>ThingFilter</code></span> dictionary</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#the-start-method"><bdi class=
            "secno">9.4</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "start()" data-dfn-for="ThingDiscovery" data-type=
            "undefined" data-lt="start()" data-local-lt=
            "ThingDiscovery.start|ThingDiscovery.start()|start"><code>
            start()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#the-next-method"><bdi class=
            "secno">9.5</bdi> The <span data-export=""
            data-dfn-type="method" data-idl="operation" data-title=
            "next()" data-dfn-for="ThingDiscovery" data-type=
            "Promise" data-lt="next()" data-local-lt=
            "ThingDiscovery.next|ThingDiscovery.next()|next"><code>next()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-stop-method-0"><bdi class="secno">9.6</bdi> The
            <span data-export="" data-dfn-type="method" data-idl=
            "operation" data-title="stop()" data-dfn-for=
            "ThingDiscovery" data-type="undefined" data-lt="stop()"
            data-local-lt=
            "ThingDiscovery.stop|ThingDiscovery.stop()|stop"><code>stop()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#discovery-examples"><bdi class="secno">9.7</bdi>
            Discovery Examples</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#security"><bdi class=
        "secno">10.</bdi> Security and Privacy</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#sec-security-consideration-runtime"><bdi class=
            "secno">10.1</bdi> Scripting Runtime Security and
            Privacy Risks</a>
            <ol class="toc">
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-input"><bdi class=
                "secno">10.1.1</bdi> Corrupted Input Security and
                Privacy Risk</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-device-direct-access"><bdi class="secno">
                10.1.2</bdi> Physical Device Direct Access Security
                and Privacy Risk</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-update-provisioning"><bdi class="secno">
                10.1.3</bdi> Provisioning and Update Security
                Risk</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-credentials-storage"><bdi class="secno">
                10.1.4</bdi> Security Credentials Storage Security
                and Privacy Risk</a>
              </li>
            </ol>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#sec-security-consideration-script"><bdi class=
            "secno">10.2</bdi> Script Security and Privacy
            Risks</a>
            <ol class="toc">
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-script-input"><bdi class="secno">
                10.2.1</bdi> Corrupted Script Input Security and
                Privacy Risk</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-script-processing"><bdi class="secno">
                10.2.2</bdi> Denial Of Service Security Risk</a>
              </li>
            </ol>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#terminology-and-conventions"><bdi class="secno">11.</bdi>
        Terminology and conventions</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#api-design-rationale"><bdi class=
        "secno">A.</bdi> API design rationale</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#approaches-to-wot-application-development"><bdi class="secno">
            A.1</bdi> Approaches to WoT application development</a>
            <ol class="toc">
              <li class="tocline">
                <a class="tocxref" href=
                "#no-scripting-api"><bdi class="secno">A.1.1</bdi>
                No Scripting API</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#simple-scripting-api"><bdi class=
                "secno">A.1.2</bdi> Simple Scripting API</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#this-api-aligned-with-the-web-of-things-thing-description-specification">
                <bdi class="secno">A.1.3</bdi> This API, aligned
                with the <cite><span data-cite="WOT-TD" class=
                "formerLink">Web of Things Thing
                Description</span></cite> specification</a>
              </li>
            </ol>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#fetching-and-validating-a-td"><bdi class=
            "secno">A.2</bdi> Fetching and validating a TD</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#factory-vs-constructors"><bdi class="secno">A.3</bdi>
            Factory vs constructors</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#observers"><bdi class=
            "secno">A.4</bdi> Observers</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#using-events"><bdi class=
            "secno">A.5</bdi> Using Events</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#polymorphic-functions"><bdi class="secno">A.6</bdi>
            Polymorphic functions</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#Changes"><bdi class=
        "secno">B.</bdi> Changes</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#idl-index"><bdi class=
        "secno">C.</bdi> Full Web IDL</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#acknowledgements"><bdi class=
        "secno">D.</bdi> Acknowledgements</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#references"><bdi class=
        "secno">E.</bdi> References</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#normative-references"><bdi class="secno">E.1</bdi>
            Normative references</a>
          </li>
        </ol>
      </li>
    </ol>
  </nav>
  <section id="introduction">
    <h2 id="x1-introduction"><bdi class="secno">1.</bdi>
    Introduction<a class="self-link" aria-label="§" href=
    "#introduction"></a></h2>
    <p>WoT provides layered interoperability based on how <a href=
    "#dfn-things" class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-things-4">Thing</a>s are used: "consumed" and
    "exposed", as defined in the <cite><a href=
    "https://www.w3.org/TR/2020/REC-wot-architecture-20200409/">Web
    of Things Architecture</a></cite> terminology.</p>
    <p>By <a href="#dfn-consume" class="internalDFN"
    data-link-type="dfn" id="ref-for-dfn-consume-1">consuming a
    TD</a>, a client <a href="#dfn-things" class="internalDFN"
    data-link-type="dfn" id="ref-for-dfn-things-5">Thing</a>
    creates a local runtime resource model that allows accessing
    the <a href="#dfn-properties" class="internalDFN"
    data-link-type="dfn" id=
    "ref-for-dfn-properties-2">Properties</a>, <a href=
    "#dfn-actions" class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-actions-2">Actions</a> and <a href="#dfn-events"
    class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-events-2">Events</a> exposed by the server
    <a href="#dfn-things" class="internalDFN" data-link-type="dfn"
    id="ref-for-dfn-things-6">Thing</a> on a remote device.</p>
    <div>
      Exposing a <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-things-7">Thing</a>
      requires:
      <ul>
        <li>defining a <a href="#dfn-thing-descriptions" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-thing-descriptions-2">Thing Description</a>
        (TD),
        </li>
        <li>then instantiating a software stack that implements the
        <a href="#dfn-wot-interface" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-wot-interface-4">WoT
        Interface</a> specified by the <a href="#dfn-td-0" class=
        "internalDFN" data-link-type="dfn" id="ref-for-dfn-td-0-1">
          TD</a> in order to serve requests for accessing the
          exposed <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-properties-3">Properties</a>, <a href=
          "#dfn-actions" class="internalDFN" data-link-type="dfn"
          id="ref-for-dfn-actions-3">Actions</a> and <a href=
          "#dfn-events" class="internalDFN" data-link-type="dfn"
          id="ref-for-dfn-events-3">Events</a>,
        </li>
        <li>then eventually publishing the <a href=
        "#dfn-thing-descriptions" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-thing-descriptions-3">
          Thing Description</a> (for instance to a <a href=
          "#dfn-thing-directory" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-thing-directory-1">Thing Directory</a>
          directory for easier discovery).
        </li>
      </ul>This specification describes how to expose and consume
      <a href="#dfn-things" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-things-8">Thing</a>s by a script. Also,
      it defines a generic API for <a href="#dfn-things" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-things-9">Thing</a> discovery.
    </div>
    <div class="note" role="note" id=
    "issue-container-generatedID-1">
      <div role="heading" class="note-title marker" id="h-note"
      aria-level="3">
        <span>Note</span>
      </div>
      <p class="">Typically scripts are meant to be used on bridges
      or gateways that expose and control simpler devices as WoT
      <a href="#dfn-things" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-things-10">Thing</a>s and have means to
      handle (e.g. install, uninstall, update etc.) and run
      scripts.</p>
    </div>
    <div class="note" role="note" id=
    "issue-container-generatedID-2">
      <div role="heading" class="note-title marker" id="h-note-0"
      aria-level="3">
        <span>Note</span>
      </div>
      <p class="">This specification does not make assumptions on
      how the <a href="#dfn-wot-runtime" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-wot-runtime-2">WoT
      Runtime</a> handles and runs scripts, including single or
      multiple tenancy, script deployment and lifecycle management.
      The API already supports the generic mechanisms that make it
      possible to implement script management, for instance by
      exposing a manager <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-things-11">Thing</a>
      whose <a href="#dfn-actions" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-actions-4">Actions</a>
      (action handlers) implement script lifecycle management
      operations.</p>
    </div>
  </section>
  <section class="informative" id="use-cases">
    <h2 id="x2-use-cases"><bdi class="secno">2.</bdi> Use
    Cases<a class="self-link" aria-label="§" href=
    "#use-cases"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>The following scripting use cases are supported in this
    specification:</p>
    <section id="consuming-a-thing">
      <h3 id="x2-1-consuming-a-thing"><bdi class="secno">2.1</bdi>
      Consuming a Thing<a class="self-link" aria-label="§" href=
      "#consuming-a-thing"></a></h3>
      <ul>
        <li>
          <a href="#dfn-consume" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-consume-2">Consume a
          TD</a>, i.e. create a programmatic object from a <a href=
          "#dfn-thing-descriptions" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-thing-descriptions-4">Thing Description</a>
          that exposes <a href="#dfn-wot-interaction" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-wot-interaction-2">WoT Interactions</a>:
          <ul>
            <li>Read the value of a <a href="#dfn-properties"
              class="internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-properties-4">Property</a> or a set of
              properties.
            </li>
            <li>Set the value of a <a href="#dfn-properties"
              class="internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-properties-5">Property</a> or a set of
              properties.
            </li>
            <li>Observe value changes of a <a href=
            "#dfn-properties" class="internalDFN" data-link-type=
            "dfn" id="ref-for-dfn-properties-6">Property</a>.
            </li>
            <li>Invoke an <a href="#dfn-actions" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-actions-5">Action</a>.
            </li>
            <li>Observe WoT <a href="#dfn-events" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-events-4">Events</a> emitted by the
            <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-things-12">Thing</a>.
            </li>
            <li>Introspect the <a href="#dfn-thing-descriptions"
            class="internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-thing-descriptions-5">Thing
            Description</a>.
            </li>
          </ul>
        </li>
      </ul>
    </section>
    <section id="exposing-a-thing">
      <h3 id="x2-2-exposing-a-thing"><bdi class="secno">2.2</bdi>
      Exposing a Thing<a class="self-link" aria-label="§" href=
      "#exposing-a-thing"></a></h3>
      <ul>
        <li>Exposing the <a href="#dfn-things" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-things-13">Thing</a>
          includes generating the protocol bindings in order to
          access lower level functionality.
        </li>
        <li>Create a local <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-things-14">Thing</a> to be exposed, based on
        <a href="#dfn-thing-descriptions" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-thing-descriptions-6">
          Thing Description</a>.
        </li>
        <li>The following use cases can be implemented before
        creating the <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-things-15">Thing</a>
        by editing the <a href="#dfn-thing-descriptions" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-thing-descriptions-7">Thing Description</a>:
          <ul>
            <li>Add a <a href="#dfn-properties" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-properties-7">Property</a> definition to
              the <a href="#dfn-things" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-things-16">Thing</a>.
            </li>
            <li>Remove a <a href="#dfn-properties" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-properties-8">Property</a> definition from
            the <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-things-17">Thing</a>.
            </li>
            <li>Add an <a href="#dfn-actions" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-actions-6">Action</a> definition to the
            <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-things-18">Thing</a>.
            </li>
            <li>Remove an <a href="#dfn-actions" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-actions-7">Action</a> definition from the
            <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-things-19">Thing</a>.
            </li>
            <li>Add a WoT <a href="#dfn-events" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-events-5">Event</a> definition to the
              <a href="#dfn-things" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-things-20">Thing</a>.
            </li>
            <li>Remove a WoT <a href="#dfn-events" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-events-6">Event</a> definition from the
            <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-things-21">Thing</a>.
            </li>
          </ul>
          <div class="note" id="issue-container-generatedID-3">
            <div role="heading" class="ednote-title marker" id=
            "h-ednote-1" aria-level="4">
              <span>Editor's note</span>
            </div>
            <p class="">After evaluating dynamic modifications to
            <a href="#dfn-thing-descriptions" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-thing-descriptions-8">Thing
            Descriptions</a> through several versions of this API,
            the editors concluded that the simplest way to
            represent these use cases is to take an existing
            <a href="#dfn-td-0" class="internalDFN" data-link-type=
            "dfn" id="ref-for-dfn-td-0-2">TD</a>, modify it (i.e.
            add or remove definitions) and then create a new
            <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-things-22">Thing</a> based on the modified
            <a href="#dfn-td-0" class="internalDFN" data-link-type=
            "dfn" id="ref-for-dfn-td-0-3">TD</a>.</p>
          </div>
        </li>
        <li>Emit a WoT <a href="#dfn-events" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-events-7">Event</a>,
        i.e. notify all subscribed listeners.
        </li>
        <li>Register service handlers for external requests:
          <ul>
            <li>to retrieve a <a href="#dfn-properties" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-properties-9">Property</a> value;
            </li>
            <li>to update a <a href="#dfn-properties" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-properties-10">Property</a> value;
            </li>
            <li>to observe a <a href="#dfn-properties" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-properties-11">Property</a>;
            </li>
            <li>to unobserve a <a href="#dfn-properties" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-properties-12">Property</a>;
            </li>
            <li>to invoke an <a href="#dfn-actions" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-actions-8">Action</a>: take the parameters
            from the request, execute the defined action, and
            return the result;
            </li>
            <li>to subscribe to an <a href="#dfn-events" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-events-8">Event</a>;
            </li>
            <li>to unsubscribe from an <a href="#dfn-events"
              class="internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-events-9">Event</a>.
            </li>
          </ul>
        </li>
      </ul>
    </section>
    <section id="discovery">
      <h3 id="x2-3-discovery"><bdi class="secno">2.3</bdi>
      Discovery<a class="self-link" aria-label="§" href=
      "#discovery"></a></h3>
      <ul>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-things-23">Thing</a>s
        in a network by sending a broadcast request.
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-things-24">Thing</a>s
        running in the local <a href="#dfn-wot-runtime" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-wot-runtime-3">WoT Runtime</a>.
        </li>
        <li>Discover nearby <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-things-25">Thing</a>s, for instance connected
        by NFC or Bluetooth, or within a <a href=
        "https://en.wikipedia.org/wiki/Geo-fence">geo-fence</a>.
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-things-26">Thing</a>s
        by sending a discovery request to a given <a href=
        "#dfn-thing-directory" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-thing-directory-2">Thing Directory</a>.
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-things-27">Thing</a>s
        filtered by filters defined on <a href=
        "#dfn-thing-descriptions" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-thing-descriptions-9">
          Thing Description</a>s
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-things-28">Thing</a>s
        filtered by semantic queries.
        </li>
        <li>Stop or suppress an ongoing discovery process.</li>
        <li>Optionally specify a timeout to the discovery process
        after which it is stopped/suppressed.</li>
      </ul>
    </section>
  </section>
  <section id="conformance">
    <h2 id="x3-conformance"><bdi class="secno">3.</bdi>
    Conformance<a class="self-link" aria-label="§" href=
    "#conformance"></a></h2>
    <p>As well as sections marked as non-normative, all authoring
    guidelines, diagrams, examples, and notes in this specification
    are non-normative. Everything else in this specification is
    normative.</p>
    <p>The key words <em class="rfc2119">MAY</em>, <em class=
    "rfc2119">MUST</em>, and <em class="rfc2119">SHOULD</em> in
    this document are to be interpreted as described in <a href=
    "https://tools.ietf.org/html/bcp14">BCP 14</a> [<cite><a class=
    "bibref" data-link-type="biblio" href="#bib-rfc2119" title=
    "Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>]
    [<cite><a class="bibref" data-link-type="biblio" href=
    "#bib-rfc8174" title=
    "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
    when, and only when, they appear in all capitals, as shown
    here.</p>
    <p>This specification describes the conformance criteria for
    the following classes of <dfn id="dfn-user-agent">user
    agent</dfn> (<dfn id="dfn-ua">UA</dfn>).</p>
    <p>Due to requirements of small embedded implementations,
    splitting WoT client and server interfaces was needed. Then,
    discovery is a distributed application, but typical scenarios
    have been covered by a generic discovery API in this
    specification. This resulted in using 3 conformance classes for
    a <a href="#dfn-ua" class="internalDFN" data-link-type="dfn"
    id="ref-for-dfn-ua-1">UA</a> that implements this API, one for
    client, one for server, and one for discovery. An application
    that uses this API can introspect for the presence of the
    <code>consume()</code>, <code>produce()</code> and
    <code>discover()</code> methods on the <a href=
    "#dfn-wot-api-object" class="internalDFN" data-link-type="dfn"
    id="ref-for-dfn-wot-api-object-1">WoT API object</a> in order
    to determine which conformance class the <a href="#dfn-ua"
    class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-ua-2">UA</a> implements.</p>
    <dl>
      <dt>
        <dfn id="dfn-wot-consumer">WoT Consumer</dfn> <a href=
        "#dfn-ua" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-ua-3">UA</a>
      </dt>
      <dd>
        <p>Implementations of this conformance class <em class=
        "rfc2119">MUST</em> implement the <code><a data-link-type=
        "idl" href="#dom-consumedthing" class="internalDFN" id=
        "ref-for-dom-consumedthing-1"><code><code>ConsumedThing</code></code></a></code>
        interface and the <code>consume()</code> method on the
        <a href="#dfn-wot-api-object" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-wot-api-object-2">WoT
        API object</a>.</p>
      </dd>
      <dt>
        <dfn id="dfn-wot-producer">WoT Producer</dfn> <a href=
        "#dfn-ua" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-ua-4">UA</a>
      </dt>
      <dd>
        <p>Implementations of this conformance class <em class=
        "rfc2119">MUST</em> implement <code><a data-link-type="idl"
        href="#dom-exposedthing" class="internalDFN" id=
        "ref-for-dom-exposedthing-1"><code><code>ExposedThing</code></code></a></code>
        interface and the <code>produce()</code> method on the
        <a href="#dfn-wot-api-object" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-wot-api-object-3">WoT
        API object</a>.</p>
      </dd>
      <dt>
        <dfn id="dfn-wot-discovery">WoT Discovery</dfn> <a href=
        "#dfn-ua" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-ua-5">UA</a>
      </dt>
      <dd>
        <p>Implementations of this conformance class <em class=
        "rfc2119">MUST</em> implement the <code><a href=
        "#dom-thingdiscovery" class="internalDFN" data-link-type=
        "idl" id=
        "ref-for-dom-thingdiscovery-1"><code>ThingDiscovery</code></a></code>
        interface and the <code>discover()</code> method on the
        <a href="#dfn-wot-api-object" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-wot-api-object-4">WoT
        API object</a>.</p>
      </dd>
    </dl>
    <p>These conformance classes <em class="rfc2119">MAY</em> be
    implemented in a single <a href="#dfn-ua" class="internalDFN"
    data-link-type="dfn" id="ref-for-dfn-ua-6">UA</a>.</p>
    <p>This specification can be used for implementing the WoT
    Scripting API in multiple programming languages. The interface
    definitions are specified in [<cite><a class="bibref"
    data-link-type="biblio" href="#bib-webidl" title=
    "Web IDL">WEBIDL</a></cite>].</p>
    <p>The <a href="#dfn-ua" class="internalDFN" data-link-type=
    "dfn" id="ref-for-dfn-ua-7">UA</a> may be implemented in the
    browser, or in a separate runtime environment, such as <a href=
    "https://nodejs.org/en/">Node.js</a> or in small embedded
    runtimes.</p>
    <p>Implementations that use ECMAScript executed in a browser to
    implement the APIs defined in this document <em class=
    "rfc2119">MUST</em> implement them in a manner consistent with
    the ECMAScript Bindings defined in the Web IDL specification
    [<cite><a class="bibref" data-link-type="biblio" href=
    "#bib-webidl" title="Web IDL">WEBIDL</a></cite>].</p>
    <p>Implementations that use TypeScript or ECMAScript in a
    runtime to implement the APIs defined in this document
    <em class="rfc2119">MUST</em> implement them in a manner
    consistent with the TypeScript Bindings defined in the
    TypeScript specification [<cite><a class="bibref"
    data-link-type="biblio" href="#bib-typescript" title=
    "TypeScript Language Specification">TYPESCRIPT</a></cite>].</p>
  </section>
  <section id="the-thingdescription-type">
    <h2 id="x4-the-thingdescription-type"><bdi class=
    "secno">4.</bdi> The <dfn data-export="" data-dfn-type=
    "typedef" id="dom-thingdescription" data-idl="typedef"
    data-title="ThingDescription" data-dfn-for=
    ""><code>ThingDescription</code></dfn> type<a class="self-link"
    aria-label="§" href="#the-thingdescription-type"></a></h2>
    <pre class="idl def" id="webidl-1625777409"><span class=
    "idlHeader"><a class="self-link" href=
    "#webidl-1625777409">WebIDL</a></span><span data-idl="" class=
    "idlTypedef" id="idl-def-thingdescription" data-title=
    "ThingDescription">typedef<span class="idlType"> <a data-type=
    "interface" href=
    "https://heycam.github.io/webidl/#idl-object">object</a></span> <a class="internalDFN idlID"
data-link-type="typedef" href="#dom-thingdescription" id=
"ref-for-dom-thingdescription-1"><code>ThingDescription</code></a>;</span></pre>
    <p>Represents a <a href="#dfn-thing-descriptions" class=
    "internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-thing-descriptions-10">Thing Description</a>
    (<a href="#dfn-td-0" class="internalDFN" data-link-type="dfn"
    id="ref-for-dfn-td-0-4">TD</a>) as <a href=
    "https://www.w3.org/TR/wot-thing-description/#thing">defined</a>
    in [<cite><a class="bibref" data-link-type="biblio" href=
    "#bib-wot-td" title=
    "Web of Things Thing Description">WOT-TD</a></cite>]. It is
    expected to be a <a href=
    "https://infra.spec.whatwg.org/#parse-json-from-bytes">parsed
    JSON object</a> that is validated using <a href=
    "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#json-schema-for-validation">
    JSON Schema validation</a>.</p>
    <section id="fetching-a-thing-description">
      <h3 id="x4-1-fetching-a-thing-description"><bdi class=
      "secno">4.1</bdi> Fetching a Thing Description<a class=
      "self-link" aria-label="§" href=
      "#fetching-a-thing-description"></a></h3>
      <p>Fetching a <a href="#dfn-td-0" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-td-0-5">TD</a> given a
      URL should be done with an external method, such as the
      <a href="https://fetch.spec.whatwg.org/#fetch-api">Fetch
      API</a> or a HTTP client library, which offer already
      standardized options on specifying fetch details.</p>
      <div class="example" id=
      "example-1-fetching-a-thing-description">
        <div class="marker">
          <a class="self-link" href=
          "#example-1-fetching-a-thing-description">Example
          <bdi>1</bdi></a><span class="example-title">: Fetching a
          Thing Description</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">let</span> res = <span class=
"hljs-keyword">await</span> fetch(<span class=
"hljs-string">'https://tds.mythings.biz/sensor11'</span>);
  <span class=
"hljs-comment">// ... additional checks possible on res.headers</span>
  <span class="hljs-keyword">let</span> td = <span class=
"hljs-keyword">await</span> res.json();
  <span class="hljs-keyword">let</span> thing = <span class=
"hljs-keyword">await</span> WOT.consume(td);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing name: "</span> + thing.getThingDescription().title);
} <span class="hljs-keyword">catch</span> (err) {
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Fetching TD failed"</span>, err.message);
}</code></pre>
      </div>
    </section>
    <section id="expanding-a-thing-description">
      <h3 id="x4-2-expanding-a-thing-description"><bdi class=
      "secno">4.2</bdi> Expanding a Thing Description<a class=
      "self-link" aria-label="§" href=
      "#expanding-a-thing-description"></a></h3>
      <p>Note that the <cite><a href=
      "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
      Web of Things Thing Description</a></cite> specification
      allows using a shortened <a href="#dfn-thing-descriptions"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-thing-descriptions-11">Thing Description</a> by
      the means of <a href=
      "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#sec-default-values">
      defaults</a> and requiring clients to expand them with
      default values specified in the <cite><a href=
      "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
      Web of Things Thing Description</a></cite> specification for
      the properties that are not explicitly defined in a given
      <a href="#dfn-td-0" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-td-0-6">TD</a>.</p>
      <div>
        To <dfn id="dfn-expand-a-td">expand a TD</dfn> given
        <var data-type="ThingDescription">td</var>, run the
        following steps:
        <ol>
          <li>For each item in the <a href=
          "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#sec-default-values">
            TD default values</a> table from [<cite><a class=
            "bibref" data-link-type="biblio" href="#bib-wot-td"
            title=
            "Web of Things Thing Description">WOT-TD</a></cite>],
            if the term is not defined in <var data-type=
            "ThingDescription">td</var>, add the term definition
            with the default value specified in [<cite><a class=
            "bibref" data-link-type="biblio" href="#bib-wot-td"
            title=
            "Web of Things Thing Description">WOT-TD</a></cite>].
          </li>
        </ol>
      </div>
    </section>
    <section id="validating-a-thing-description">
      <h3 id="x4-3-validating-a-thing-description"><bdi class=
      "secno">4.3</bdi> Validating a Thing Description<a class=
      "self-link" aria-label="§" href=
      "#validating-a-thing-description"></a></h3>
      <p>The [<cite><a class="bibref" data-link-type="biblio" href=
      "#bib-wot-td" title=
      "Web of Things Thing Description">WOT-TD</a></cite>]
      specification defines how a <a href="#dfn-td-0" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-td-0-7">TD</a> should be validated. Therefore,
      this API expects the <a data-link-type="idl" href=
      "#dom-thingdescription" class="internalDFN" id=
      "ref-for-dom-thingdescription-2"><code><code>ThingDescription</code></code></a>
      objects be validated before used as parameters. This
      specification defines a basic <a href="#dfn-td-0" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-td-0-8">TD</a> validation as follows.</p>
      <div>
        To <dfn id="dfn-validate-a-td">validate a TD</dfn> given
        <var data-type="ThingDescription">td</var>, run the
        following steps:
        <ol>
          <li>If <a href=
          "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#json-schema-for-validation">
            JSON Schema validation</a> fails on <var data-type=
            "ThingDescription">td</var>, <a data-link-type="dfn"
            data-type="dfn" href=
            "https://heycam.github.io/webidl/#dfn-throw">throw</a>
            a "<a data-link-type="idl" data-type="exception" href=
            "https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>"
            and abort these steps.
          </li>
        </ol>
        <div class="note" id="issue-container-generatedID-4">
          <div role="heading" class="ednote-title marker" id=
          "h-ednote-2" aria-level="4">
            <span>Editor's note</span><span class="issue-label">:
            Handling default values</span>
          </div>
          <p class="">Additional steps may be added to fill the
          default values of mandatory fields.</p>
        </div>
      </div>
    </section>
  </section>
  <section data-dfn-for="WOT" id="the-wot-namespace">
    <h2 id="x5-the-wot-namespace"><bdi class="secno">5.</bdi> The
    <dfn data-export="" data-dfn-type="namespace" id="dom-wot"
    data-idl="namespace" data-title="WOT" data-dfn-for=
    ""><code>WOT</code></dfn> namespace<a class="self-link"
    aria-label="§" href="#the-wot-namespace"></a></h2>
    <p>Defines the <dfn id="dfn-wot-api-object">WoT API
    object</dfn> as a singleton and contains the API methods,
    grouped by conformance classes.</p>
    <pre class="idl def" id="webidl-1274931079"><span class=
    "idlHeader"><a class="self-link" href=
    "#webidl-1274931079">WebIDL</a></span><span data-idl="" class=
    "idlNamespace" id="idl-def-wot" data-title="WOT">[<span class=
    "extAttr"><a data-type="extended-attribute" href=
    "https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
namespace <a class="internalDFN idlID" data-link-type="namespace"
href="#dom-wot" id=
"ref-for-dom-wot-1"><code>WOT</code></a> {<span class=
"idlSectionComment">
  // methods defined in UA conformance classes
</span>};</span></pre>
    <section id="the-consume-method">
      <h3 id="x5-1-the-consume-method"><bdi class="secno">5.1</bdi>
      The <dfn data-export="" data-dfn-type="method" id=
      "dom-wot-consume" data-idl="operation" data-title="consume()"
      data-dfn-for="WOT" data-type="Promise" data-lt=
      "consume()|consume(td)" data-local-lt=
      "WOT.consume|WOT.consume()|consume"><code>consume()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-consume-method"></a></h3>
      <pre class="idl def" id="webidl-584946864"><span class=
      "idlHeader"><a class="self-link" href=
      "#webidl-584946864">WebIDL</a></span><span data-idl="" class=
      "idlNamespace" id="idl-def-wot" data-title=
      "WOT">partial namespace <a class="internalDFN idlID"
      data-link-type="namespace" href="#dom-wot" id=
      "ref-for-dom-wot-2"><code>WOT</code></a> {<span data-idl=""
      class="idlMethod" id="idl-def-wot-consume-td" data-title=
      "consume" data-dfn-for="WOT"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-consumedthing"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-consumedthing-2"><code>ConsumedThing</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-wot-consume" id=
"ref-for-dom-wot-consume-1"><code>consume</code></a>(<span class=
"idlType"><a href="#dom-thingdescription" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-thingdescription-3"><code>ThingDescription</code></a></span> <span class="idlParamName">td</span>);</span>
};</span></pre>
      <div>
        Belongs to the <a href="#dfn-wot-consumer" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-wot-consumer-1">WoT Consumer</a> conformance
        class. Expects an <var data-type=
        "ThingDescription">td</var> argument and returns a
        <a data-link-type="idl" href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
        that resolves with a <a data-link-type="idl" href=
        "#dom-consumedthing" class="internalDFN" id=
        "ref-for-dom-consumedthing-3"><code><code>ConsumedThing</code></code></a>
        object that represents a client interface to operate with
        the <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-things-29">Thing</a>.
        The method <em class="rfc2119">MUST</em> run the following
        steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var data-type="ConsumedThing">thing</var> be a
          new <a data-link-type="idl" href="#dom-consumedthing"
          class="internalDFN" id=
          "ref-for-dom-consumedthing-4"><code><code>ConsumedThing</code></code></a>
          object constructed from <var data-type=
          "ThingDescription">td</var>.
          </li>
          <li>Set up the <a href="#dfn-wot-interaction" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-wot-interaction-3">WoT Interactions</a>
          based on introspecting <a href="#dfn-td-0" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-td-0-9">td</a> as explained in
          [<cite><a class="bibref" data-link-type="biblio" href=
          "#bib-wot-td" title=
          "Web of Things Thing Description">WOT-TD</a></cite>] and
          [<cite><a class="bibref" data-link-type="biblio" href=
          "#bib-wot-protocol-bindings" title=
          "Web of Things Binding Templates">WOT-PROTOCOL-BINDINGS</a></cite>].
          Make a request to the underlying platform to initialize
          the <a href="#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-1">Protocol
            Bindings</a>.
            <div class="note" id="issue-container-generatedID-5">
              <div role="heading" class="ednote-title marker" id=
              "h-ednote-3" aria-level="4">
                <span>Editor's note</span>
              </div>
              <p class="">Implementations encapsulate the
              complexity of how to use the <a href=
              "#dfn-protocol-bindings" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-protocol-bindings-2">Protocol
              Bindings</a> for implementing <a href=
              "#dfn-wot-interaction" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-wot-interaction-4">WoT interactions</a>.
              In the future elements of that could be
              standardized.</p>
            </div>
          </li>
          <li>Resolve <var data-type="Promise">promise</var> with
          <var data-type="ConsumedThing">thing</var>.</li>
        </ol>
        <div class="note" id="issue-container-generatedID-6">
          <div role="heading" class="ednote-title marker" id=
          "h-ednote-4" aria-level="4">
            <span>Editor's note</span>
          </div>
          <p class="">Note the difference between constructing
          <a href="#dom-consumedthing" class="internalDFN"
          data-link-type="idl" id=
          "ref-for-dom-consumedthing-5"><code>ConsumedThing</code></a>
          and using the <code>consume()</code> method: the latter
          also initializes the protocol bindings, whereas a simple
          constructed object will not have <a href=
          "#dfn-wot-interaction" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-wot-interaction-5">WoT Interactions</a>
          initialized until they are invoked.</p>
        </div>
      </div>
    </section>
    <section id="the-produce-method">
      <h3 id="x5-2-the-produce-method"><bdi class="secno">5.2</bdi>
      The <dfn data-export="" data-dfn-type="method" id=
      "dom-wot-produce" data-idl="operation" data-title="produce()"
      data-dfn-for="WOT" data-type="Promise" data-lt=
      "produce()|produce(td)" data-local-lt=
      "WOT.produce|WOT.produce()|produce"><code>produce()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-produce-method"></a></h3>
      <pre class="idl def" id="webidl-1146491536"><span class=
      "idlHeader"><a class="self-link" href=
      "#webidl-1146491536">WebIDL</a></span><span data-idl="" class=
      "idlNamespace" id="idl-def-wot" data-title=
      "WOT">partial namespace <a class="internalDFN idlID"
      data-link-type="namespace" href="#dom-wot" id=
      "ref-for-dom-wot-3"><code>WOT</code></a> {<span data-idl=""
      class="idlMethod" id="idl-def-wot-produce-td" data-title=
      "produce" data-dfn-for="WOT"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-exposedthing"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-exposedthing-2"><code>ExposedThing</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-wot-produce" id=
"ref-for-dom-wot-produce-1"><code>produce</code></a>(<span class=
"idlType"><a href="#dom-thingdescription" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-thingdescription-4"><code>ThingDescription</code></a></span> <span class="idlParamName">td</span>);</span>
};</span></pre>
      <div>
        Belongs to the <a href="#dfn-wot-producer" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-wot-producer-1">WoT Producer</a> conformance
        class. Expects a <var data-type="ThingDescription">td</var>
        argument and returns a <a data-link-type="idl" href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
        that resolves with an <a data-link-type="idl" href=
        "#dom-exposedthing" class="internalDFN" id=
        "ref-for-dom-exposedthing-3"><code><code>ExposedThing</code></code></a>
        object that extends <a data-link-type="idl" href=
        "#dom-consumedthing" class="internalDFN" id=
        "ref-for-dom-consumedthing-6"><code><code>ConsumedThing</code></code></a>
        with a server interface, i.e. the ability to define request
        handlers. The method <em class="rfc2119">MUST</em> run the
        following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var data-type="ExposedThing">thing</var> be a
          new <a data-link-type="idl" href="#dom-exposedthing"
          class="internalDFN" id=
          "ref-for-dom-exposedthing-4"><code><code>ExposedThing</code></code></a>
          object constructed with <var data-type=
          "ThingDescription">td</var>.
          </li>
          <li>Resolve <var data-type="Promise">promise</var> with
          <var data-type="ExposedThing">thing</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-discover-method">
      <h3 id="x5-3-the-discover-method"><bdi class=
      "secno">5.3</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-wot-discover" data-idl="operation"
      data-title="discover()" data-dfn-for="WOT" data-type=
      "ThingDiscovery" data-lt="discover()|discover(, filter)"
      data-local-lt=
      "WOT.discover|WOT.discover()|discover"><code>discover()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-discover-method"></a></h3>
      <pre class="idl def" id="webidl-195238906"><span class=
      "idlHeader"><a class="self-link" href=
      "#webidl-195238906">WebIDL</a></span><span data-idl="" class=
      "idlNamespace" id="idl-def-wot" data-title=
      "WOT">partial namespace <a class="internalDFN idlID"
      data-link-type="namespace" href="#dom-wot" id=
      "ref-for-dom-wot-4"><code>WOT</code></a> {<span data-idl=""
      class="idlMethod" id="idl-def-wot-discover-filter" data-title=
      "discover" data-dfn-for="WOT"><span class="idlType">
  <a href="#dom-thingdiscovery" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-thingdiscovery-2"><code>ThingDiscovery</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-wot-discover" id=
"ref-for-dom-wot-discover-1"><code>discover</code></a>(optional<span class="idlType"> <a href="#dom-thingfilter"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-thingfilter-1"><code>ThingFilter</code></a></span> <span class="idlParamName">filter</span> = null);</span>
};</span></pre>
      <div>
        Belongs to the <a href="#dfn-wot-discovery" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-wot-discovery-1">WoT Discovery</a> conformance
        class. Starts the discovery process that will provide
        <a data-link-type="idl" href="#dom-thingdescription" class=
        "internalDFN" id=
        "ref-for-dom-thingdescription-5"><code><code>ThingDescription</code></code></a>
        objects for <a href="#dfn-thing-descriptions" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-thing-descriptions-12">Thing Description</a>s
        that match an optional <var data-type=
        "ThingFilter">filter</var> argument of type
        <a data-link-type="idl" href="#dom-thingfilter" class=
        "internalDFN" id=
        "ref-for-dom-thingfilter-2"><code><code>ThingFilter</code></code></a>.
        The method <em class="rfc2119">MUST</em> run the following
        steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          "<a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>"
          and abort these steps.
          </li>
          <li>Construct a <a href="#dom-thingdiscovery" class=
          "internalDFN" data-link-type="idl" id=
          "ref-for-dom-thingdiscovery-3"><code>ThingDiscovery</code></a>
          object <var data-type="ThingDiscovery">discovery</var>
          with <var data-type="ThingFilter">filter</var>.
          </li>
          <li>Invoke the <a href=
          "#the-start-method">discovery.start()</a> method.
          </li>
          <li>Return <var data-type=
          "ThingDiscovery">discovery</var>.</li>
        </ol>
      </div>
    </section>
  </section>
  <section id="handling-interaction-data">
    <h2 id="x6-handling-interaction-data"><bdi class=
    "secno">6.</bdi> Handling interaction data<a class="self-link"
    aria-label="§" href="#handling-interaction-data"></a></h2>
    <p>As specified in the <cite><a href=
    "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
    Web of Things Thing Description</a></cite> specification,
    <a href="#dfn-wot-interaction" class="internalDFN"
    data-link-type="dfn" id="ref-for-dfn-wot-interaction-6">WoT
    interactions</a> extend <a href="#dfn-dataschema" class=
    "internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-dataschema-1">DataSchema</a> and include a number
    of possible <a href="#dfn-form" class="internalDFN"
    data-link-type="dfn" id="ref-for-dfn-form-1">Form</a>s, out of
    which one is selected for the interaction. The <a href=
    "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#form">
    Form</a> contains a <code>contentType</code> to describe the
    data. For certain content types, a <a href="#dfn-dataschema"
    class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-dataschema-2">DataSchema</a> is defined, based on
    <a href="#dfn-json-schema" class="internalDFN" data-link-type=
    "dfn" id="ref-for-dfn-json-schema-1">JSON Schema</a>, making
    possible to represent these contents as JavaScript types and
    eventually set range constraints on the data.</p>
    <section data-dfn-for="InteractionInput" id=
    "the-interactioninput-type">
      <h3 id="x6-1-the-interactioninput-type"><bdi class=
      "secno">6.1</bdi> The <dfn data-export="" data-dfn-type=
      "typedef" id="dom-interactioninput" data-idl="typedef"
      data-title="InteractionInput" data-dfn-for=
      ""><code>InteractionInput</code></dfn> type<a class=
      "self-link" aria-label="§" href=
      "#the-interactioninput-type"></a></h3>
      <pre class="idl def" id="webidl-1492583996"><span class=
      "idlHeader"><a class="self-link" href=
      "#webidl-1492583996">WebIDL</a></span><span data-idl="" class=
      "idlTypedef" id="idl-def-dataschemavalue" data-title=
      "DataSchemaValue">typedef<span class="idlType"> <a data-type=
      "interface" href=
      "https://heycam.github.io/webidl/#idl-any">any</a></span> <a class=
      "internalDFN idlID" data-link-type="typedef" href=
      "#dom-dataschemavalue" id=
      "ref-for-dom-dataschemavalue-1"><code>DataSchemaValue</code></a>;</span><span data-idl=""
class="idlTypedef" id="idl-def-interactioninput" data-title=
"InteractionInput">
typedef<span class="idlType"> (<a data-type="interface" href=
"https://streams.spec.whatwg.org/#readablestream">ReadableStream</a> or <a href="#dom-dataschemavalue"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-dataschemavalue-2"><code>DataSchemaValue</code></a>)</span> <a class="internalDFN idlID"
data-link-type="typedef" href="#dom-interactioninput" id=
"ref-for-dom-interactioninput-1"><code>InteractionInput</code></a>;</span></pre>
      <p>Belongs to the <a href="#dfn-wot-consumer" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-consumer-2">WoT Consumer</a> conformance
      class and represents the <a href="#dfn-wot-interaction"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-interaction-7">WoT Interaction</a> data
      provided by application scripts to the UA.</p>
      <p><dfn data-export="" data-dfn-type="typedef" id=
      "dom-dataschemavalue" data-idl="typedef" data-title=
      "DataSchemaValue" data-dfn-for=
      ""><code>DataSchemaValue</code></dfn> is an <a href=
      "https://www.ecma-international.org/ecma-262/11.0/index.html#sec-ecmascript-data-types-and-values">
      ECMAScript value</a> that is accepted for <a href=
      "#dfn-dataschema" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-dataschema-3">DataSchema</a> defined in
      [<cite><a class="bibref" data-link-type="biblio" href=
      "#bib-wot-td" title=
      "Web of Things Thing Description">WoT-TD</a></cite>] (i.e.
      null, boolean, number, string, array, or object).</p>
      <p><a data-link-type="idl" data-type="interface" href=
      "https://streams.spec.whatwg.org/#readablestream"><code>ReadableStream</code></a>
      is meant to be used for <a href="#dfn-wot-interaction" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-interaction-8">WoT Interactions</a> that
      don't have a <a href="#dfn-dataschema" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-dataschema-4">DataSchema</a> in the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-thing-descriptions-13">Thing
      Description</a>, only a <a data-link-type="idl" href=
      "#dfn-form" class="internalDFN" id=
      "ref-for-dfn-form-2"><code>Form</code></a>'s
      <code>contentType</code> that can be represented by a
      stream.</p>
      <p>In practice, any <a href=
      "https://www.ecma-international.org/ecma-262/11.0/index.html#sec-ecmascript-data-types-and-values">
      ECMAScript value</a> may be used for <a href=
      "#dfn-wot-interaction" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-wot-interaction-9">WoT Interactions</a>
      that have a <a href="#dfn-dataschema" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-dataschema-5">DataSchema</a> defined in the
      <a href="#dfn-thing-descriptions" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-thing-descriptions-14">Thing Description</a>, or
      which can be mapped by implementations to the
      <a data-link-type="idl" href="#dfn-form" class="internalDFN"
      id="ref-for-dfn-form-3"><code>Form</code></a>'s
      <code>contentType</code> defined in the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-thing-descriptions-15">Thing
      Description</a>.</p>
      <p>The algorithms in this document specify how exactly input
      data is used in <a href="#dfn-wot-interaction" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-interaction-10">WoT Interactions</a>.</p>
    </section>
    <section data-dfn-for="InteractionOutput" id=
    "the-interactionoutput-interface">
      <h3 id="x6-2-the-interactionoutput-interface"><bdi class=
      "secno">6.2</bdi> The <dfn data-export="" data-dfn-type=
      "interface" id="dom-interactionoutput" data-idl="interface"
      data-title="InteractionOutput" data-dfn-for=
      ""><code>InteractionOutput</code></dfn> interface<a class=
      "self-link" aria-label="§" href=
      "#the-interactionoutput-interface"></a></h3>
      <p>Belongs to the <a href="#dfn-wot-consumer" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-consumer-3">WoT Consumer</a> conformance
      class. An <a data-link-type="idl" href=
      "#dom-interactionoutput" class="internalDFN" id=
      "ref-for-dom-interactionoutput-1"><code><code>InteractionOutput</code></code></a>
      object is always created by the implementations and exposes
      the data returned from <a href="#dfn-wot-interaction" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-interaction-11">WoT Interactions</a> to
      application scripts.</p>
      <p>This interface exposes a convenience function which should
      cover the vast majority of IoT use cases: the <a href=
      "#the-value-function">value()</a> function. Its
      implementation will inspect the data, parse it if adheres to
      a <a href="#dfn-dataschema" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-dataschema-6">DataSchema</a>, or otherwise fail
      early, leaving the underlying stream undisturbed so that
      application scripts could attempt reading the stream
      themselves, or handling the data as <a data-link-type="idl"
      data-type="interface" href=
      "https://heycam.github.io/webidl/#idl-ArrayBuffer"><code>ArrayBuffer</code></a>.</p>
      <pre class="idl def" id="webidl-761188038"><span class=
      "idlHeader"><a class="self-link" href=
      "#webidl-761188038">WebIDL</a></span><span data-idl="" class=
      "idlInterface" id="idl-def-interactionoutput" data-title=
      "InteractionOutput">[<span class="extAttr"><a data-type=
      "extended-attribute" href=
      "https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-type="interface"
href="#dom-interactionoutput" id=
"ref-for-dom-interactionoutput-2"><code>InteractionOutput</code></a> {<span data-idl=""
class="idlAttribute" id="idl-def-interactionoutput-data"
data-title="data" data-dfn-for="InteractionOutput">
  readonly attribute<span class="idlType"> <a data-type="interface"
href=
"https://streams.spec.whatwg.org/#readablestream">ReadableStream</a>?</span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-interactionoutput-data" id=
"ref-for-dom-interactionoutput-data-1"><code>data</code></a>;</span><span data-idl=""
class="idlAttribute" id="idl-def-interactionoutput-dataused"
data-title="dataUsed" data-dfn-for="InteractionOutput">
  readonly attribute<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-interactionoutput-dataused"
id=
"ref-for-dom-interactionoutput-dataused-1"><code>dataUsed</code></a>;</span><span data-idl=""
class="idlAttribute" id="idl-def-interactionoutput-form"
data-title="form" data-dfn-for="InteractionOutput">
  readonly attribute<span class="idlType"> <a href="#dfn-form"
class="internalDFN" data-link-type="dfn" id=
"ref-for-dfn-form-4">Form</a>?</span> <a class=
"internalDFN idlName" data-link-type="attribute" href=
"#dom-interactionoutput-form" id=
"ref-for-dom-interactionoutput-form-1"><code>form</code></a>;</span><span data-idl=""
class="idlAttribute" id="idl-def-interactionoutput-schema"
data-title="schema" data-dfn-for="InteractionOutput">
  readonly attribute<span class="idlType"> <a href=
"#dfn-dataschema" class="internalDFN" data-link-type="dfn" id=
"ref-for-dfn-dataschema-7">DataSchema</a>?</span> <a class=
"internalDFN idlName" data-link-type="attribute" href=
"#dom-interactionoutput-schema" id=
"ref-for-dom-interactionoutput-schema-1"><code>schema</code></a>;</span><span data-idl=""
class="idlMethod" id="idl-def-interactionoutput-arraybuffer"
data-title="arrayBuffer" data-dfn-for=
"InteractionOutput"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-ArrayBuffer">ArrayBuffer</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-interactionoutput-arraybuffer"
id=
"ref-for-dom-interactionoutput-arraybuffer-1"><code>arrayBuffer</code></a>();</span><span data-idl=""
class="idlMethod" id="idl-def-interactionoutput-value" data-title=
"value" data-dfn-for="InteractionOutput"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-interactionoutput-value" id=
"ref-for-dom-interactionoutput-value-1"><code>value</code></a>();</span>
};</span></pre>
      <p>The <dfn data-export="" data-dfn-type="attribute" id=
      "dom-interactionoutput-data" data-idl="attribute" data-title=
      "data" data-dfn-for="InteractionOutput" data-type=
      "ReadableStream" data-lt="data" data-local-lt=
      "InteractionOutput.data"><code>data</code></dfn> property
      represents the raw payload in <a href="#dfn-wot-interaction"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-interaction-12">WoT Interactions</a> as a
      <a data-link-type="idl" data-type="interface" href=
      "https://streams.spec.whatwg.org/#readablestream"><code>ReadableStream</code></a>,
      initially <code>null</code>.</p>
      <p>The <dfn data-export="" data-dfn-type="attribute" id=
      "dom-interactionoutput-dataused" data-idl="attribute"
      data-title="dataUsed" data-dfn-for="InteractionOutput"
      data-type="boolean" data-lt="dataUsed" data-local-lt=
      "InteractionOutput.dataUsed"><code>dataUsed</code></dfn>
      property tells whether the data stream has been <a href=
      "https://fetch.spec.whatwg.org/#concept-readablestream-disturbed">
      disturbed</a>. Initially <code>false</code>.</p>
      <p>The <dfn data-export="" data-dfn-type="attribute" id=
      "dom-interactionoutput-form" data-idl="attribute" data-title=
      "form" data-dfn-for="InteractionOutput" data-type="Form"
      data-lt="form" data-local-lt=
      "InteractionOutput.form"><code>form</code></dfn> attribute
      represents the <a href="#dfn-form" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-form-5">Form</a>
      selected from the <a href="#dfn-thing-descriptions" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-thing-descriptions-16">Thing Description</a> for
      this <a href="#dfn-wot-interaction" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-wot-interaction-13">WoT
      Interaction</a>, initially <code>null</code>.</p>
      <p>The <dfn data-export="" data-dfn-type="attribute" id=
      "dom-interactionoutput-schema" data-idl="attribute"
      data-title="schema" data-dfn-for="InteractionOutput"
      data-type="DataSchema" data-lt="schema" data-local-lt=
      "InteractionOutput.schema"><code>schema</code></dfn>
      attribute represents the <a href="#dfn-dataschema" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-dataschema-8">DataSchema</a> (defined in
      [<cite><a class="bibref" data-link-type="biblio" href=
      "#bib-wot-td" title=
      "Web of Things Thing Description">WoT-TD</a></cite>]) of the
      payload as a <a data-link-type="idl" href=
      "https://tc39.es/ecma262/#sec-json-object"><code>JSON</code></a>
      object, initially <code>null</code>.</p>
      <p>The <dfn data-dfn-type="idl" id=
      "dfn-value">[[value]]</dfn> internal slot represents the
      parsed value of the <a href="#dfn-wot-interaction" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-interaction-14">WoT Interaction</a>,
      initially <code>undefined</code> (note that <code>null</code>
      is a valid value).</p>
      <section id="the-value-function">
        <h4 id="x6-2-1-the-value-function"><bdi class=
        "secno">6.2.1</bdi> The <dfn data-export="" data-dfn-type=
        "method" id="dom-interactionoutput-value" data-idl=
        "operation" data-title="value()" data-dfn-for=
        "InteractionOutput" data-type="Promise" data-lt="value()"
        data-local-lt=
        "InteractionOutput.value|InteractionOutput.value()|value"><code>
        value()</code></dfn> function<a class="self-link"
        aria-label="§" href="#the-value-function"></a></h4>Parses
        the data returned by the <a href="#dfn-wot-interaction"
        class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-wot-interaction-15">WoT Interaction</a> and
        returns a value with the type described by the interaction
        <a href="#dfn-dataschema" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-dataschema-9">DataSchema</a> if that exists,
        or by the <code>contentType</code> of the interaction
        <a href="#dfn-form" class="internalDFN" data-link-type=
        "dfn" id="ref-for-dfn-form-6">Form</a>. The method
        <em class="rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If the value of the <a href="#dfn-value" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-value-1">[[value]]</a> <a data-link-type=
          "dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> is not <code>undefined</code>,
            resolve <var data-type="Promise">promise</var> with
            that value and abort these steps.
          </li>
          <li>If the value of the <var>data</var> property is not a
          <a data-link-type="idl" data-type="interface" href=
          "https://streams.spec.whatwg.org/#readablestream"><code>
            ReadableStream</code></a> or if <var>dataUsed</var> is
            <code>true</code>, or if <var>form</var> is
            <code>null</code> or if <var>schema</var> or its
            <var>type</var> are <code>null</code> or
            <code>undefined</code>, reject <var data-type=
            "Promise">promise</var> with <a data-link-type="idl"
            data-type="exception" href=
            "https://heycam.github.io/webidl/#notreadableerror"><code>
            NotReadableError</code></a> and abort these steps.
          </li>
          <li>If <var>form</var>'s <var>contentType</var> is not
          <code>application/json</code> and if a mapping is not
          available in the <a href="#dfn-protocol-bindings"
            class="internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-3">Protocol Bindings</a>
            from <var>form</var>'s <var>contentType</var> to
            [<cite><a class="bibref" data-link-type="biblio" href=
            "#bib-json-schema" title=
            "JSON Schema: core definitions and terminology">JSON-SCHEMA</a></cite>],
            reject <var data-type="Promise">promise</var> with
            <a data-link-type="idl" data-type="exception" href=
            "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> and abort these steps.
          </li>
          <li>Let <var>reader</var> be the result of <a href=
          "https://fetch.spec.whatwg.org/#concept-get-reader">getting
          a reader</a> from <var>data</var>. If that threw an
          exception, reject <var data-type="Promise">promise</var>
          with that exception and abort these steps.
          </li>
          <li>Let <var>bytes</var> be the result of <a href=
          "https://fetch.spec.whatwg.org/#concept-read-all-bytes-from-readablestream">
            reading all bytes</a> from <var>data</var> with
            <var>reader</var>.
          </li>
          <li>Set <var>dataUsed</var> to <code>true</code>.</li>
          <li>If <var>form</var>'s <var>contentType</var> is not
          <code>application/json</code> and if a mapping is
          available in the <a href="#dfn-protocol-bindings"
            class="internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-4">Protocol Bindings</a>
            from <var>form</var>'s <var>contentType</var> to
            [<cite><a class="bibref" data-link-type="biblio" href=
            "#bib-json-schema" title=
            "JSON Schema: core definitions and terminology">JSON-SCHEMA</a></cite>],
            transform <var>bytes</var> with that mapping.
          </li>
          <li>Let <var>json</var> be the result of running
          <a data-link-type="dfn" href=
          "https://infra.spec.whatwg.org/#parse-json-from-bytes">parse
          JSON from bytes</a> on <var>bytes</var>. If that throws,
          reject <var data-type="Promise">promise</var> with that
          exception and abort these steps.
          </li>
          <li>Set <a href="#dfn-value" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-value-2">[[value]]</a> to the result of
          running <a href="#dfn-check-data-schema" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-check-data-schema-1">check data schema</a>
          on <var>json</var> and <var>schema</var>. If that throws,
          reject <var data-type="Promise">promise</var> with that
          exception and abort these steps.
          </li>
          <li>Resolve <var data-type="Promise">promise</var> with
          <a href="#dfn-value" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-value-3">[[value]]</a>.
          </li>
        </ol>
      </section>
      <section id="the-arraybuffer-function">
        <h4 id="x6-2-2-the-arraybuffer-function"><bdi class=
        "secno">6.2.2</bdi> The <dfn data-export="" data-dfn-type=
        "method" id="dom-interactionoutput-arraybuffer" data-idl=
        "operation" data-title="arrayBuffer()" data-dfn-for=
        "InteractionOutput" data-type="Promise" data-lt=
        "arrayBuffer()" data-local-lt=
        "InteractionOutput.arrayBuffer|InteractionOutput.arrayBuffer()|arrayBuffer">
        <code>arrayBuffer()</code></dfn> function<a class=
        "self-link" aria-label="§" href=
        "#the-arraybuffer-function"></a></h4>When invoked,
        <em class="rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If <var>data</var> is not <a data-link-type="idl"
          data-type="interface" href=
          "https://streams.spec.whatwg.org/#readablestream"><code>
            ReadableStream</code></a> or if <var>dataUsed</var> is
            <code>true</code>, reject <var data-type=
            "Promise">promise</var> with <a data-link-type="idl"
            data-type="exception" href=
            "https://heycam.github.io/webidl/#notreadableerror"><code>
            NotReadableError</code></a> and abort these steps.
          </li>
          <li>Let <var>reader</var> be the result of <a href=
          "https://fetch.spec.whatwg.org/#concept-get-reader">getting
          a reader</a> from <var>data</var>. If that threw an
          exception, reject <var data-type="Promise">promise</var>
          with that exception and abort these steps.
          </li>
          <li>Let <var>bytes</var> be the result of <a href=
          "https://fetch.spec.whatwg.org/#concept-read-all-bytes-from-readablestream">
            reading all bytes</a> from <var>data</var> with
            <var>reader</var>.
          </li>
          <li>Set <var>dataUsed</var> to <code>true</code>.</li>
          <li>Let <var>arrayBuffer</var> be a new
            <a data-link-type="idl" data-type="interface" href=
            "https://heycam.github.io/webidl/#idl-ArrayBuffer"><code>
            ArrayBuffer</code></a> whose contents are
            <var>bytes</var>. If that throws, reject
            <var data-type="Promise">promise</var> with that
            exception and abort these steps.
          </li>
          <li>Resolve <var data-type="Promise">promise</var> with
          <var>arrayBuffer</var>.</li>
        </ol>
      </section>
      <section id="the-check-data-schema-algorithm">
        <h4 id="x6-2-3-the-check-data-schema-algorithm"><bdi class=
        "secno">6.2.3</bdi> The <dfn id=
        "dfn-check-data-schema">check data schema</dfn>
        algorithm<a class="self-link" aria-label="§" href=
        "#the-check-data-schema-algorithm"></a></h4>To run the
        <a href="#dfn-check-data-schema" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-check-data-schema-2">check data schema</a>
        steps on <var>payload</var> and <var data-type=
        "object">schema</var>,
        <ol>
          <li>Let <var>type</var> be <var data-type=
          "object">schema</var>'s <var>type</var>.</li>
          <li>If <var>type</var> is <code>"null"</code> and if
          <var>payload</var> is not <code>null</code>, throw
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#exceptiondef-typeerror">
            <code>TypeError</code></a> and abort these steps,
            otherwise return <code>null</code>.
          </li>
          <li>If <var>type</var> is <code>"boolean"</code> and
          <var>payload</var> is a falsey value or its byte length
          is 0, return <code>false</code>, otherwise return
          <code>true</code>.</li>
          <li>If <var>type</var> is <code>"integer"</code> or
          <code>"number"</code>,
            <ol>
              <li>If <var>payload</var> is not a number, throw
              <a data-link-type="idl" data-type="exception" href=
              "https://heycam.github.io/webidl/#exceptiondef-typeerror">
                <code>TypeError</code></a> and abort these steps.
              </li>
              <li>If <var>form</var>'s <var>minimum</var> is
              defined and <var>payload</var> is smaller, or if
              <var>form</var>'s <var>maximum</var> is defined and
              <var>payload</var> is bigger, throw
                <a data-link-type="idl" data-type="exception" href=
                "https://heycam.github.io/webidl/#exceptiondef-rangeerror">
                <code>RangeError</code></a> and abort these steps.
              </li>
            </ol>
          </li>
          <li>If <var>type</var> is <code>"string"</code>, return
          <var>payload</var>.</li>
          <li>If <var>type</var> is <code>"array"</code>, run these
          sub-steps:
            <ol>
              <li>If <var>payload</var> is not an array, throw
              <a data-link-type="idl" data-type="exception" href=
              "https://heycam.github.io/webidl/#exceptiondef-typeerror">
                <code>TypeError</code></a> and abort these steps.
              </li>
              <li>If <var>form</var>'s <var>minItems</var> is
              defined and <var>payload</var>'s <var>length</var> is
              less than that, or if <var>form</var>'s
              <var>maxItems</var> is defined and
              <var>payload</var>'s <var>length</var> is more than
              that, throw <a data-link-type="idl" data-type=
              "exception" href=
              "https://heycam.github.io/webidl/#exceptiondef-rangeerror">
                <code>RangeError</code></a> and abort these steps.
              </li>
              <li>Let <var>payload</var> be an array of items
              obtained by running the <a href=
              "#dfn-check-data-schema" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-check-data-schema-3">check data
              schema</a> steps on each element <var>item</var> of
              <var>payload</var> and <var data-type=
              "object">schema</var>'s <var>items</var>. If this
              throws at any stage, re-throw that exception and
              abort these steps.
              </li>
            </ol>
          </li>
          <li>If <var>type</var> is <code>"object"</code>, run
          these sub-steps:
            <ol>
              <li>If <var>payload</var> or <var data-type="object">
                schema</var>'s <var>properties</var> is not an
                object, throw <a data-link-type="idl" data-type=
                "exception" href=
                "https://heycam.github.io/webidl/#exceptiondef-typeerror">
                <code>TypeError</code></a> and abort these steps.
              </li>
              <li>For each property <var>key</var> in
              <var>payload</var>,
                <ol>
                  <li>Let <var>prop</var> be the value of
                  <var>key</var>.</li>
                  <li>Let <var>propSchema</var> be the value of
                  <var>key</var> in <var>interaction</var>'s
                  <var>properties</var>.</li>
                  <li>Let <var>prop</var> be the result of running
                  the <a href="#dfn-check-data-schema" class=
                  "internalDFN" data-link-type="dfn" id=
                  "ref-for-dfn-check-data-schema-4">check data
                  schema</a> steps on <var>prop</var> and
                  <var>propSchema</var>. If this throws, re-throw
                  that exception and abort these steps.
                  </li>
                </ol>
              </li>
              <li>Let <var>required</var> be <var data-type=
              "object">schema</var>'s <var>required</var> if that
              is an array or an empty array otherwise.</li>
              <li>For each <var>key</var> in <var>required</var>,
              if <var>key</var> is not present in
              <var>payload</var>, throw <a data-link-type="idl"
              data-type="exception" href=
              "https://heycam.github.io/webidl/#syntaxerror"><code>
                SyntaxError</code></a> and abort these steps.
              </li>
            </ol>
          </li>
          <li>Return <var>payload</var>.</li>
        </ol>
      </section>
      <section id="the-create-interaction-request-algorithm">
        <h4 id="x6-2-4-the-create-interaction-request-algorithm">
        <bdi class="secno">6.2.4</bdi> The <dfn id=
        "dfn-create-interaction-request">create interaction
        request</dfn> algorithm<a class="self-link" aria-label="§"
        href=
        "#the-create-interaction-request-algorithm"></a></h4>For a
        given <a href="#dom-consumedthing" class="internalDFN"
        data-link-type="idl" id=
        "ref-for-dom-consumedthing-7"><code>ConsumedThing</code></a>
        object <var data-type="ConsumedThing">thing</var>, in order
        to <a href="#dfn-create-interaction-request" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-create-interaction-request-1">create
        interaction request</a> given a <var data-type=
        "InteractionInput">source</var>, <var data-type=
        "Form">form</var> and <var data-type="object">schema</var>,
        run these steps:
        <ol>
          <li>Let <var>idata</var> be a new an <a data-link-type=
          "idl" href="#dom-interactionoutput" class="internalDFN"
          id=
          "ref-for-dom-interactionoutput-3"><code><code>InteractionOutput</code></code></a>
          object whose <var data-type="Form">form</var> is set to
          <var data-type="Form">form</var>, whose <var data-type=
          "object">schema</var> is set to <var data-type="object">
            schema</var>, whose [[value]] <a data-link-type="dfn"
            href=
            "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> is <code>undefined</code> and whose
            <var>data</var> is <code>null</code>.
          </li>
          <li>If <var data-type="InteractionInput">source</var> is
          a <a data-link-type="idl" data-type="interface" href=
          "https://streams.spec.whatwg.org/#readablestream"><code>
            ReadableStream</code></a> object, let
            <var>idata</var>'s <var>data</var> be <var data-type=
            "InteractionInput">source</var>, return
            <var>idata</var> and abort these steps.
          </li>
          <li>If <var data-type="object">schema</var> and its <var>
            type</var> are defined and not <code>null</code>, run
            these sub-steps:
            <ol>
              <li>If <var>type</var> is <code>"null"</code> and
              <var data-type="InteractionInput">source</var> is
              not, throw <a data-link-type="idl" data-type=
              "exception" href=
              "https://heycam.github.io/webidl/#exceptiondef-typeerror">
                <code>TypeError</code></a> and abort these steps.
              </li>
              <li>If <var>type</var> is <code>"boolean"</code> and
              <var data-type="InteractionInput">source</var> is a
              falsy value, set <var>idata</var>'s [[value]]
              <var>value</var> to <code>false</code>, otherwise to
              <code>true</code>.</li>
              <li>If <var>type</var> is <code>"integer"</code> or
              <code>"number"</code> and <var data-type=
              "InteractionInput">source</var> is not a number, or
              if <var data-type="Form">form</var>'s
              <var>minimum</var> is defined and <var data-type=
              "InteractionInput">source</var> is smaller, or if
              <var data-type="Form">form</var>'s <var>maximum</var>
              is defined and <var data-type=
              "InteractionInput">source</var> is bigger, throw
              <a data-link-type="idl" data-type="exception" href=
              "https://heycam.github.io/webidl/#exceptiondef-rangeerror">
                <code>RangeError</code></a> and abort these steps.
              </li>
              <li>If <var>type</var> is <code>"string"</code> and
              <var data-type="InteractionInput">source</var> is not
              a string, let <var>idata</var>'s [[value]] be the
              result of running <a data-link-type="dfn" href=
              "https://infra.spec.whatwg.org/#serialize-json-to-bytes">
                serialize JSON to bytes</a> on <var data-type=
                "InteractionInput">source</var>. If that is
                failure, throw <a data-link-type="idl" data-type=
                "exception" href=
                "https://heycam.github.io/webidl/#syntaxerror"><code>
                SyntaxError</code></a> and abort these steps.
              </li>
              <li>If <var>type</var> is <code>"array"</code>, run
              these sub-steps:
                <ol>
                  <li>If <var data-type=
                  "InteractionInput">source</var> is not an array,
                  throw a <a data-link-type="idl" data-type=
                  "exception" href=
                  "https://heycam.github.io/webidl/#exceptiondef-typeerror">
                    <code>TypeError</code></a> and abort these
                    steps.
                  </li>
                  <li>Let <var>length</var> be the length of
                  <var data-type=
                  "InteractionInput">source</var>.</li>
                  <li>If <var data-type="Form">form</var>'s
                  <var>minItems</var> is defined and
                  <var>length</var> is less than that, or if
                  <var data-type="Form">form</var>'s
                  <var>maxItems</var> is defined and
                  <var>length</var> is more than that, throw
                  <a data-link-type="idl" data-type="exception"
                  href=
                  "https://heycam.github.io/webidl/#exceptiondef-rangeerror">
                    <code>RangeError</code></a> and abort these
                    steps.
                  </li>
                  <li>For each <var>item</var> in <var data-type=
                  "InteractionInput">source</var>, let
                  <var>itemschema</var> be <var data-type="object">
                    schema</var>'s <var>items</var> and let
                    <var>item</var> be the result of running the
                    <a href="#dfn-create-interaction-request"
                    class="internalDFN" data-link-type="dfn" id=
                    "ref-for-dfn-create-interaction-request-2">create
                    interaction request</a> steps on
                    <var>item</var>, <var data-type=
                    "Form">form</var> and <var>itemschema</var>. If
                    this throws, re-throw that exception and abort
                    these steps.
                  </li>
                  <li>Set <var>data</var>'s [[value]] to
                  <var data-type=
                  "InteractionInput">source</var>.</li>
                </ol>
              </li>
              <li>If <var>type</var> is <code>"object"</code>, run
              these sub-steps:
                <ol>
                  <li>If <var data-type=
                  "InteractionInput">source</var> is not an object,
                  throw <a data-link-type="idl" data-type=
                  "exception" href=
                  "https://heycam.github.io/webidl/#exceptiondef-typeerror">
                    <code>TypeError</code></a> and abort these
                    steps.
                  </li>
                  <li>If <var data-type="object">schema</var>'s
                  <var>properties</var> is not an object, throw
                  <a data-link-type="idl" data-type="exception"
                  href=
                  "https://heycam.github.io/webidl/#exceptiondef-typeerror">
                    <code>TypeError</code></a> and abort these
                    steps.
                  </li>
                  <li>For each property <var>key</var> in
                  <var data-type="InteractionInput">source</var>,
                    <ol>
                      <li>Let <var>value</var> be the value of
                      <var>key</var>.</li>
                      <li>Let <var>propschema</var> be the value of
                      <var>key</var> in <var>properties</var>.</li>
                      <li>Let <var>value</var> be the result of
                      running the <a href=
                      "#dfn-create-interaction-request" class=
                      "internalDFN" data-link-type="dfn" id=
                      "ref-for-dfn-create-interaction-request-3">create
                      interaction request</a> steps on
                      <var>value</var>, <var data-type=
                      "Form">form</var> and <var>propschema</var>.
                      If this throws, re-throw that exception and
                      abort these steps.
                      </li>
                    </ol>
                  </li>
                  <li>If <var data-type="object">schema</var>'s
                  <var>required</var> is an array, for each
                  <var>item</var> in <var>required</var> check if
                  <var>item</var> is a property name in
                  <var data-type="InteractionInput">source</var>.
                  If an <var>item</var> is not found in
                  <var data-type="InteractionInput">source</var>,
                  throw <a data-link-type="idl" data-type=
                  "exception" href=
                  "https://heycam.github.io/webidl/#syntaxerror"><code>
                    SyntaxError</code></a> and abort these steps.
                  </li>
                  <li>Set <var>data</var>'s [[value]] to
                  <var data-type=
                  "InteractionInput">source</var>.</li>
                </ol>
              </li>
            </ol>
          </li>
          <li>Set <var>idata</var>'s <var>data</var> to a new
          <a data-link-type="idl" data-type="interface" href=
          "https://streams.spec.whatwg.org/#readablestream"><code>
            ReadableStream</code></a> created from
            <var>idata</var>'s [[value]] <a data-link-type="dfn"
            href=
            "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> as its <a href=
            "https://streams.spec.whatwg.org/#underlying-source">underlying
            source</a>.
          </li>
          <li>Return <var>idata</var>.</li>
        </ol>
      </section>
      <section id="the-parse-interaction-response-algorithm">
        <h4 id="x6-2-5-the-parse-interaction-response-algorithm">
        <bdi class="secno">6.2.5</bdi> The <dfn id=
        "dfn-parse-interaction-response">parse interaction
        response</dfn> algorithm<a class="self-link" aria-label="§"
        href=
        "#the-parse-interaction-response-algorithm"></a></h4>For a
        given <a href="#dom-consumedthing" class="internalDFN"
        data-link-type="idl" id=
        "ref-for-dom-consumedthing-8"><code>ConsumedThing</code></a>
        object <var data-type="ConsumedThing">thing</var>, in order
        to <a href="#dfn-parse-interaction-response" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-parse-interaction-response-1">parse
        interaction response</a> given <var>response</var>,
        <var data-type="Form">form</var> and <var data-type=
        "object">schema</var>, run these steps:
        <ol>
          <li>Let <var>result</var> be a new <a data-link-type=
          "idl" href="#dom-interactionoutput" class="internalDFN"
          id=
          "ref-for-dom-interactionoutput-4"><code><code>InteractionOutput</code></code></a>
          object.
          </li>
          <li>Let <var>result</var>'s <var data-type=
          "object">schema</var> be <var data-type=
          "object">schema</var>.</li>
          <li>Let <var>result</var>'s <var data-type=
          "Form">form</var> be <var data-type=
          "Form">form</var>.</li>
          <li>Let <var>result</var>'s <var>data</var> be a new
          <a data-link-type="idl" data-type="interface" href=
          "https://streams.spec.whatwg.org/#readablestream"><code>
            ReadableStream</code></a> with the payload data of
            <var>response</var> as its <a href=
            "https://streams.spec.whatwg.org/#underlying-source">underlying
            source</a>.
          </li>
          <li>Let <var>result</var>'s <var>dataUsed</var> be
          <code>false</code>.</li>
          <li>Return <var>result</var>.</li>
        </ol>
      </section>
    </section>
    <section id="using-interactioninput-and-interactionoutput">
      <h3 id="x6-3-using-interactioninput-and-interactionoutput">
      <bdi class="secno">6.3</bdi> Using <a data-link-type="idl"
      href="#dom-interactioninput" class="internalDFN" id=
      "ref-for-dom-interactioninput-2"><code><code>InteractionInput</code></code></a>
      and <a data-link-type="idl" href="#dom-interactionoutput"
      class="internalDFN" id=
      "ref-for-dom-interactionoutput-5"><code><code>InteractionOutput</code></code></a><a class="self-link"
      aria-label="§" href=
      "#using-interactioninput-and-interactionoutput"></a></h3>
      <p>As illustrated in the next pictures, the
      <a data-link-type="idl" href="#dom-interactionoutput" class=
      "internalDFN" id=
      "ref-for-dom-interactionoutput-6"><code><code>InteractionOutput</code></code></a>
      interface is used every time implementations provide data to
      scripts, while <a data-link-type="idl" href=
      "#dom-interactioninput" class="internalDFN" id=
      "ref-for-dom-interactioninput-3"><code><code>InteractionInput</code></code></a>
      is used when the scripts pass data to the implementation.</p>
      <figure id="scripting-read">
        <img src="images/scripting-read-data.png" width="100%"
        title="Reading data">
        <figcaption>
          Figure <bdi class="figno">1</bdi> <span class=
          "fig-title">Data structures used when reading data</span>
        </figcaption>
      </figure>
      <p>When a <a data-link-type="idl" href="#dom-consumedthing"
      class="internalDFN" id=
      "ref-for-dom-consumedthing-9"><code><code>ConsumedThing</code></code></a>
      reads data, it receives it from the implementation as an
      <a data-link-type="idl" href="#dom-interactionoutput" class=
      "internalDFN" id=
      "ref-for-dom-interactionoutput-7"><code><code>InteractionOutput</code></code></a>
      object.</p>
      <p>An <a data-link-type="idl" href="#dom-exposedthing" class=
      "internalDFN" id=
      "ref-for-dom-exposedthing-5"><code><code>ExposedThing</code></code></a>
      <a href="#the-propertyreadhandler-callback">read handler</a>
      provides the read data to the implementation as
      <a data-link-type="idl" href="#dom-interactioninput" class=
      "internalDFN" id=
      "ref-for-dom-interactioninput-4"><code><code>InteractionInput</code></code></a>.</p>
      <figure id="scripting-write">
        <img src="images/scripting-write-data.png" width="100%"
        title="Writing data">
        <figcaption>
          Figure <bdi class="figno">2</bdi> <span class=
          "fig-title">Data structures used when writing data</span>
        </figcaption>
      </figure>
      <p>When a <a data-link-type="idl" href="#dom-consumedthing"
      class="internalDFN" id=
      "ref-for-dom-consumedthing-10"><code><code>ConsumedThing</code></code></a>
      writes data, it provides it to the implementation as
      <a data-link-type="idl" href="#dom-interactioninput" class=
      "internalDFN" id=
      "ref-for-dom-interactioninput-5"><code><code>InteractionInput</code></code></a>.</p>
      <p>An <a data-link-type="idl" href="#dom-exposedthing" class=
      "internalDFN" id=
      "ref-for-dom-exposedthing-6"><code><code>ExposedThing</code></code></a>
      <a href="#the-propertywritehandler-callback">write
      handler</a> receives data from to implementation as an
      <a data-link-type="idl" href="#dom-interactionoutput" class=
      "internalDFN" id=
      "ref-for-dom-interactionoutput-8"><code><code>InteractionOutput</code></code></a>
      object.</p>
      <figure id="scripting-action">
        <img src="images/scripting-action-data.png" width="100%"
        title="Invoking action">
        <figcaption>
          Figure <bdi class="figno">3</bdi> <span class=
          "fig-title">Data structures used when invoking an
          Action</span>
        </figcaption>
      </figure>
      <p>When a <a data-link-type="idl" href="#dom-consumedthing"
      class="internalDFN" id=
      "ref-for-dom-consumedthing-11"><code><code>ConsumedThing</code></code></a>
      invokes an <a href="#dfn-actions" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-actions-9">Action</a>
      data, it provides the parameters as <a data-link-type="idl"
      href="#dom-interactioninput" class="internalDFN" id=
      "ref-for-dom-interactioninput-6"><code><code>InteractionInput</code></code></a>
      and receives the output of the <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-actions-10">Action</a> as an <a data-link-type=
      "idl" href="#dom-interactionoutput" class="internalDFN" id=
      "ref-for-dom-interactionoutput-9"><code><code>InteractionOutput</code></code></a>
      object.</p>
      <p>An <a data-link-type="idl" href="#dom-exposedthing" class=
      "internalDFN" id=
      "ref-for-dom-exposedthing-7"><code><code>ExposedThing</code></code></a>
      <a href="#the-actionhandler-callback">action handler</a>
      receives arguments from the implementation as an
      <a data-link-type="idl" href="#dom-interactionoutput" class=
      "internalDFN" id=
      "ref-for-dom-interactionoutput-10"><code><code>InteractionOutput</code></code></a>
      object and provides <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-actions-11">Action</a> output as
      <a data-link-type="idl" href="#dom-interactioninput" class=
      "internalDFN" id=
      "ref-for-dom-interactioninput-7"><code><code>InteractionInput</code></code></a>
      to the implementation.</p>
    </section>
    <section id="error-handling">
      <h3 id="x6-4-error-handling"><bdi class="secno">6.4</bdi>
      Error handling<a class="self-link" aria-label="§" href=
      "#error-handling"></a></h3>
      <p>The algorithms in this API define the errors to be
      reported to application scripts.</p>
      <p>The errors reported to the other communication end are
      mapped and encapsulated by the <a href=
      "#dfn-protocol-bindings" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-protocol-bindings-5">Protocol
      Bindings</a>.</p>
      <figure id="scripting-error-handling">
        <img src="images/scripting-error-handling.png" width="100%"
        title="Error handling">
        <figcaption>
          Figure <bdi class="figno">4</bdi> <span class=
          "fig-title">Error handling in WoT interactions</span>
        </figcaption>
      </figure>
      <div class="note" id="issue-container-generatedID-7">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-5" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">This topic is still being discussed in <a href=
        "https://github.com/w3c/wot-scripting-api/issues/200">Issue
        #200</a>. A standardized error mapping would be needed in
        order to ensure consistency in mapping script errors to
        protocol errors and vice versa. In particular, when
        algorithms say "error received from the <a href=
        "#dfn-protocol-bindings" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-protocol-bindings-6">Protocol Bindings</a>",
        that will be factored out as an explicit error mapping
        algorithm. Currently, that is encapsulated by
        implementations.</p>
      </div>
    </section>
  </section>
  <section data-dfn-for="ConsumedThing" id=
  "the-consumedthing-interface">
    <h2 id="x7-the-consumedthing-interface"><bdi class=
    "secno">7.</bdi> The <dfn data-export="" data-dfn-type=
    "interface" id="dom-consumedthing" data-idl="interface"
    data-title="ConsumedThing" data-dfn-for=
    ""><code>ConsumedThing</code></dfn> interface<a class=
    "self-link" aria-label="§" href=
    "#the-consumedthing-interface"></a></h2>
    <p>Represents a client API to operate a <a href="#dfn-things"
    class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-things-30">Thing</a>. Belongs to the <a href=
    "#dfn-wot-consumer" class="internalDFN" data-link-type="dfn"
    id="ref-for-dfn-wot-consumer-4">WoT Consumer</a> conformance
    class.</p>
    <pre class="idl def" id="webidl-1146575940"><span class=
    "idlHeader"><a class="self-link" href=
    "#webidl-1146575940">WebIDL</a></span><span data-idl="" class=
    "idlInterface" id="idl-def-consumedthing" data-title=
    "ConsumedThing">[<span class="extAttr"><a data-type=
    "extended-attribute" href=
    "https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-type="interface"
href="#dom-consumedthing" id=
"ref-for-dom-consumedthing-12"><code>ConsumedThing</code></a> {<span data-idl=""
class="idlConstructor" id="idl-def-consumedthing-constructor-td"
data-title="constructor" data-dfn-for="ConsumedThing">
  <dfn data-export="" data-dfn-type="constructor" id=
"dom-consumedthing-constructor" data-idl="constructor" data-title=
"constructor" data-dfn-for="ConsumedThing" data-lt=
"constructor()|constructor(td)" data-local-lt=
"ConsumedThing.constructor|ConsumedThing.constructor()|constructor"><code>constructor</code></dfn>(<span class="idlType"><a href="#dom-thingdescription"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-thingdescription-6"><code>ThingDescription</code></a></span> <span class="idlParamName">td</span>);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-readproperty-propertyname-options"
data-title="readProperty" data-dfn-for="ConsumedThing"><span class=
"idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-interactionoutput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionoutput-11"><code>InteractionOutput</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-readproperty" id=
"ref-for-dom-consumedthing-readproperty-1"><code>readProperty</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">propertyName</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-1"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-readallproperties-options" data-title=
"readAllProperties" data-dfn-for="ConsumedThing"><span class=
"idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-propertymap"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-propertymap-1"><code>PropertyMap</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-readallproperties"
id=
"ref-for-dom-consumedthing-readallproperties-1"><code>readAllProperties</code></a>(optional<span class="idlType"> <a href="#dom-interactionoptions"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionoptions-2"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-readmultipleproperties-propertynames-options"
data-title="readMultipleProperties" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-propertymap"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-propertymap-2"><code>PropertyMap</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-consumedthing-readmultipleproperties" id=
"ref-for-dom-consumedthing-readmultipleproperties-1"><code>readMultipleProperties</code></a>(<span class="idlType">
                              <a data-type="dfn" href=
"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>&gt;</span> <span class="idlParamName">propertyNames</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-3"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-writeproperty-propertyname-value-options"
data-title="writeProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-writeproperty" id=
"ref-for-dom-consumedthing-writeproperty-1"><code>writeProperty</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">propertyName</span>,<span class="idlType">
                              <a href="#dom-interactioninput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactioninput-8"><code>InteractionInput</code></a></span> <span class="idlParamName">value</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-4"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-writemultipleproperties-valuemap-options"
data-title="writeMultipleProperties" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-consumedthing-writemultipleproperties" id=
"ref-for-dom-consumedthing-writemultipleproperties-1"><code>writeMultipleProperties</code></a>(<span class="idlType"><a href="#dom-propertymap"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-propertymap-3"><code>PropertyMap</code></a></span> <span class="idlParamName">valueMap</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-5"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-invokeaction-actionname-params-options"
data-title="invokeAction" data-dfn-for="ConsumedThing"><span class=
"idlType"><span class="idlSectionComment">
  /*Promise&lt;undefined&gt; writeAllProperties(PropertyMap valueMap,
                              optional InteractionOptions options = null);*/
  </span><a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-interactionoutput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionoutput-12"><code>InteractionOutput</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-invokeaction" id=
"ref-for-dom-consumedthing-invokeaction-1"><code>invokeAction</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">actionName</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactioninput" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactioninput-9"><code>InteractionInput</code></a></span> <span class="idlParamName">params</span> = null,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-6"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-observeproperty-name-listener-onerror-options"
data-title="observeProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-subscription"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-subscription-1"><code>Subscription</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-observeproperty"
id=
"ref-for-dom-consumedthing-observeproperty-1"><code>observeProperty</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
                              <a href="#dom-interactionlistener"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionlistener-1"><code>InteractionListener</code></a></span> <span class="idlParamName">listener</span>,
                              optional<span class=
"idlType"> <a href="#dom-errorlistener" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-errorlistener-1"><code>ErrorListener</code></a></span> <span class="idlParamName">onerror</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-7"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-subscribeevent-name-listener-onerror-options"
data-title="subscribeEvent" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-subscription"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-subscription-2"><code>Subscription</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-subscribeevent"
id="ref-for-dom-consumedthing-subscribeevent-1"><code>subscribeEvent</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
                              <a href="#dom-interactionlistener"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionlistener-2"><code>InteractionListener</code></a></span> <span class="idlParamName">listener</span>,
                              optional<span class=
"idlType"> <a href="#dom-errorlistener" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-errorlistener-2"><code>ErrorListener</code></a></span> <span class="idlParamName">onerror</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-8"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id="idl-def-consumedthing-getthingdescription"
data-title="getThingDescription" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a href="#dom-thingdescription" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-thingdescription-7"><code>ThingDescription</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-consumedthing-getthingdescription" id=
"ref-for-dom-consumedthing-getthingdescription-1"><code>getThingDescription</code></a>();</span>
};</span><span data-idl="" class="idlDictionary" id=
"idl-def-interactionoptions" data-title="InteractionOptions">

dictionary <a class="internalDFN idlID" data-link-type="dictionary"
href="#dom-interactionoptions" id=
"ref-for-dom-interactionoptions-9"><code>InteractionOptions</code></a> {<span data-idl=""
class="idlMember" id="idl-def-interactionoptions-formindex"
data-title="formIndex" data-dfn-for=
"InteractionOptions"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName"
data-link-type="dict-member" href=
"#dom-interactionoptions-formindex" id=
"ref-for-dom-interactionoptions-formindex-1"><code>formIndex</code></a>;</span><span data-idl=""
class="idlMember" id="idl-def-interactionoptions-urivariables"
data-title="uriVariables" data-dfn-for=
"InteractionOptions"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <a class="internalDFN idlName"
data-link-type="dict-member" href=
"#dom-interactionoptions-urivariables" id=
"ref-for-dom-interactionoptions-urivariables-1"><code>uriVariables</code></a>;</span><span data-idl=""
class="idlMember" id="idl-def-interactionoptions-data" data-title=
"data" data-dfn-for="InteractionOptions"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <a class=
"internalDFN idlName" data-link-type="dict-member" href=
"#dom-interactionoptions-data" id=
"ref-for-dom-interactionoptions-data-1"><code>data</code></a>;</span>
};</span><span data-idl="" class="idlInterface" id=
"idl-def-subscription" data-title="Subscription">

[<span class="extAttr"><a data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-type="interface"
href="#dom-subscription" id=
"ref-for-dom-subscription-3"><code>Subscription</code></a> {<span data-idl=""
class="idlAttribute" id="idl-def-subscription-active" data-title=
"active" data-dfn-for="Subscription">
  readonly attribute<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-subscription-active" id=
"ref-for-dom-subscription-active-1"><code>active</code></a>;</span><span data-idl=""
class="idlMethod" id="idl-def-subscription-stop-options"
data-title="stop" data-dfn-for="Subscription"><span class=
"idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-subscription-stop" id=
"ref-for-dom-subscription-stop-1"><code>stop</code></a>(optional<span class="idlType"> <a href="#dom-interactionoptions"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionoptions-10"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span>
};</span><span data-idl="" class="idlTypedef" id=
"idl-def-propertymap" data-title="PropertyMap">

typedef<span class="idlType"> <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <a class="internalDFN idlID"
data-link-type="typedef" href="#dom-propertymap" id=
"ref-for-dom-propertymap-4"><code>PropertyMap</code></a>;</span><span data-idl=""
class="idlCallback" id="idl-def-interactionlistener" data-title=
"InteractionListener">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-interactionlistener" id=
"ref-for-dom-interactionlistener-3"><code>InteractionListener</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a></span>(<span class="idlType"><a href="#dom-interactionoutput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionoutput-13"><code>InteractionOutput</code></a></span> <span class="idlParamName">data</span>);</span><span data-idl=""
class="idlCallback" id="idl-def-errorlistener" data-title=
"ErrorListener">
callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-errorlistener" id=
"ref-for-dom-errorlistener-3"><code>ErrorListener</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a></span>(<span class="idlType"><a data-link-type="dfn"
href=
"https://tc39.es/ecma262/#sec-error-objects">Error</a></span> <span class="idlParamName">error</span>);</span></pre>
    <div class="note" id="issue-container-generatedID-8">
      <div role="heading" class="ednote-title marker" id=
      "h-ednote-6" aria-level="3">
        <span>Editor's note</span><span class="issue-label">: Where
        is the writeAllProperties method?</span>
      </div>
      <p class="">The <code>writeAllProperties()</code> method is
      still under discussion. Meanwhile, use the
      <code>writeMultipleProperties()</code> method instead.</p>
    </div>
    <section id="internal-slots-for-consumedthing">
      <h3 id="x7-1-internal-slots-for-consumedthing"><bdi class=
      "secno">7.1</bdi> Internal slots for ConsumedThing<a class=
      "self-link" aria-label="§" href=
      "#internal-slots-for-consumedthing"></a></h3>
      <p>A <a data-link-type="idl" href="#dom-consumedthing" class=
      "internalDFN" id=
      "ref-for-dom-consumedthing-13"><code><code>ConsumedThing</code></code></a>
      object has the following <a data-link-type="dfn" href=
      "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
      internal slots</a>:</p>
      <table class="simple">
        <thead>
          <tr>
            <th>Internal Slot</th>
            <th>Initial value</th>
            <th>Description (<em>non-normative</em>)</th>
          </tr>
        </thead>
        <tbody data-link-for="ConsumedThing">
          <tr>
            <td><dfn data-dfn-type="idl" id=
            "dfn-td">[[td]]</dfn></td>
            <td><code>null</code></td>
            <td>
              The <a href="#dfn-thing-descriptions" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-thing-descriptions-17">Thing
              Description</a> of the <a data-link-type="idl" href=
              "#dom-consumedthing" class="internalDFN" id=
              "ref-for-dom-consumedthing-14"><code><code>ConsumedThing</code></code></a>.
            </td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="constructing-consumedthing">
      <h3 id="x7-2-constructing-consumedthing"><bdi class=
      "secno">7.2</bdi> Constructing
      <code>ConsumedThing</code><a class="self-link" aria-label="§"
      href="#constructing-consumedthing"></a></h3>
      <p>After <a href="#fetching-a-thing-description">fetching</a>
      a <a href="#dfn-thing-descriptions" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-thing-descriptions-18">Thing Description</a> as
      a JSON object, one can create a <a data-link-type="idl" href=
      "#dom-consumedthing" class="internalDFN" id=
      "ref-for-dom-consumedthing-15"><code><code>ConsumedThing</code></code></a>
      object.</p>
      <div>
        To create <a data-link-type="idl" href="#dom-consumedthing"
        class="internalDFN" id=
        "ref-for-dom-consumedthing-16"><code><code>ConsumedThing</code></code></a>
        with the <a data-link-type="idl" href=
        "#dom-thingdescription" class="internalDFN" id=
        "ref-for-dom-thingdescription-8"><code><code>ThingDescription</code></code></a>
        <var data-type="ThingDescription">td</var>, run the
        following steps:
        <ol>
          <li>Run the <a href="#dfn-validate-a-td" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-validate-a-td-1">validate a TD</a> steps on
          <var data-type="ThingDescription">td</var>. If that
          fails, <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a>
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#syntaxerror"><code>SyntaxError</code></a>
          and abort these steps.
          </li>
          <li>Run the <a href="#dfn-expand-a-td" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-expand-a-td-1">expand a TD</a> steps on
          <var data-type="ThingDescription">td</var>. If that
          fails, re-<a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a>
          the error and abort these steps.
          </li>
          <li>Let <var data-type="ConsumedThing">thing</var> be a
          new <a data-link-type="idl" href="#dom-consumedthing"
          class="internalDFN" id=
          "ref-for-dom-consumedthing-17"><code><code>ConsumedThing</code></code></a>
          object.
          </li>
          <li>Set the <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[td]] of <var data-type=
            "ConsumedThing">thing</var> to <var data-type=
            "ThingDescription">td</var>.
          </li>
          <li>Return <var data-type=
          "ConsumedThing">thing</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-getthingdescription-method">
      <h3 id="x7-3-the-getthingdescription-method"><bdi class=
      "secno">7.3</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-consumedthing-getthingdescription" data-idl=
      "operation" data-title="getThingDescription()" data-dfn-for=
      "ConsumedThing" data-type="ThingDescription" data-lt=
      "getThingDescription()" data-local-lt=
      "ConsumedThing.getThingDescription|ConsumedThing.getThingDescription()|getThingDescription">
      <code>getThingDescription()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-getthingdescription-method"></a></h3>
      <p>Returns the <a data-link-type="dfn" href=
      "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
      internal slot</a> [[td]] of the <a data-link-type="idl" href=
      "#dom-consumedthing" class="internalDFN" id=
      "ref-for-dom-consumedthing-18"><code><code>ConsumedThing</code></code></a>
      object that represents the <a href="#dfn-thing-descriptions"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-thing-descriptions-19">Thing Description</a> of
      the <a data-link-type="idl" href="#dom-consumedthing" class=
      "internalDFN" id=
      "ref-for-dom-consumedthing-19"><code><code>ConsumedThing</code></code></a>.
      Applications may consult the <a href="#dfn-things" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-things-31">Thing</a> metadata stored in [[td]]
      in order to introspect its capabilities before interacting
      with it.</p>
    </section>
    <section id="the-readproperty-method">
      <h3 id="x7-4-the-readproperty-method"><bdi class=
      "secno">7.4</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-consumedthing-readproperty" data-idl=
      "operation" data-title="readProperty()" data-dfn-for=
      "ConsumedThing" data-type="Promise" data-lt=
      "readProperty()|readProperty(propertyName)|readProperty(propertyName, options)"
      data-local-lt=
      "ConsumedThing.readProperty|ConsumedThing.readProperty()|readProperty">
      <code>readProperty()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-readproperty-method"></a></h3>
      <div>
        Reads a <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-properties-13">Property</a> value. Takes as
        arguments <var data-type="string">propertyName</var> and
        optionally <var data-type=
        "InteractionOptions">options</var>. It returns a
        <a data-link-type="idl" href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
        that resolves with a <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-14">Property</a> value represented
        as an <a data-link-type="idl" href="#dom-interactionoutput"
        class="internalDFN" id=
        "ref-for-dom-interactionoutput-14"><code><code>InteractionOutput</code></code></a>
        object or rejects on error. The method <em class=
        "rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">propertyName</var>.</li>
          <li>If <var>option</var>'s <var>formIndex</var> is
          defined, let <var>form</var> be the <a href="#dfn-form"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-form-7">Form</a> associated with
          <var>formIndex</var> in <var>interaction</var>'s
          <var>forms</var> array, otherwise let <var>form</var> be
          a <a href="#dfn-form" class="internalDFN"
            data-link-type="dfn" id="ref-for-dfn-form-8">Form</a>
            in <var>interaction</var>'s <var>forms</var> whose
            <var>op</var> is <code>readproperty</code>, selected by
            the implementation.
          </li>
          <li>If <var>form</var> is failure, reject
            <var data-type="Promise">promise</var> with a
            <a data-link-type="idl" data-type="exception" href=
            "https://heycam.github.io/webidl/#syntaxerror"><code>SyntaxError</code></a>
            and abort these steps.
          </li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-7">Protocol Bindings</a>)
          to retrieve the value of the <a href="#dfn-properties"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-properties-15">Property</a> given by
          <var data-type="string">propertyName</var> using
          <var>form</var> and the optional URI templates given in
          <var data-type="InteractionOptions">options</var>' <var>
            uriVariables</var>.
          </li>
          <li>If the request fails, reject <var data-type=
          "Promise">promise</var> with the error received from the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-8">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Let <var>response</var> be the response received to
          the request.</li>
          <li>Let <var>data</var> be the result of running
            <a href="#dfn-parse-interaction-response" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-parse-interaction-response-2">parse
            interaction response</a> on <var>response</var>,
            <var>form</var> and <var>interaction</var>. If that
            fails, reject <var data-type="Promise">promise</var>
            with a <a data-link-type="idl" data-type="exception"
            href=
            "https://heycam.github.io/webidl/#syntaxerror"><code>SyntaxError</code></a>
            and abort these steps.
          </li>
          <li>Resolve <var data-type="Promise">promise</var> with
          <var>data</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-readmultipleproperties-method">
      <h3 id="x7-5-the-readmultipleproperties-method"><bdi class=
      "secno">7.5</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-consumedthing-readmultipleproperties"
      data-idl="operation" data-title="readMultipleProperties()"
      data-dfn-for="ConsumedThing" data-type="Promise" data-lt=
      "readMultipleProperties()|readMultipleProperties(propertyNames)|readMultipleProperties(propertyNames, options)"
      data-local-lt=
      "ConsumedThing.readMultipleProperties|ConsumedThing.readMultipleProperties()|readMultipleProperties">
      <code>readMultipleProperties()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-readmultipleproperties-method"></a></h3>
      <div>
        Reads multiple <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-16">Property</a> values with one
        request. Takes as arguments <var data-type=
        "string sequence">propertyNames</var> and optionally
        <var data-type="InteractionOptions">options</var>. It
        returns a <a data-link-type="idl" href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
        that resolves with a <a data-link-type="idl" href=
        "#dom-propertymap" class="internalDFN" id=
        "ref-for-dom-propertymap-5"><code><code>PropertyMap</code></code></a>
        object that maps keys from <var data-type=
        "string sequence">propertyNames</var> to values returned by
        this algorithm. The method <em class="rfc2119">MUST</em>
        run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>If <var>option</var>'s <var>formIndex</var> is
          defined, let <var>form</var> be the <a href="#dfn-form"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-form-9">Form</a> associated with
          <var>formIndex</var> in [[td]]'s <var>forms</var> array,
          otherwise let <var>form</var> be a <a href="#dfn-form"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-form-10">Form</a> in [[td]]'s
          <var>forms</var> array whose <var>op</var> is
          <code>readmultipleproperties</code>, selected by the
          implementation.
          </li>
          <li>If <var>form</var> is failure, reject
            <var data-type="Promise">promise</var> with a
            <a data-link-type="idl" data-type="exception" href=
            "https://heycam.github.io/webidl/#syntaxerror"><code>SyntaxError</code></a>
            and abort these steps.
          </li>
          <li>Let <var data-type="object">result</var> be an object
          and for each string <var data-type="string">name</var> in
          <var data-type="string sequence">propertyNames</var> add
          a property with key <var data-type="string">name</var>
          and the value <code>null</code>.</li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-9">Protocol Bindings</a>)
          to retrieve the <a href="#dfn-properties" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-properties-17">Property</a> values given by
          <var data-type="string sequence">propertyNames</var> with
          <var>form</var> and optional URI templates given in
          <var data-type="InteractionOptions">options</var>' <var>
            uriVariables</var>.
          </li>
          <li>If this cannot be done with a single request with the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-10">Protocol Bindings</a>,
          reject <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> and abort these steps.
          </li>
          <li>Process the response and for each <var>key</var> in
          <var data-type="object">result</var>, run the following
          sub-steps:
            <ol>
              <li>Let <var>value</var> be the value of
              <var data-type="object">result</var>'s
              <var>key</var>.</li>
              <li>Let <var>schema</var> be the value of [[td]]'s
              <var>properties</var>'s <var>key</var>.</li>
              <li>Let <var>property</var> be the result of running
              <a href="#dfn-parse-interaction-response" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-parse-interaction-response-3">parse
              interaction response</a> on <var>value</var>,
              <var>form</var> and <var>schema</var>.
              </li>
            </ol>
          </li>
          <li>If the above step throws at any point, reject
          <var data-type="Promise">promise</var> with that
          exception and abort these steps.</li>
          <li>Resolve <var data-type="Promise">promise</var> with
          <var data-type="object">result</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-readallproperties-method">
      <h3 id="x7-6-the-readallproperties-method"><bdi class=
      "secno">7.6</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-consumedthing-readallproperties" data-idl=
      "operation" data-title="readAllProperties()" data-dfn-for=
      "ConsumedThing" data-type="Promise" data-lt=
      "readAllProperties()|readAllProperties(, options)"
      data-local-lt=
      "ConsumedThing.readAllProperties|ConsumedThing.readAllProperties()|readAllProperties">
      <code>readAllProperties()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-readallproperties-method"></a></h3>
      <div>
        Reads all properties of the <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-things-32">Thing</a> with one request. Takes
        <var data-type="InteractionOptions">options</var> as
        optional argument. It returns a <a data-link-type="idl"
        href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
        that resolves with a <a data-link-type="idl" href=
        "#dom-propertymap" class="internalDFN" id=
        "ref-for-dom-propertymap-6"><code><code>PropertyMap</code></code></a>
        object that maps keys from <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-18">Property</a> names to values
        returned by this algorithm. The method <em class=
        "rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>If <var>option</var>'s <var>formIndex</var> is
          defined, let <var>form</var> be the <a href="#dfn-form"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-form-11">Form</a> associated with
          <var>formIndex</var> in [[td]]'s <var>forms</var> array,
          otherwise let <var>form</var> be a <a href="#dfn-form"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-form-12">Form</a> in [[td]]'s
          <var>forms</var> array whose <var>op</var> is
          <code>readallproperties</code>, selected by the
          implementation.
          </li>
          <li>If <var>form</var> is failure, reject
            <var data-type="Promise">promise</var> with a
            <a data-link-type="idl" data-type="exception" href=
            "https://heycam.github.io/webidl/#syntaxerror"><code>SyntaxError</code></a>
            and abort these steps.
          </li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-11">Protocol Bindings</a>)
          to retrieve the value of the all the <a href=
          "#dfn-properties" class="internalDFN" data-link-type=
          "dfn" id="ref-for-dfn-properties-19">Property</a>
          definitions from the <a href="#dfn-td-0" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-td-0-10">TD</a> with <var>form</var> and
          optional URI templates given in <var data-type=
          "InteractionOptions">options</var>'
          <var>uriVariables</var>.
          </li>
          <li>If this cannot be done with a single request with the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-12">Protocol Bindings</a>
          of the <a href="#dfn-things" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-things-33">Thing</a>, then reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> and abort these steps.
          </li>
          <li>If the request fails, reject <var data-type=
          "Promise">promise</var> with the error received from the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-13">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Process the reply and let <var data-type=
          "object">result</var> be an object with the keys and
          values obtained in the reply.</li>
          <li>Process the response and for each <var>key</var> in
          <var data-type="object">result</var>, run the following
          sub-steps:
            <ol>
              <li>Let <var>value</var> be the value of
              <var data-type="object">result</var>'s
              <var>key</var>.</li>
              <li>Let <var>schema</var> be the value of [[td]]'s
              <var>properties</var>'s <var>key</var>.</li>
              <li>Let <var>property</var> be the result of running
              <a href="#dfn-parse-interaction-response" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-parse-interaction-response-4">parse
              interaction response</a> on <var>value</var>,
              <var>form</var> and <var>schema</var>.
              </li>
            </ol>
          </li>
          <li>Resolve <var data-type="Promise">promise</var> with
          <var data-type="object">result</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-writeproperty-method">
      <h3 id="x7-7-the-writeproperty-method"><bdi class=
      "secno">7.7</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-consumedthing-writeproperty" data-idl=
      "operation" data-title="writeProperty()" data-dfn-for=
      "ConsumedThing" data-type="Promise" data-lt=
      "writeProperty()|writeProperty(propertyName, value)|writeProperty(propertyName, value, options)"
      data-local-lt=
      "ConsumedThing.writeProperty|ConsumedThing.writeProperty()|writeProperty">
      <code>writeProperty()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-writeproperty-method"></a></h3>
      <div>
        Writes a single <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-20">Property</a>. Takes as
        arguments <var data-type="string">propertyName</var>,
        <var data-type="InteractionInput">value</var> and
        optionally <var data-type=
        "InteractionOptions">options</var>. It returns a
        <a data-link-type="idl" href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
        that resolves on success and rejects on failure. The method
        <em class="rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">propertyName</var>.</li>
          <li>If <var>option</var>'s <var>formIndex</var> is
          defined, let <var>form</var> be the <a href="#dfn-form"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-form-13">Form</a> associated with
          <var>formIndex</var> in <var>interaction</var>'s
          <var>forms</var> array, otherwise let <var>form</var> be
          a <a href="#dfn-form" class="internalDFN"
            data-link-type="dfn" id="ref-for-dfn-form-14">Form</a>
            in <var>interaction</var>'s <var>forms</var> whose
            <var>op</var> is <code>writeproperty</code>, selected
            by the implementation.
          </li>
          <li>If <var>form</var> is failure, reject
            <var data-type="Promise">promise</var> with a
            <a data-link-type="idl" data-type="exception" href=
            "https://heycam.github.io/webidl/#syntaxerror"><code>SyntaxError</code></a>
            and abort these steps.
          </li>
          <li>Let <var>data</var> be the result of running the
          <a href="#dfn-create-interaction-request" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-create-interaction-request-4">create
          interaction request</a> steps on <var data-type=
          "InteractionInput">value</var>, <var>form</var> and <var>
            interaction</var>. If that throws, reject
            <a data-link-type="dfn" href=
            "https://tc39.es/ecma262/#sec-promise-objects">promise</a>
            with that exception and abort these steps.
          </li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-14">Protocol Bindings</a>)
          to write the <a href="#dfn-properties" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-properties-21">Property</a> given by
          <var data-type="string">propertyName</var> using
          <var data-type="InteractionOutput">data</var> and the
          optional URI templates given in <var data-type=
          "InteractionOptions">options</var>'
          <var>uriVariables</var>.
          </li>
          <li>If the request fails, reject <var data-type=
          "Promise">promise</var> with the error received from the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-15">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Otherwise resolve <var data-type=
          "Promise">promise</var>.</li>
        </ol>
      </div>
      <div class="note" id="issue-container-generatedID-9">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-7" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">As discussed in <a href=
        "https://github.com/w3c/wot-scripting-api/issues/193">Issue
        #193</a>, the design decision is that write interactions
        only return success or error, not the written value
        (optionally). <a href="#dfn-td-0" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-td-0-11">TD</a>s
        should capture the schema of the <a href="#dfn-properties"
        class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-22">Property</a> values, including
        precision and alternative formats. When a return value is
        expected from the interaction, an <a href="#dfn-actions"
        class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-actions-12">Action</a> should be used instead
        of a <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-properties-23">Property</a>.</p>
      </div>
    </section>
    <section id="the-writemultipleproperties-method">
      <h3 id="x7-8-the-writemultipleproperties-method"><bdi class=
      "secno">7.8</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-consumedthing-writemultipleproperties"
      data-idl="operation" data-title="writeMultipleProperties()"
      data-dfn-for="ConsumedThing" data-type="Promise" data-lt=
      "writeMultipleProperties()|writeMultipleProperties(valueMap)|writeMultipleProperties(valueMap, options)"
      data-local-lt=
      "ConsumedThing.writeMultipleProperties|ConsumedThing.writeMultipleProperties()|writeMultipleProperties">
      <code>writeMultipleProperties()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-writemultipleproperties-method"></a></h3>
      <div>
        Writes a multiple <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-24">Property</a> values with one
        request. Takes as arguments <var data-type=
        "object">properties</var> - as an object with keys being
        <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-properties-25">Property</a> names and values
        as <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-properties-26">Property</a> values - and
        optionally <var data-type=
        "InteractionOptions">options</var>. It returns a
        <a data-link-type="idl" href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
        that resolves on success and rejects on failure. The method
        <em class="rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>If <var>option</var>'s <var>formIndex</var> is
          defined, let <var>form</var> be the <a href="#dfn-form"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-form-15">Form</a> associated with
          <var>formIndex</var> in [[td]]'s <var>forms</var> array,
          otherwise let <var>form</var> be a <a href="#dfn-form"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-form-16">Form</a> in [[td]]'s
          <var>forms</var> array whose <var>op</var> is
          <code>writemultipleproperties</code>, selected by the
          implementation.
          </li>
          <li>If <var>form</var> is failure, reject
            <var data-type="Promise">promise</var> with a
            <a data-link-type="idl" data-type="exception" href=
            "https://heycam.github.io/webidl/#syntaxerror"><code>SyntaxError</code></a>
            and abort these steps.
          </li>
          <li>Let <var>propertyNames</var> be an array of
          <var>string</var> with as elements the keys of the
          <var data-type="object">properties</var> object.</li>
          <li>For each <var data-type="string">name</var> in <var>
            propertyNames</var>, let <var>property</var> be the
            value of [[td]]'s <var data-type=
            "object">properties</var>'s <var data-type=
            "string">name</var>. If <var>property</var> is
            <code>null</code> or <code>undefined</code> or is not
            <code>writeable</code> reject <var data-type=
            "Promise">promise</var> with <a data-link-type="idl"
            data-type="exception" href=
            "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> and abort these steps.
          </li>
          <li>Let <var data-type="object">result</var> be an object
          and for each string <var data-type="string">name</var> in
          <var>propertyNames</var> add a property with key
          <var data-type="string">name</var> and let its value be
          <code>null</code>.</li>
          <li>Let <var data-type="object">schemas</var> be an
          object and for each string <var data-type=
          "string">name</var> in <var>propertyNames</var> add a
          property with key <var data-type="string">name</var> and
          let its value be the value of [[td]]'s <var data-type=
          "object">properties</var>'s <var data-type=
          "string">name</var>.</li>
          <li>For each key <var data-type="string">key</var> in
          <var data-type="object">properties</var>, take its value
          as <var>value</var> and run the <a href=
          "#dfn-create-interaction-request" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-create-interaction-request-5">create
          interaction request</a> steps on <var>value</var>, <var>
            form</var> and the value for <var>schema</var>'s
            <var data-type="string">key</var>. If that throws for
            any <var data-type="string">name</var>, reject
            <a data-link-type="dfn" href=
            "https://tc39.es/ecma262/#sec-promise-objects">promise</a>
            with that exception and abort these steps.
          </li>
          <li>Make a single request to the underlying platform (via
          the <a href="#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-16">Protocol
            Bindings</a>) to write each <a href="#dfn-properties"
            class="internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-properties-27">Property</a> provided in
            <var data-type="object">properties</var> with optional
            URI templates given in <var data-type=
            "InteractionOptions">options</var>'
            <var>uriVariables</var>.
          </li>
          <li>If this cannot be done with a single request with the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-17">Protocol Bindings</a>
          of the <a href="#dfn-things" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-things-34">Thing</a>, then reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> and abort these steps.
          </li>
          <li>If the request fails, return the error received from
          the <a href="#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-18">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>Otherwise resolve <var data-type=
          "Promise">promise</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-observeproperty-method">
      <h3 id="x7-9-the-observeproperty-method"><bdi class=
      "secno">7.9</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-consumedthing-observeproperty" data-idl=
      "operation" data-title="observeProperty()" data-dfn-for=
      "ConsumedThing" data-type="Promise" data-lt=
      "observeProperty()|observeProperty(name, listener)|observeProperty(name, listener, onerror)|observeProperty(name, listener, onerror, options)"
      data-local-lt=
      "ConsumedThing.observeProperty|ConsumedThing.observeProperty()|observeProperty">
      <code>observeProperty()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-observeproperty-method"></a></h3>
      <div>
        Makes a request for <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-28">Property</a> value change
        notifications. Takes as arguments <var data-type=
        "string">propertyName</var>, <var data-type=
        "InteractionListener">listener</var> and optionally
        <var data-type="ErrorListener">onerror</var> and
        <var data-type="InteractionOptions">options</var>. It
        returns a <a data-link-type="idl" href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
        that resolves on success and rejects on failure. The method
        <em class="rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>If <var data-type=
          "InteractionListener">listener</var> is not a
          <a data-link-type="idl" data-type="callback" href=
          "https://heycam.github.io/webidl/#Function"><code>Function</code></a>,
          reject <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#exceptiondef-typeerror">
            <code>TypeError</code></a> and abort these steps.
          </li>
          <li>If <var data-type="ErrorListener">onerror</var> is
          not <code>null</code> and is not a <a data-link-type=
          "idl" data-type="callback" href=
          "https://heycam.github.io/webidl/#Function"><code>Function</code></a>,
          reject <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#exceptiondef-typeerror">
            <code>TypeError</code></a> and abort these steps.
          </li>
          <li>Let <var>subscription</var> be a new
          <a data-link-type="idl" href="#dom-subscription" class=
          "internalDFN" id=
          "ref-for-dom-subscription-4"><code><code>Subscription</code></code></a>
          object with its <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slots</a> set as follows:
            <ul>
              <li>Let <var>subscription</var>'s [[type]] be
              <code>"property"</code>.</li>
              <li>Let <var>subscription</var>'s [[name]] be the
              value of <var data-type=
              "string">propertyName</var>.</li>
              <li>Let <var>subscription</var>'s [[interaction]] be
              the value of [[td]]'s <var>properties</var>'s
              <var data-type="string">propertyName</var>.</li>
              <li>Let <var>subscription</var>'s [[form]] be the
              <a href="#dfn-form" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-form-17">Form</a> associated with <var>
                formIndex</var> in [[interaction]]'s
                <var>forms</var> array if <var>option</var>'s
                <var>formIndex</var> is defined, otherwise let
                [[form]] be a <a href="#dfn-form" class=
                "internalDFN" data-link-type="dfn" id=
                "ref-for-dfn-form-18">Form</a> in [[interaction]]'s
                <var>forms</var> array whose <var>op</var> is
                <code>"observeproperty"</code>, selected by the
                implementation.
              </li>
              <li>If <var>subscription</var>'s [[form]] is failure,
              reject <var data-type="Promise">promise</var> with a
              <a data-link-type="idl" data-type="exception" href=
              "https://heycam.github.io/webidl/#syntaxerror"><code>
                SyntaxError</code></a> and abort these steps.
              </li>
            </ul>
          </li>
          <li>Make a request to the underlying platform to observe
          the <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-properties-29">Property</a> identified by
          <var data-type="string">propertyName</var> with
          <var>form</var> and optional URI templates given in
          <var data-type="InteractionOptions">options</var>' <var>
            uriVariables</var>.
          </li>
          <li>If the request fails, reject <var data-type=
          "Promise">promise</var> with the error received from the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-19">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Otherwise resolve <var data-type=
          "Promise">promise</var>.</li>
          <li>Whenever the underlying platform detects a
          notification for this subscription with a new <a href=
          "#dfn-properties" class="internalDFN" data-link-type=
          "dfn" id="ref-for-dfn-properties-30">Property</a> value
          <var>value</var>, run the following sub-steps:
            <ul>
              <li>Let <var>reply</var> be the result of running
              <a href="#dfn-parse-interaction-response" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-parse-interaction-response-5">parse
              interaction response</a> with <var>value</var>,
              [[form]] and [[interaction]]. If that throws, reject
              <var data-type="Promise">promise</var> with that
              exception and abort these steps.
              </li>
              <li>Invoke <var data-type=
              "InteractionListener">listener</var> with
              <var>reply</var>.</li>
            </ul>
          </li>
          <li>Whenever the underlying platform detects an error for
          this subscription, run the following sub-steps:
            <ul>
              <li>If the error is irrecoverable and stops the
              subscription, set <var>subscription</var>'s
              <var>active</var> to <code>false</code> and suppress
              further notifications.</li>
              <li>Let <var>error</var> be a new
                <a data-link-type="idl" data-type="exception" href=
                "https://heycam.github.io/webidl/#networkerror"><code>
                NetworkError</code></a> and set its
                <var>message</var> to reflect the underlying error
                condition.
              </li>
              <li>If <var data-type="ErrorListener">onerror</var>
              is a <a data-link-type="idl" data-type="callback"
              href=
              "https://heycam.github.io/webidl/#Function"><code>Function</code></a>,
              invoke it with <var>error</var>.
              </li>
            </ul>
          </li>
        </ol>
      </div>
    </section>
    <section id="the-invokeaction-method">
      <h3 id="x7-10-the-invokeaction-method"><bdi class=
      "secno">7.10</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-consumedthing-invokeaction" data-idl=
      "operation" data-title="invokeAction()" data-dfn-for=
      "ConsumedThing" data-type="Promise" data-lt=
      "invokeAction()|invokeAction(actionName)|invokeAction(actionName, params)|invokeAction(actionName, params, options)"
      data-local-lt=
      "ConsumedThing.invokeAction|ConsumedThing.invokeAction()|invokeAction">
      <code>invokeAction()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-invokeaction-method"></a></h3>
      <div>
        Makes a request for invoking an <a href="#dfn-actions"
        class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-actions-13">Action</a> and return the result.
        Takes as arguments <var data-type=
        "string">actionName</var>, optionally <var data-type=
        "InteractionInput">params</var> and optionally
        <var data-type="InteractionOptions">options</var>. It
        returns a <a data-link-type="idl" href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
        that resolves with the result of the <a href="#dfn-actions"
        class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-actions-14">Action</a> represented as an
        <a data-link-type="idl" href="#dom-interactionoutput"
        class="internalDFN" id=
        "ref-for-dom-interactionoutput-15"><code><code>InteractionOutput</code></code></a>
        object, or rejects with an error. The method <em class=
        "rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>actions</var>'s <var data-type=
          "string">actionName</var>.</li>
          <li>If <var>option</var>'s <var>formIndex</var> is
          defined, let <var>form</var> be the <a href="#dfn-form"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-form-19">Form</a> associated with
          <var>formIndex</var> in <var>interaction</var>'s
          <var>forms</var> array, otherwise let <var>form</var> be
          a <a href="#dfn-form" class="internalDFN"
            data-link-type="dfn" id="ref-for-dfn-form-20">Form</a>
            in <var>interaction</var>'s <var>forms</var> array
            whose <var>op</var> is <code>invokeaction</code>,
            selected by the implementation.
          </li>
          <li>If <var>form</var> is failure, reject
            <var data-type="Promise">promise</var> with a
            <a data-link-type="idl" data-type="exception" href=
            "https://heycam.github.io/webidl/#syntaxerror"><code>SyntaxError</code></a>
            and abort these steps.
          </li>
          <li>Let <var>args</var> be the result of running the
          <a href="#dfn-create-interaction-request" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-create-interaction-request-6">create
          interaction request</a> steps on <var data-type=
          "InteractionInput">params</var>, <var>form</var> and
          <var>interaction</var>. If that throws, reject
          <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-promise-objects">promise</a>
          with that exception and abort these steps.
          </li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-20">Protocol Bindings</a>)
          to invoke the <a href="#dfn-actions" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-actions-15">Action</a> identified by
            <var data-type="string">actionName</var> with
            parameters provided in <var>args</var> and optional URI
            templates given in <var data-type=
            "InteractionOptions">options</var>'s
            <var>uriVariables</var>.
          </li>
          <li>If the request fails locally or returns an error over
          the network, reject <var data-type=
          "Promise">promise</var> with the error received from the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-21">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Let <var>value</var> be the reply returned in the
          reply.</li>
          <li>Let <var>result</var> be the result of running
          <a href="#dfn-parse-interaction-response" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-parse-interaction-response-6">parse
          interaction response</a> with <var>value</var>,
          <var>form</var> and <var>interaction</var>. If that
          throws, reject <var data-type="Promise">promise</var>
          with that exception and abort these steps.
          </li>
          <li>Resolve <var data-type="Promise">promise</var> with
          <var>result</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-subscribeevent-method">
      <h3 id="x7-11-the-subscribeevent-method"><bdi class=
      "secno">7.11</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-consumedthing-subscribeevent" data-idl=
      "operation" data-title="subscribeEvent()" data-dfn-for=
      "ConsumedThing" data-type="Promise" data-lt=
      "subscribeEvent()|subscribeEvent(name, listener)|subscribeEvent(name, listener, onerror)|subscribeEvent(name, listener, onerror, options)"
      data-local-lt=
      "ConsumedThing.subscribeEvent|ConsumedThing.subscribeEvent()|subscribeEvent">
      <code>subscribeEvent()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-subscribeevent-method"></a></h3>
      <div>
        Makes a request for subscribing to <a href="#dfn-events"
        class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-events-10">Event</a> notifications. Takes as
        arguments <var data-type="string">eventName</var>,
        <var data-type="WoTListener">listener</var> and optionally
        <var data-type="ErrorListener">onerror</var> and
        <var data-type="InteractionOptions">options</var>. It
        returns a <a data-link-type="idl" href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
        to signal success or failure. The method <em class=
        "rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>If <var data-type="WoTListener">listener</var> is not
          a <a data-link-type="idl" data-type="callback" href=
          "https://heycam.github.io/webidl/#Function"><code>Function</code></a>,
          reject <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#exceptiondef-typeerror">
            <code>TypeError</code></a> and abort these steps.
          </li>
          <li>If <var data-type="ErrorListener">onerror</var> is
          not <code>null</code> and is not a <a data-link-type=
          "idl" data-type="callback" href=
          "https://heycam.github.io/webidl/#Function"><code>Function</code></a>,
          reject <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#exceptiondef-typeerror">
            <code>TypeError</code></a> and abort these steps.
          </li>
          <li>Let <var>subscription</var> be a new
          <a data-link-type="idl" href="#dom-subscription" class=
          "internalDFN" id=
          "ref-for-dom-subscription-5"><code><code>Subscription</code></code></a>
          object with its <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slots</a> set as follows:
            <ul>
              <li>Let <var>subscription</var>'s [[type]] be
              <code>"event"</code>.</li>
              <li>Let <var>subscription</var>'s [[name]] be the
              value of <var data-type=
              "string">eventName</var>.</li>
              <li>Let <var>subscription</var>'s [[interaction]] be
              the value of [[td]]'s <var>events</var>'s
              <var data-type="string">eventName</var>.</li>
              <li>Let <var>subscription</var>'s [[form]] be the
              <a href="#dfn-form" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-form-21">Form</a> associated with <var>
                formIndex</var> in [[interaction]]'s
                <var>forms</var> array if <var>option</var>'s
                <var>formIndex</var> is defined, otherwise let
                [[form]] be a <a href="#dfn-form" class=
                "internalDFN" data-link-type="dfn" id=
                "ref-for-dfn-form-22">Form</a> in [[interaction]]'s
                <var>forms</var> array whose <var>op</var> is
                <code>"subscribeevent"</code>, selected by the
                implementation.
              </li>
              <li>If <var>subscription</var>'s [[form]] is failure,
              reject <var data-type="Promise">promise</var> with a
              <a data-link-type="idl" data-type="exception" href=
              "https://heycam.github.io/webidl/#syntaxerror"><code>
                SyntaxError</code></a> and abort these steps.
              </li>
            </ul>
          </li>
          <li>Make a request to the underlying platform via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-22">Protocol Bindings</a>
          to subscribe to an <a href="#dfn-events" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-events-11">Event</a> identified by
          <var data-type="string">eventName</var> with [[form]],
          optional URI templates given in <var data-type=
          "InteractionOptions">options</var>'
          <var>uriVariables</var> and optional subscription data
          given in <var data-type=
          "InteractionOptions">options</var>'s <var>data</var>.
          </li>
          <li>If the request fails, reject <var data-type=
          "Promise">promise</var> with the error received from the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-23">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Otherwise resolve <var data-type=
          "Promise">promise</var>.</li>
          <li>Whenever the underlying platform detects a
          notification for this <a href="#dfn-events" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-events-12">Event</a> subscription, run the
          following sub-steps:
            <ol>
              <li>Invoke <var data-type=
              "WoTListener">listener</var> with the result of
              running <a href="#dfn-parse-interaction-response"
              class="internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-parse-interaction-response-7">parse
              interaction response</a> on the data provided with
              the <a href="#dfn-events" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-events-13">Event</a>, [[form]] and
              [[interaction]].
              </li>
            </ol>
          </li>
          <li>Whenever the underlying platform detects an error for
          this subscription, run the following sub-steps:
            <ul>
              <li>If the error is irrecoverable and stops the
              subscription, set <var>subscription</var>'s
              <var>active</var> to <code>false</code> and suppress
              further notifications.</li>
              <li>Let <var>error</var> be a new
                <a data-link-type="idl" data-type="exception" href=
                "https://heycam.github.io/webidl/#networkerror"><code>
                NetworkError</code></a> and set its
                <var>message</var> to reflect the underlying error
                condition.
              </li>
              <li>If <var data-type="ErrorListener">onerror</var>
              is a <a data-link-type="idl" data-type="callback"
              href=
              "https://heycam.github.io/webidl/#Function"><code>Function</code></a>,
              invoke it with <var>error</var>.
              </li>
            </ul>
          </li>
        </ol>
      </div>
    </section>
    <section data-dfn-for="InteractionOptions" id=
    "the-interactionoptions-dictionary">
      <h3 id="x7-12-the-interactionoptions-dictionary"><bdi class=
      "secno">7.12</bdi> The <dfn data-export="" data-dfn-type=
      "dictionary" id="dom-interactionoptions" data-idl=
      "dictionary" data-title="InteractionOptions" data-dfn-for=
      ""><code>InteractionOptions</code></dfn> dictionary <a class=
      "self-link" aria-label="§" href=
      "#the-interactionoptions-dictionary"></a></h3>
      <p>Holds the interaction options that need to be exposed for
      application scripts according to the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-thing-descriptions-20">Thing
      Description</a>.</p>
      <p>The <dfn data-export="" data-dfn-type="dict-member" id=
      "dom-interactionoptions-formindex" data-idl="field"
      data-title="formIndex" data-dfn-for="InteractionOptions"
      data-type="unsigned long"><code>formIndex</code></dfn>
      property, if defined, represents an application hint for
      which <code>Form</code> definition, identified by this index,
      of the <a href="#dfn-td-0" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-td-0-12">TD</a> to use
      for the given WoT interaction. Implementations <em class=
      "rfc2119">SHOULD</em> use the <code>Form</code> with this
      index for making the interaction, but <em class=
      "rfc2119">MAY</em> override this value if the index is not
      found or not valid. If not defined, implementations
      <em class="rfc2119">SHOULD</em> attempt to use the
      <code>Form</code> definitions in order of appearance as
      listed in the <a href="#dfn-td-0" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-td-0-13">TD</a> for the
      given Wot Interaction.</p>
      <p>The <dfn data-export="" data-dfn-type="dict-member" id=
      "dom-interactionoptions-urivariables" data-idl="field"
      data-title="uriVariables" data-dfn-for="InteractionOptions"
      data-type="object"><code>uriVariables</code></dfn> property
      if defined, represents the URI template variables to be used
      with the WoT Interaction that are represented as <a href=
      "https://infra.spec.whatwg.org/#parse-json-from-bytes">parsed
      JSON objects</a> defined in [<cite><a class="bibref"
      data-link-type="biblio" href="#bib-wot-td" title=
      "Web of Things Thing Description">WOT-TD</a></cite>].</p>
      <div class="note" id="issue-container-generatedID-10">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-8" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">The support for URI variables comes from the
        need, exposed by the <cite><a href=
        "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
        Web of Things Thing Description</a></cite> specification,
        to be able to describe existing REST-ful endpoints that use
        them. However, it should be possible to write a Thing
        Description that would use <a href="#dfn-actions" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-actions-16">Action</a>s for representing this
        kind of interactions and model the URI variables as action
        parameters. In that case, implementations can serialize the
        parameters as URI variables, and therefore, the
        <var>options</var> parameter could be dismissed.</p>
      </div>
      <p>The <dfn data-export="" data-dfn-type="dict-member" id=
      "dom-interactionoptions-data" data-idl="field" data-title=
      "data" data-dfn-for="InteractionOptions" data-type=
      "any"><code>data</code></dfn> property if defined, represents
      additional opaque data that needs to be passed to the
      interaction.</p>
    </section>
    <section id="the-propertymap-type">
      <h3 id="x7-13-the-propertymap-type"><bdi class=
      "secno">7.13</bdi> The <dfn data-export="" data-dfn-type=
      "typedef" id="dom-propertymap" data-idl="typedef" data-title=
      "PropertyMap" data-dfn-for=""><code>PropertyMap</code></dfn>
      type<a class="self-link" aria-label="§" href=
      "#the-propertymap-type"></a></h3>
      <p>Represents a map of <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-31">Property</a> names as strings to
      a value that the <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-32">Property</a> can take. It is used
      as a property bag for interactions that involve multiple
      <a href="#dfn-properties" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-properties-33">Properties</a> at
      once.</p>
      <div class="note" id="issue-container-generatedID-11">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-9" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">It could be defined in Web IDL (as well as
        <a data-link-type="idl" href="#dom-thingdescription" class=
        "internalDFN" id=
        "ref-for-dom-thingdescription-9"><code><code>ThingDescription</code></code></a>)
        as a <a href=
        "https://heycam.github.io/webidl/#idl-maplike">maplike</a>
        interface from <i>string</i> to <i>any</i>.</p>
      </div>
    </section>
    <section id="the-interactionlistener-callback">
      <h3 id="x7-14-the-interactionlistener-callback"><bdi class=
      "secno">7.14</bdi> The <dfn data-export="" data-dfn-type=
      "callback" id="dom-interactionlistener" data-idl="callback"
      data-title="InteractionListener" data-dfn-for=
      ""><code>InteractionListener</code></dfn> callback<a class=
      "self-link" aria-label="§" href=
      "#the-interactionlistener-callback"></a></h3>
      <p>User provided callback that is given an argument of type
      <a data-link-type="idl" href="#dom-interactionoutput" class=
      "internalDFN" id=
      "ref-for-dom-interactionoutput-16"><code><code>InteractionOutput</code></code></a>
      and is used for observing <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-34">Property</a> changes and handling
      <a href="#dfn-events" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-events-14">Event</a> notifications.
      Since subscribing to <a href="#dfn-events" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-15">Events</a> are WoT interactions and
      might take options or even data, they are not modelled with
      software events.</p>
    </section>
    <section id="the-errorlistener-callback">
      <h3 id="x7-15-the-errorlistener-callback"><bdi class=
      "secno">7.15</bdi> The <dfn data-export="" data-dfn-type=
      "callback" id="dom-errorlistener" data-idl="callback"
      data-title="ErrorListener" data-dfn-for=
      ""><code>ErrorListener</code></dfn> callback<a class=
      "self-link" aria-label="§" href=
      "#the-errorlistener-callback"></a></h3>
      <p>User provided callback that is given an argument of type
      <a data-link-type="idl" href=
      "https://tc39.es/ecma262/#sec-error-objects"><code>Error</code></a>
      and is used for conveying critical and non-critical errors
      from the <a href="#dfn-protocol-bindings" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-protocol-bindings-24">Protocol Bindings</a> to
      applications.</p>
    </section>
    <section data-dfn-for="Subscription" id=
    "the-subscription-interface">
      <h3 id="x7-16-the-subscription-interface"><bdi class=
      "secno">7.16</bdi> The <dfn data-export="" data-dfn-type=
      "interface" id="dom-subscription" data-idl="interface"
      data-title="Subscription" data-dfn-for=
      ""><code>Subscription</code></dfn> interface<a class=
      "self-link" aria-label="§" href=
      "#the-subscription-interface"></a></h3>
      <p>Represents a subscription to <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-35">Property</a> change and <a href=
      "#dfn-events" class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-16">Event</a> interactions.</p>
      <p>The <dfn data-export="" data-dfn-type="attribute" id=
      "dom-subscription-active" data-idl="attribute" data-title=
      "active" data-dfn-for="Subscription" data-type="boolean"
      data-lt="active" data-local-lt=
      "Subscription.active"><code>active</code></dfn> boolean
      property denotes if the subscription is active, i.e. it is
      not stopped because of an error or because of invocation of
      the <code>stop()</code> method.</p>
      <section id="internal-slots-for-subscription">
        <h4 id="x7-16-1-internal-slots-for-subscription">
        <bdi class="secno">7.16.1</bdi> Internal slots for
        <a data-link-type="idl" href="#dom-subscription" class=
        "internalDFN" id=
        "ref-for-dom-subscription-6"><code><code>Subscription</code></code></a><a class="self-link"
        aria-label="§" href=
        "#internal-slots-for-subscription"></a></h4>A
        <a data-link-type="idl" href="#dom-subscription" class=
        "internalDFN" id=
        "ref-for-dom-subscription-7"><code><code>Subscription</code></code></a>
        object has the following <a data-link-type="dfn" href=
        "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
        internal slots</a>:
        <table class="simple">
          <thead>
            <tr>
              <th>Internal Slot</th>
              <th>Initial value</th>
              <th>Description (<em>non-normative</em>)</th>
            </tr>
          </thead>
          <tbody data-link-for="Subscription">
            <tr>
              <td><dfn data-dfn-type="idl" id=
              "dfn-type">[[type]]</dfn></td>
              <td><code>null</code></td>
              <td>
                Indicates what <a href="#dfn-wot-interaction"
                class="internalDFN" data-link-type="dfn" id=
                "ref-for-dfn-wot-interaction-16">WoT
                Interaction</a> the <a data-link-type="idl" href=
                "#dom-subscription" class="internalDFN" id=
                "ref-for-dom-subscription-8"><code><code>Subscription</code></code></a>
                refers to. The value can be either
                <code>"property"</code> or <code>"event"</code> or
                <code>null</code>.
              </td>
            </tr>
            <tr>
              <td><dfn data-dfn-type="idl" id=
              "dfn-name">[[name]]</dfn></td>
              <td><code>null</code></td>
              <td>
                The <a href="#dfn-properties" class="internalDFN"
                data-link-type="dfn" id=
                "ref-for-dfn-properties-36">Property</a> or
                <a href="#dfn-events" class="internalDFN"
                data-link-type="dfn" id=
                "ref-for-dfn-events-17">Event</a> name.
              </td>
            </tr>
            <tr>
              <td><dfn data-dfn-type="idl" id=
              "dfn-interaction">[[interaction]]</dfn></td>
              <td><code>null</code></td>
              <td>
                The <a href="#dfn-thing-descriptions" class=
                "internalDFN" data-link-type="dfn" id=
                "ref-for-dfn-thing-descriptions-21">Thing
                Description</a> fragment that describes the
                <a href="#dfn-wot-interaction" class="internalDFN"
                data-link-type="dfn" id=
                "ref-for-dfn-wot-interaction-17">WoT
                interaction</a>.
              </td>
            </tr>
            <tr>
              <td><dfn data-dfn-type="idl" id=
              "dfn-form-0">[[form]]</dfn></td>
              <td><code>null</code></td>
              <td>
                The <a href="#dfn-form" class="internalDFN"
                data-link-type="dfn" id=
                "ref-for-dfn-form-23">Form</a> associated with the
                subscription.
              </td>
            </tr>
          </tbody>
        </table>
      </section>
      <section id="the-stop-method">
        <h4 id="x7-16-2-the-stop-method"><bdi class=
        "secno">7.16.2</bdi> The <dfn data-export="" data-dfn-type=
        "method" id="dom-subscription-stop" data-idl="operation"
        data-title="stop()" data-dfn-for="Subscription" data-type=
        "Promise" data-lt="stop()|stop(, options)" data-local-lt=
        "Subscription.stop|Subscription.stop()|stop"><code>stop()</code></dfn>
        method<a class="self-link" aria-label="§" href=
        "#the-stop-method"></a></h4>
        <p>Stops delivering notifications for the subscription. It
        takes an optional parameter <var data-type=
        "InteractionOptions">options</var> and returns a
        <a data-link-type="idl" href=
        "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>.
        When invoked, the method <em class="rfc2119">MUST</em>
        execute the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>If <var data-type="InteractionOptions">options</var>'
          <var>formIndex</var> is defined, let
          <var>unsubscribeForm</var> be the <a href="#dfn-form"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-form-24">Form</a> associated with
          <var>formIndex</var> in [[interaction]]'s
          <var>forms</var> array.
          </li>
          <li>Otherwise let <var>unsubscribeForm</var> be the
          result of running the <a href=
          "#dfn-find-a-matching-unsubscribe-form" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-find-a-matching-unsubscribe-form-1">find a
          matching unsubscribe form</a> algorithm given [[form]].
          </li>
          <li>If <var>unsubscribeForm</var> is failure, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#syntaxerror"><code>SyntaxError</code></a>
          and abort these steps.
          </li>
          <li>If [[type]] is <code>"property"</code>, make a
          request to the underlying platform via the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-25">Protocol Bindings</a>
          to stop observing the <a href="#dfn-properties" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-properties-37">Property</a> identified by
          [[name]] with <var>unsubscribeForm</var> and optional URI
          templates given in <var data-type=
          "InteractionOptions">options</var>'
          <var>uriVariables</var>.
          </li>
          <li>Otherwise, if [[type]] is <code>"event"</code>, make
          a request to the underlying platform via the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-26">Protocol Bindings</a>
          to unsubscribe from the <a href="#dfn-events" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-events-18">Event</a> identified by [[name]]
          with <var>unsubscribeForm</var>, with optional URI
          templates given in <var data-type=
          "InteractionOptions">options</var>'
          <var>uriVariables</var> and optional unsubscribe data
          given in <var data-type=
          "InteractionOptions">options</var>'s <var>data</var>.
          </li>
          <li>If the request fails, reject <var data-type=
          "Promise">promise</var> with the error received from the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-27">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Otherwise set <a href="#dom-subscription-active"
            id="ref-for-dom-subscription-active-2">active</a> to
            <code>false</code> and resolve <var data-type=
            "Promise">promise</var>.
          </li>
          <li>If the underlying platform receives further
          notifications for this subscription, implementations
          <em class="rfc2119">SHOULD</em> silently suppress
          them.</li>
        </ol>
      </section>
      <section id="finding-an-unsubscribe-form">
        <h4 id="x7-16-3-finding-an-unsubscribe-form"><bdi class=
        "secno">7.16.3</bdi> Finding an unsubscribe <a href=
        "#dfn-form" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-form-25">Form</a><a class="self-link"
        aria-label="§" href=
        "#finding-an-unsubscribe-form"></a></h4>To <dfn id=
        "dfn-find-a-matching-unsubscribe-form">find a matching
        unsubscribe form</dfn> given <var>subscribeForm</var> in
        the context of a <a data-link-type="idl" href=
        "#dom-subscription" class="internalDFN" id=
        "ref-for-dom-subscription-9"><code><code>Subscription</code></code></a>
        object, run the following steps:
        <ol>
          <div class="note" role="note" id=
          "issue-container-generatedID-12">
            <div role="heading" class="note-title marker" id=
            "h-note-1" aria-level="5">
              <span>Note</span>
            </div>
            <p class="">This algorithm is under development and is
            <em>non-normative</em>. Implementations <em class=
            "rfc2119">MAY</em> choose another algorithm to find a
            matching <code>unsubscribe</code> <a href="#dfn-form"
            class="internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-form-26">Form</a> to a given
            <code>subscribe</code> <a href="#dfn-form" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-form-27">Form</a>.</p>
          </div>
          <li>Let <var>results</var> be an empty array.</li>
          <li>For each <var>form</var> in [[interaction]]'s
          <var>forms</var> array,
            <ol>
              <li>Add an <a data-link-type="dfn" href=
              "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
                internal slot</a> [[matchLevel]] on <var>form</var>
                and set its value to <code>0</code>.
              </li>
              <li>If <var>form</var>'s <var>op</var> is
              <code>"unobserveproperty"</code> if [[type]] is
              <code>"property"</code> or if <var>form</var>'s <var>
                op</var> is <code>"unsubscribeevent"</code> if
                [[type]] is<code>"event"</code>,
                <ol>
                  <li>Set the <a data-link-type="dfn" href=
                  "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
                    internal slot</a> [[matchLevel]] on
                    <var>form</var> to 1 and add <var>form</var> to
                    <var>results</var>.
                  </li>
                  <li>If <var>form</var>'s <var>href</var> and
                  [[subscribeForm]]'s <var>href</var> are
                    <a href="https://html.spec.whatwg.org/multipage/origin.html#same-origin-domain">
                    same origin-domain</a>, increment
                    <var>form</var>'s [[matchLevel]].
                  </li>
                  <li>If <var>form</var>'s <var>contentType</var>
                  is equal to [[subscribeForm]]'s
                  <var>contentType</var> and <var>form</var>'s
                  [[matchLevel]] is greater than 2, increment
                  <var>form</var>'s [[matchLevel]].</li>
                </ol>
              </li>
            </ol>
          </li>
          <li>If <var>results</var> is empty, return
          <code>null</code> and terminate these steps.</li>
          <li>Return the first <var>form</var> in
          <var>results</var> that has the highest [[matchLevel]]
          value.</li>
        </ol>
      </section>
    </section>
    <section id="consumedthing-examples">
      <h3 id="x7-17-consumedthing-examples"><bdi class=
      "secno">7.17</bdi> ConsumedThing Examples<a class="self-link"
      aria-label="§" href="#consumedthing-examples"></a></h3>
      <p>The next example illustrates how to fetch a <a href=
      "#dfn-td-0" class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-td-0-14">TD</a> by URL, create a
      <a data-link-type="idl" href="#dom-consumedthing" class=
      "internalDFN" id=
      "ref-for-dom-consumedthing-20"><code><code>ConsumedThing</code></code></a>,
      read metadata (title), read property value, subscribe to
      property change, subscribe to a WoT event, unsubscribe.</p>
      <div class="example" id=
      "example-2-thing-client-api-example-with-data-value">
        <div class="marker">
          <a class="self-link" href=
          "#example-2-thing-client-api-example-with-data-value">Example
          <bdi>2</bdi></a><span class="example-title">: Thing
          Client API example with data value</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">let</span> res = <span class=
"hljs-keyword">await</span> fetch(<span class=
"hljs-string">"https://tds.mythings.org/sensor11"</span>);
  <span class="hljs-keyword">let</span> td = res.json();
  <span class="hljs-keyword">let</span> thing = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing "</span> + thing.getThingDescription().title + <span class="hljs-string">" consumed."</span>);
} <span class="hljs-keyword">catch</span> (e) {
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"TD fetch error: "</span> + e.message);
};

<span class="hljs-keyword">try</span> {
  <span class=
"hljs-comment">// subscribe to property change for “temperature”</span>
  <span class=
"hljs-keyword">await</span> thing.observeProperty(<span class=
"hljs-string">"temperature"</span>, <span class=
"hljs-keyword">async</span> (data) =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Temperature changed to: "</span> + <span class=
"hljs-keyword">await</span> data.value());
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class=
"hljs-string">"Cannot read the observed property temperature"</span>);
      <span class="hljs-built_in">console</span>.error(error);
    }
  });
  <span class=
"hljs-comment">// subscribe to the “ready” event defined in the TD</span>
  <span class=
"hljs-keyword">await</span> thing.subscribeEvent(<span class=
"hljs-string">"ready"</span>, <span class=
"hljs-keyword">async</span> (eventData) =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Ready; index: "</span> + <span class=
"hljs-keyword">await</span> eventData.value());
      <span class=
"hljs-comment">// run the “startMeasurement” action defined by TD</span>
      <span class=
"hljs-keyword">await</span> thing.invokeAction(<span class=
"hljs-string">"startMeasurement"</span>, { <span class=
"hljs-attr">units</span>: <span class=
"hljs-string">"Celsius"</span> });
      <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Measurement started."</span>);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class=
"hljs-string">"Cannot read the ready event or startMeasurement failed"</span>);
      <span class="hljs-built_in">console</span>.error(error)
    }
  });
} <span class="hljs-keyword">catch</span> (e) {
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error starting measurement."</span>);
}

setTimeout(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class=
"hljs-keyword">const</span> temperatureData = <span class=
"hljs-keyword">await</span> thing.readProperty(<span class=
"hljs-string">"temperature"</span>)
    <span class=
"hljs-keyword">const</span> temperature = <span class=
"hljs-keyword">await</span> temperatureData.value();
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Temperature: "</span> + temperature);

    <span class=
"hljs-keyword">await</span> thing.unsubscribe(<span class=
"hljs-string">"ready"</span>);
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Unsubscribed from the ‘ready’ event."</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error in the cleanup function"</span>);
  }
}, <span class="hljs-number">10000</span>);</code></pre>
      </div>
      <p>The following shows an advance usage of <a data-link-type=
      "idl" href="#dom-interactionoutput" class="internalDFN" id=
      "ref-for-dom-interactionoutput-17"><code><code>InteractionOutput</code></code></a>
      to read a property without a <a data-link-type="idl" href=
      "#dfn-dataschema" class="internalDFN" id=
      "ref-for-dfn-dataschema-10"><code>DataSchema</code></a>.</p>
      <div class="example" id=
      "example-3-thing-client-api-example-with-arraybuffer">
        <div class="marker">
          <a class="self-link" href=
          "#example-3-thing-client-api-example-with-arraybuffer">Example
          <bdi>3</bdi></a><span class="example-title">: Thing
          Client API example with arrayBuffer</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-comment">/*
* takePicture affordance form:
* "form": {
*   "op": "invokeaction",
*   "href" : "http://camera.example.com:5683/takePicture",
*   "response": {
*     "contentType": "image/jpeg",
*     "contentCoding": "gzip"
*   }
*}
* See https://www.w3.org/TR/wot-thing-description/#example-23
*/</span>
<span class="hljs-keyword">let</span> response;
<span class="hljs-keyword">let</span> image;
<span class="hljs-keyword">try</span> {
  response = <span class=
"hljs-keyword">await</span> thing.invokeAction(“takePicture”));
  image = <span class=
"hljs-keyword">await</span> response.value() <span class=
"hljs-comment">// throws NotReadableError --&gt; schema not defined</span>
} <span class="hljs-keyword">catch</span>(ex) {
  image = <span class=
"hljs-keyword">await</span> response.arrayBuffer();
  <span class=
"hljs-comment">// image: ArrayBuffer [0x1 0x2 0x3 0x5 0x15 0x23 ...]</span>
}</code></pre>
      </div>
      <p>Finally, the next two examples shows the usage of a
      <a data-link-type="idl" data-type="interface" href=
      "https://streams.spec.whatwg.org/#readablestream"><code>ReadableStream</code></a>
      from an <a data-link-type="idl" href="#dom-interactionoutput"
      class="internalDFN" id=
      "ref-for-dom-interactionoutput-18"><code><code>InteractionOutput</code></code></a>.</p>
      <div class="example" id=
      "example-4-thing-client-api-example-with-readable-stream-e-g-video-stream">
        <div class="marker">
          <a class="self-link" href=
          "#example-4-thing-client-api-example-with-readable-stream-e-g-video-stream">
          Example <bdi>4</bdi></a><span class="example-title">:
          Thing Client API example with readable stream (e.g.,
          video stream)</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-comment">/*{
"video": {
  "description" : "the video stream of this camera",
  "forms": [
    {
      "op": "readproperty",
      "href": "http://camera.example.com/live",
      "subprotocol": "hls"
      "contentType": "video/mp4"
    }
  ]
}}*/</span>

<span class="hljs-keyword">const</span> video = <span class=
"hljs-keyword">await</span> thing.readProperty(<span class=
"hljs-string">"video"</span>)
<span class=
"hljs-keyword">const</span> reader = video.data.getReader()
reader.read().then(<span class="hljs-function"><span class=
"hljs-keyword">function</span> <span class=
"hljs-title">processVideo</span>(<span class=
"hljs-params">{ done, value }</span>) </span>{
  <span class="hljs-keyword">if</span> (done) {
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"live video stoped"</span>);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">const</span> decoded = decode(value)
  UI.show(decoded)
  <span class=
"hljs-comment">// Read some more, and call this function again</span>
  <span class=
"hljs-keyword">return</span> reader.read().then(processText);
});</code></pre>
      </div>
      <p>Here consider that the JSON object is too big to be read
      wholly in the memory. Therefore, we use streaming processing
      to get the total number of the events recorded by the remote
      Web Thing.</p>
      <div class="example" id=
      "example-5-thing-client-api-example-with-readable-stream-e-g-counting-json-objects">
        <div class="marker">
          <a class="self-link" href=
          "#example-5-thing-client-api-example-with-readable-stream-e-g-counting-json-objects">
          Example <bdi>5</bdi></a><span class="example-title">:
          Thing Client API example with readable stream (e.g.,
          counting json objects)</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-comment">/*
* "eventHistory":
* {
*   "description" : "A long list of the events recorderd by this thing",
*   "type": "array",
*   "forms": [
*     {
*       "op": "readproperty",
*       "href": "http://recorder.example.com/eventHistory",
*     }
*   ]
* }
*/</span>

<span class=
"hljs-comment">// Example of streaming processing: counting json objects</span>
<span class="hljs-keyword">let</span> objectCounter = <span class=
"hljs-number">0</span>
<span class="hljs-keyword">const</span> parser = <span class=
"hljs-keyword">new</span> Parser() <span class=
"hljs-comment">//User library for json streaming parsing (i.e. https://github.com/uhop/stream-json/wiki/Parser)</span>

parser.on(<span class=
"hljs-string">'data'</span>, data =&gt; data.name === <span class=
"hljs-string">'startObject'</span> &amp;& ++objectCounter);
parser.on(<span class=
"hljs-string">'end'</span>, () =&gt; <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">`Found <span class=
"hljs-subst">${objectCounter}</span> objects.`</span>));

<span class="hljs-keyword">const</span> response = <span class=
"hljs-keyword">await</span> thing.readProperty(“eventHistory”)
<span class=
"hljs-keyword">await</span> response.data.pipeTo(parser);

<span class="hljs-comment">// Found N objects</span></code></pre>
      </div>
    </section>
  </section>
  <section data-dfn-for="ExposedThing" id=
  "the-exposedthing-interface">
    <h2 id="x8-the-exposedthing-interface"><bdi class=
    "secno">8.</bdi> The <dfn data-export="" data-dfn-type=
    "interface" id="dom-exposedthing" data-idl="interface"
    data-title="ExposedThing" data-dfn-for=
    ""><code>ExposedThing</code></dfn> interface<a class=
    "self-link" aria-label="§" href=
    "#the-exposedthing-interface"></a></h2>
    <p>The <a data-link-type="idl" href="#dom-exposedthing" class=
    "internalDFN" id=
    "ref-for-dom-exposedthing-8"><code><code>ExposedThing</code></code></a>
    interface is the server API to operate the <a href=
    "#dfn-things" class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-things-35">Thing</a> that allows defining request
    handlers, <a href="#dfn-properties" class="internalDFN"
    data-link-type="dfn" id=
    "ref-for-dfn-properties-38">Property</a>, <a href=
    "#dfn-actions" class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-actions-17">Action</a>, and <a href="#dfn-events"
    class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-events-19">Event</a> interactions.</p>
    <pre class="idl def" id="webidl-1464445319"><span class=
    "idlHeader"><a class="self-link" href=
    "#webidl-1464445319">WebIDL</a></span><span data-idl="" class=
    "idlInterface" id="idl-def-exposedthing" data-title=
    "ExposedThing">[<span class="extAttr"><a data-type=
    "extended-attribute" href=
    "https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-type="interface"
href="#dom-exposedthing" id=
"ref-for-dom-exposedthing-9"><code>ExposedThing</code></a> {<span data-idl=""
class="idlMethod" id=
"idl-def-exposedthing-setpropertyreadhandler-name-handler"
data-title="setPropertyReadHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-10"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-setpropertyreadhandler" id=
"ref-for-dom-exposedthing-setpropertyreadhandler-1"><code>setPropertyReadHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-propertyreadhandler" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-propertyreadhandler-1"><code>PropertyReadHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" id=
"idl-def-exposedthing-setpropertywritehandler-name-handler"
data-title="setPropertyWriteHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-11"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-setpropertywritehandler" id=
"ref-for-dom-exposedthing-setpropertywritehandler-1"><code>setPropertyWriteHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-propertywritehandler" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-propertywritehandler-1"><code>PropertyWriteHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" id=
"idl-def-exposedthing-setpropertyobservehandler-name-handler"
data-title="setPropertyObserveHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-12"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-setpropertyobservehandler" id=
"ref-for-dom-exposedthing-setpropertyobservehandler-1"><code>setPropertyObserveHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-propertyreadhandler" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-propertyreadhandler-2"><code>PropertyReadHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" id=
"idl-def-exposedthing-setpropertyunobservehandler-name-handler"
data-title="setPropertyUnobserveHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-13"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-setpropertyunobservehandler" id=
"ref-for-dom-exposedthing-setpropertyunobservehandler-1"><code>setPropertyUnobserveHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-propertyreadhandler" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-propertyreadhandler-3"><code>PropertyReadHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" id="idl-def-exposedthing-emitpropertychange-name"
data-title="emitPropertyChange" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-emitpropertychange"
id=
"ref-for-dom-exposedthing-emitpropertychange-1"><code>emitPropertyChange</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>);</span><span data-idl=""
class="idlMethod" id=
"idl-def-exposedthing-setactionhandler-name-action" data-title=
"setActionHandler" data-dfn-for="ExposedThing"><span class=
"idlType">

  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-14"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-setactionhandler"
id=
"ref-for-dom-exposedthing-setactionhandler-1"><code>setActionHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType"> <a href="#dom-actionhandler"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-actionhandler-1"><code>ActionHandler</code></a></span> <span class="idlParamName">action</span>);</span><span data-idl=""
class="idlMethod" id=
"idl-def-exposedthing-seteventsubscribehandler-name-handler"
data-title="setEventSubscribeHandler" data-dfn-for=
"ExposedThing"><span class="idlType">

  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-15"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-seteventsubscribehandler" id=
"ref-for-dom-exposedthing-seteventsubscribehandler-1"><code>setEventSubscribeHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-eventsubscriptionhandler" class=
"internalDFN" data-link-type="idl" id=
"ref-for-dom-eventsubscriptionhandler-1"><code>EventSubscriptionHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" id=
"idl-def-exposedthing-seteventunsubscribehandler-name-handler"
data-title="setEventUnsubscribeHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-16"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-seteventunsubscribehandler" id=
"ref-for-dom-exposedthing-seteventunsubscribehandler-1"><code>setEventUnsubscribeHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-eventsubscriptionhandler" class=
"internalDFN" data-link-type="idl" id=
"ref-for-dom-eventsubscriptionhandler-2"><code>EventSubscriptionHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" id=
"idl-def-exposedthing-seteventhandler-name-eventhandler"
data-title="setEventHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-17"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-seteventhandler"
id="ref-for-dom-exposedthing-seteventhandler-1"><code>setEventHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-eventlistenerhandler" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-eventlistenerhandler-1"><code>EventListenerHandler</code></a></span> <span class="idlParamName">eventHandler</span>);</span><span data-idl=""
class="idlMethod" id="idl-def-exposedthing-emitevent-name-data"
data-title="emitEvent" data-dfn-for="ExposedThing"><span class=
"idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-emitevent" id=
"ref-for-dom-exposedthing-emitevent-1"><code>emitEvent</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-interactioninput" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactioninput-10"><code>InteractionInput</code></a></span> <span class="idlParamName">data</span>);</span><span data-idl=""
class="idlMethod" id="idl-def-exposedthing-expose" data-title=
"expose" data-dfn-for="ExposedThing"><span class="idlType">

  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-expose" id=
"ref-for-dom-exposedthing-expose-1"><code>expose</code></a>();</span><span data-idl=""
class="idlMethod" id="idl-def-exposedthing-destroy" data-title=
"destroy" data-dfn-for="ExposedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-destroy" id=
"ref-for-dom-exposedthing-destroy-1"><code>destroy</code></a>();</span><span data-idl=""
class="idlMethod" id="idl-def-exposedthing-getthingdescription"
data-title="getThingDescription" data-dfn-for=
"ExposedThing"><span class="idlType">

  <a href="#dom-thingdescription" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-thingdescription-10"><code>ThingDescription</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-getthingdescription" id=
"ref-for-dom-exposedthing-getthingdescription-1"><code>getThingDescription</code></a>();</span>
};</span><span data-idl="" class="idlCallback" id=
"idl-def-propertyreadhandler" data-title="PropertyReadHandler">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-propertyreadhandler" id=
"ref-for-dom-propertyreadhandler-4"><code>PropertyReadHandler</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span>(
        optional<span class="idlType"> <a href=
"#dom-interactionoptions" class="internalDFN" data-link-type="idl"
id=
"ref-for-dom-interactionoptions-11"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" id="idl-def-propertywritehandler" data-title=
"PropertyWriteHandler">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-propertywritehandler" id=
"ref-for-dom-propertywritehandler-2"><code>PropertyWriteHandler</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span>(<span class="idlType">
        <a href="#dom-interactionoutput" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoutput-19"><code>InteractionOutput</code></a></span> <span class="idlParamName">value</span>,
        optional<span class="idlType"> <a href=
"#dom-interactionoptions" class="internalDFN" data-link-type="idl"
id=
"ref-for-dom-interactionoptions-12"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" id="idl-def-actionhandler" data-title=
"ActionHandler">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-actionhandler" id=
"ref-for-dom-actionhandler-2"><code>ActionHandler</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-interactioninput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactioninput-11"><code>InteractionInput</code></a>&gt;</span>(<span class="idlType">
        <a href="#dom-interactionoutput" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoutput-20"><code>InteractionOutput</code></a></span> <span class="idlParamName">params</span>,
        optional<span class="idlType"> <a href=
"#dom-interactionoptions" class="internalDFN" data-link-type="idl"
id=
"ref-for-dom-interactionoptions-13"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" id="idl-def-eventsubscriptionhandler"
data-title="EventSubscriptionHandler">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-eventsubscriptionhandler" id=
"ref-for-dom-eventsubscriptionhandler-3"><code>EventSubscriptionHandler</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span>(
        optional<span class="idlType"> <a href=
"#dom-interactionoptions" class="internalDFN" data-link-type="idl"
id=
"ref-for-dom-interactionoptions-14"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" id="idl-def-eventlistenerhandler" data-title=
"EventListenerHandler">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-eventlistenerhandler" id=
"ref-for-dom-eventlistenerhandler-2"><code>EventListenerHandler</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-interactioninput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactioninput-12"><code>InteractionInput</code></a>&gt;</span>();</span></pre>
    <section data-dfn-for="ExposedThing" id=
    "internal-slots-for-exposedthing">
      <h3 id="x8-1-internal-slots-for-exposedthing"><bdi class=
      "secno">8.1</bdi> Internal slots for ExposedThing<a class=
      "self-link" aria-label="§" href=
      "#internal-slots-for-exposedthing"></a></h3>
      <p>An <a data-link-type="idl" href="#dom-exposedthing" class=
      "internalDFN" id=
      "ref-for-dom-exposedthing-18"><code><code>ExposedThing</code></code></a>
      object has the following <a data-link-type="dfn" href=
      "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
      internal slots</a>:</p>
      <table class="simple">
        <thead>
          <tr>
            <th>Internal Slot</th>
            <th>Initial value</th>
            <th>Description (<em>non-normative</em>)</th>
          </tr>
        </thead>
        <tbody data-link-for="ExposedThing">
          <tr>
            <td><strong><em>[[td]]</em></strong></td>
            <td><code>null</code></td>
            <td>
              The <a href="#dfn-thing-descriptions" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-thing-descriptions-22">Thing
              Description</a> of the <a href="#dfn-things" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-things-36">Thing</a>.
            </td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="constructing-exposedthing">
      <h3 id="x8-2-constructing-exposedthing"><bdi class=
      "secno">8.2</bdi> Constructing <a data-link-type="idl" href=
      "#dom-exposedthing" class="internalDFN" id=
      "ref-for-dom-exposedthing-19"><code><code>ExposedThing</code></code></a><a class="self-link"
      aria-label="§" href="#constructing-exposedthing"></a></h3>
      <p>The <a data-link-type="idl" href="#dom-exposedthing"
      class="internalDFN" id=
      "ref-for-dom-exposedthing-20"><code><code>ExposedThing</code></code></a>
      interface extends <a data-link-type="idl" href=
      "#dom-consumedthing" class="internalDFN" id=
      "ref-for-dom-consumedthing-21"><code><code>ConsumedThing</code></code></a>.
      It is constructed from a full or partial <a data-link-type=
      "idl" href="#dom-thingdescription" class="internalDFN" id=
      "ref-for-dom-thingdescription-11"><code><code>ThingDescription</code></code></a>
      object.</p>
      <div class="note" role="note" id=
      "issue-container-generatedID-13">
        <div role="heading" class="note-title marker" id="h-note-2"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">Note that an existing <a data-link-type="idl"
        href="#dom-thingdescription" class="internalDFN" id=
        "ref-for-dom-thingdescription-12"><code><code>ThingDescription</code></code></a>
        object can be optionally modified (for instance by adding
        or removing elements on its <var>properties</var>,
        <var>actions</var> and <var>events</var> internal
        properties) and the resulting object can used for
        constructing an <a data-link-type="idl" href=
        "#dom-exposedthing" class="internalDFN" id=
        "ref-for-dom-exposedthing-21"><code><code>ExposedThing</code></code></a>
        object. This is the current way of adding and removing
        <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-properties-39">Property</a>, <a href=
        "#dfn-actions" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-actions-18">Action</a> and <a href=
        "#dfn-events" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-events-20">Event</a> definitions, as
        illustrated in the <a href=
        "#exposedthing-examples">examples</a>.</p>
      </div>
      <div class="note" role="note" id=
      "issue-container-generatedID-14">
        <div role="heading" class="note-title marker" id="h-note-3"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">Before invoking <a href=
        "#dom-exposedthing-expose" id=
        "ref-for-dom-exposedthing-expose-2">expose()</a>, the
        <a data-link-type="idl" href="#dom-exposedthing" class=
        "internalDFN" id=
        "ref-for-dom-exposedthing-22"><code><code>ExposedThing</code></code></a>
        object does not serve any requests. This allows first
        constructing <a data-link-type="idl" href=
        "#dom-exposedthing" class="internalDFN" id=
        "ref-for-dom-exposedthing-23"><code><code>ExposedThing</code></code></a>
        and then initialize its <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-40">Properties</a> and service
        handlers before starting serving requests.</p>
      </div>
      <div>
        To construct an <a data-link-type="idl" href=
        "#dom-exposedthing" class="internalDFN" id=
        "ref-for-dom-exposedthing-24"><code><code>ExposedThing</code></code></a>
        with the <a data-link-type="idl" href=
        "#dom-thingdescription" class="internalDFN" id=
        "ref-for-dom-thingdescription-13"><code><code>ThingDescription</code></code></a>
        <var data-type="ThingDescription">td</var>, run the
        following steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Run the <a href="#dfn-expand-a-td" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-expand-a-td-2">expand a TD</a> steps on
          <var data-type="ThingDescription">td</var>. If that
          fails, re-<a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a>
          the error and abort these steps.
          </li>
          <li>Let <var data-type="ExposedThing">thing</var> be a
          new <a data-link-type="idl" href="#dom-exposedthing"
          class="internalDFN" id=
          "ref-for-dom-exposedthing-25"><code><code>ExposedThing</code></code></a>
          object.
          </li>
          <li>Set the <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[td]] of <var data-type=
            "ExposedThing">thing</var> to <var data-type=
            "ThingDescription">td</var>.
          </li>
          <li>Return <var data-type=
          "ExposedThing">thing</var>.</li>
        </ol>
      </div>
    </section>
    <section data-dfn-for="ExposedThing" id=
    "the-getthingdescription-method-0">
      <h3 id="x8-3-the-getthingdescription-method"><bdi class=
      "secno">8.3</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-exposedthing-getthingdescription" data-idl=
      "operation" data-title="getThingDescription()" data-dfn-for=
      "ExposedThing" data-type="ThingDescription" data-lt=
      "getThingDescription()" data-local-lt=
      "ExposedThing.getThingDescription|ExposedThing.getThingDescription()|getThingDescription">
      <code>getThingDescription()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-getthingdescription-method-0"></a></h3>
      <p>Returns the <a data-link-type="dfn" href=
      "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
      internal slot</a> [[td]] of the <a data-link-type="idl" href=
      "#dom-exposedthing" class="internalDFN" id=
      "ref-for-dom-exposedthing-26"><code><code>ExposedThing</code></code></a>
      object that represents the <a href="#dfn-thing-descriptions"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-thing-descriptions-23">Thing Description</a> of
      the <a href="#dfn-things" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-things-37">Thing</a>. Applications may
      consult the <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-things-38">Thing</a>
      metadata stored in [[td]] in order to introspect its
      capabilities before interacting with it.</p>
    </section>
    <section data-dfn-for="PropertyReadHandler" id=
    "the-propertyreadhandler-callback">
      <h3 id="x8-4-the-propertyreadhandler-callback"><bdi class=
      "secno">8.4</bdi> The <dfn data-export="" data-dfn-type=
      "callback" id="dom-propertyreadhandler" data-idl="callback"
      data-title="PropertyReadHandler" data-dfn-for=
      ""><code>PropertyReadHandler</code></dfn> callback<a class=
      "self-link" aria-label="§" href=
      "#the-propertyreadhandler-callback"></a></h3>
      <p>A function that is called when an external request for
      reading a <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-properties-41">Property</a> is received and
      defines what to do with such requests. It returns a
      <a data-link-type="idl" href=
      "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
      and resolves with an <a data-link-type="idl" data-type=
      "interface" href=
      "https://streams.spec.whatwg.org/#readablestream"><code>ReadableStream</code></a>
      object or an <a href=
      "https://www.ecma-international.org/ecma-262/11.0/index.html#sec-ecmascript-data-types-and-values">
      ECMAScript value</a> conforming to <a href="#dfn-dataschema"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-dataschema-11">DataSchema</a>, or rejects with
      an error.</p>
    </section>
    <section id="the-setpropertyreadhandler-method">
      <h3 id="x8-5-the-setpropertyreadhandler-method"><bdi class=
      "secno">8.5</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-exposedthing-setpropertyreadhandler"
      data-idl="operation" data-title="setPropertyReadHandler()"
      data-dfn-for="ExposedThing" data-type="ExposedThing" data-lt=
      "setPropertyReadHandler()|setPropertyReadHandler(name, handler)"
      data-local-lt=
      "ExposedThing.setPropertyReadHandler|ExposedThing.setPropertyReadHandler()|setPropertyReadHandler">
      <code>setPropertyReadHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-setpropertyreadhandler-method"></a></h3>
      <p>Takes as arguments <var data-type="string">name</var> and
      <var data-type="PropertyReadHandler">handler</var>. Sets the
      service handler that defines what to do when a request is
      received for reading the specified <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-42">Property</a> matched by
      <var data-type="string">name</var>. Throws on error. Returns
      a reference to <var>this</var> object for supporting
      chaining.</p>
      <div class="note" id="issue-container-generatedID-15">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-10" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">Note that there is no need to register handlers
        for handling requests for reading multiple or all <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn"
        id="ref-for-dfn-properties-43">Properties</a>. The request
        and reply are transmitted in a single network request, but
        the <a href="#dom-exposedthing" class="internalDFN"
        data-link-type="idl" id=
        "ref-for-dom-exposedthing-27"><code>ExposedThing</code></a>
        may implement them using multiple calls to the single read
        handler.</p>
      </div>
      <p>The <var data-type="PropertyReadHandler">handler</var>
      callback function should implement reading a <a href=
      "#dfn-properties" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-properties-44">Property</a> and <em class=
      "rfc2119">SHOULD</em> be called by implementations when a
      request for reading a <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-45">Property</a> is received from the
      underlying platform.</p>
      <p>There <em class="rfc2119">MUST</em> be at most one handler
      for any given <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-properties-46">Property</a>, so newly added
      handlers <em class="rfc2119">MUST</em> replace the previous
      handlers. If no handler is initialized for any given <a href=
      "#dfn-properties" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-properties-47">Property</a>, implementations
      <em class="rfc2119">SHOULD</em> implement a default property
      read handler based on the <a href="#dfn-thing-descriptions"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-thing-descriptions-24">Thing Description</a>
      provided in the [[td]] <a data-link-type="dfn" href=
      "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
      internal slot</a>.</p>
      <div>
        When the method is invoked given <var data-type=
        "string">name</var> and <var data-type=
        "PropertyReadHandler">handler</var>, implementations
        <em class="rfc2119">MUST</em> run the following steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If a <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-properties-48">Property</a> interaction with
          <var data-type="string">name</var> is not found,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a>
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>Add the <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[readHandler]] to
            <var>interaction</var> and set it to <var data-type=
            "PropertyReadHandler">handler</var>.
          </li>
        </ol>
      </div>
    </section>
    <section id="handling-requests-for-reading-a-property">
      <h3 id="x8-6-handling-requests-for-reading-a-property">
      <bdi class="secno">8.6</bdi> Handling requests for reading a
      Property<a class="self-link" aria-label="§" href=
      "#handling-requests-for-reading-a-property"></a></h3>
      <div>
        When a network request for reading <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn"
        id="ref-for-dfn-properties-49">Property</a> <var data-type=
        "string">name</var> is received by the implementation with
        <var data-type="InteractionOptions">options</var>, run the
        following steps:
        <ol>
          <li>If this operation is not supported, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-28">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>If this operation is not allowed, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notallowederror"><code>
            NotAllowedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-29">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>Let <var>value</var> be the result of running the
          <dfn id="dfn-read-server-property">read server
          property</dfn> steps with <var data-type=
          "string">name</var> and <var data-type=
          "InteractionOptions">options</var>:
            <ol>
              <li>Let <var>interaction</var> be the value of
              [[td]]'s <var>properties</var>'s <var data-type=
              "string">name</var>.</li>
              <li>If a <a href="#dfn-properties" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-properties-50">Property</a> with
              <var data-type="string">name</var> does not exist,
              throw <a data-link-type="idl" data-type="exception"
              href=
              "https://heycam.github.io/webidl/#notfounderror"><code>
                NotFoundError</code></a> and abort these steps.
              </li>
              <li>Let <var data-type="function">handler</var> be
              <code>null</code>.</li>
              <li>If there is a user provided <a data-link-type=
              "dfn" href=
              "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
                internal slot</a> [[readHandler]] on
                <var>interaction</var>, let <var data-type=
                "function">handler</var> be that.
              </li>
              <li>Otherwise, if there is a default read handler
              provided by the implementation, let <var data-type=
              "function">handler</var> be that.</li>
              <li>If <var data-type="function">handler</var> is
              <code>null</code>, throw <a data-link-type="idl"
              data-type="exception" href=
              "https://heycam.github.io/webidl/#notsupportederror">
                <code>NotSupportedError</code></a> and abort these
                steps.
              </li>
              <li>Let <var>value</var> be the result of invoking
              <var data-type="function">handler</var> with
              <var data-type="InteractionOptions">options</var>. If
              that fails, throw the error and abort these
              steps.</li>
              <li>Return <var>value</var>.
                <div class="note" role="note" id=
                "issue-container-generatedID-16">
                  <div role="heading" class="note-title marker" id=
                  "h-note-4" aria-level="4">
                    <span>Note</span>
                  </div>
                  <p class="">The <var>value</var> returned here
                  <em class="rfc2119">SHOULD</em> either conform to
                  <a href="#dfn-dataschema" class="internalDFN"
                  data-link-type="dfn" id=
                  "ref-for-dfn-dataschema-12">DataSchema</a> or it
                  <em class="rfc2119">SHOULD</em> be an
                  <a data-link-type="idl" data-type="interface"
                  href=
                  "https://streams.spec.whatwg.org/#readablestream">
                  <code>ReadableStream</code></a> object created by
                  the <var data-type="function">handler</var>.</p>
                </div>
              </li>
            </ol>
          </li>
          <li>If the previous step has thrown an error, send the
          error back with the reply created by following the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-30">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Serialize and add the returned <var>value</var> to
          the reply created by following the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-31">Protocol Bindings</a>.
          </li>
        </ol>
      </div>
    </section>
    <section id=
    "handling-requests-for-reading-multiple-properties">
      <h3 id=
      "x8-7-handling-requests-for-reading-multiple-properties">
      <bdi class="secno">8.7</bdi> Handling requests for reading
      multiple Properties<a class="self-link" aria-label="§" href=
      "#handling-requests-for-reading-multiple-properties"></a></h3>
      <div>
        When a network request for reading multiple <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn"
        id="ref-for-dfn-properties-51">Properties</a> given in an
        object <var>propertyNames</var> is received with
        <var data-type="InteractionOptions">options</var>, run the
        following <dfn id="dfn-read-multiple-properties">read
        multiple properties</dfn> steps on <var>propertyNames</var>
        and <var data-type="InteractionOptions">options</var>:
        <ol>
          <li>If this operation is not supported, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-32">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>If this operation is not allowed, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notallowederror"><code>
            NotAllowedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-33">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>For each property with key <var>name</var> defined in
          <var>propertyNames</var>,
            <ol>
              <li>Let <var>value</var> be the result of running the
              <a href="#dfn-read-server-property" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-read-server-property-1">read server
              property</a> steps on <var>name</var> and
              <var data-type="InteractionOptions">options</var>. If
              that throws, send back the error in the reply created
              by following the <a href="#dfn-protocol-bindings"
              class="internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-protocol-bindings-34">Protocol
              Bindings</a> and abort these steps.
              </li>
              <li>Set the value of <var>propertyNames</var>'s
              <var>name</var> to <var>value</var>.</li>
            </ol>
          </li>
          <li>Reply to the request by sending a single reply
          created from <var>propertyNames</var> according to the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-35">Protocol Bindings</a>.
          </li>
        </ol>
      </div>
    </section>
    <section id="handling-requests-for-reading-all-properties">
      <h3 id="x8-8-handling-requests-for-reading-all-properties">
      <bdi class="secno">8.8</bdi> Handling requests for reading
      all Properties<a class="self-link" aria-label="§" href=
      "#handling-requests-for-reading-all-properties"></a></h3>
      <div>
        When a network request for reading all <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn"
        id="ref-for-dfn-properties-52">Properties</a> is received
        with <var data-type="InteractionOptions">options</var>, run
        the following steps:
        <ol>
          <li>If this operation is not supported, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-36">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>If this operation is not allowed, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notallowederror"><code>
            NotAllowedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-37">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>Let <var>properties</var> be an object created with
          all properties defined in the <a href="#dfn-things"
            class="internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-things-39">Thing</a> with values set to
            <code>null</code>.
          </li>
          <li>Run the <a href="#dfn-read-multiple-properties"
            class="internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-read-multiple-properties-1">read multiple
            properties</a> steps on <var>properties</var> and
            <var data-type="InteractionOptions">options</var>.
          </li>
        </ol>
      </div>
    </section>
    <section id="the-setpropertyobservehandler-method">
      <h3 id="x8-9-the-setpropertyobservehandler-method">
      <bdi class="secno">8.9</bdi> The <dfn data-export=""
      data-dfn-type="method" id=
      "dom-exposedthing-setpropertyobservehandler" data-idl=
      "operation" data-title="setPropertyObserveHandler()"
      data-dfn-for="ExposedThing" data-type="ExposedThing" data-lt=
      "setPropertyObserveHandler()|setPropertyObserveHandler(name, handler)"
      data-local-lt=
      "ExposedThing.setPropertyObserveHandler|ExposedThing.setPropertyObserveHandler()|setPropertyObserveHandler">
      <code>setPropertyObserveHandler()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-setpropertyobservehandler-method"></a></h3>
      <p>Takes as arguments <var data-type="string">name</var> and
      <var data-type="PropertyReadHandler">handler</var>. Sets the
      service handler that defines what to do when a request is
      received for observing the specified <a href=
      "#dfn-properties" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-properties-53">Property</a> matched by
      <var data-type="string">name</var>. Throws on error. Returns
      a reference to <var>this</var> object for supporting
      chaining.</p>
      <p>The <var data-type="PropertyReadHandler">handler</var>
      callback function should implement reading a <a href=
      "#dfn-properties" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-properties-54">Property</a> and resolve with
      an <a data-link-type="idl" href="#dom-interactionoutput"
      class="internalDFN" id=
      "ref-for-dom-interactionoutput-21"><code><code>InteractionOutput</code></code></a>
      object or reject with an error.</p>
      <p>There <em class="rfc2119">MUST</em> be at most one handler
      for any given <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-properties-55">Property</a>, so newly added
      handlers <em class="rfc2119">MUST</em> replace the previous
      handlers. If no handler is initialized for any given <a href=
      "#dfn-properties" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-properties-56">Property</a>, implementations
      <em class="rfc2119">SHOULD</em> implement a default property
      read handler based on the <a href="#dfn-thing-descriptions"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-thing-descriptions-25">Thing
      Description</a>.</p>
      <div>
        When the method is invoked given <var data-type=
        "string">name</var> and <var data-type=
        "PropertyReadHandler">handler</var>, implementations
        <em class="rfc2119">MUST</em> run the following steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If a <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-properties-57">Property</a> interaction with
          <var data-type="string">name</var> is not found,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a>
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>Set the <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[observeHandler]] on
            <var>interaction</var> to <var data-type=
            "PropertyReadHandler">handler</var>.
          </li>
        </ol>
      </div>
    </section>
    <section id="handling-property-observe-requests">
      <h3 id="x8-10-handling-property-observe-requests"><bdi class=
      "secno">8.10</bdi> Handling <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-58">Property</a> observe
      requests<a class="self-link" aria-label="§" href=
      "#handling-property-observe-requests"></a></h3>
      <div>
        When a network request for observing a <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn"
        id="ref-for-dfn-properties-59">Property</a> <var data-type=
        "string">name</var> is received by the implementation with
        <var data-type="InteractionOptions">options</var>, run the
        following steps:
        <ol>
          <li>If this operation is not supported, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-38">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>If this operation is not allowed, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notallowederror"><code>
            NotAllowedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-39">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>Let <var>property</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">name</var>. If it does not exist, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          in the reply and abort these steps.
          </li>
          <li>Save the request sender information together with
          <var data-type="InteractionOptions">options</var> to
          <var>property</var>'s <a href=
          "#dfn-internal-observer-list" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-internal-observer-list-1">internal observer
          list</a>, in order to be able to notify about <a href=
          "#dfn-properties" class="internalDFN" data-link-type=
          "dfn" id="ref-for-dfn-properties-60">Property</a> value
          changes.
          </li>
        </ol>
      </div>
      <div class="note" role="note" id=
      "issue-container-generatedID-17">
        <div role="heading" class="note-title marker" id="h-note-5"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">Every time the value of <var>property</var>
        changes, <a href=
        "#the-emitpropertychange-method"><code>emitPropertyChange()</code></a>
        needs to be explicitly called by the application
        script.</p>
      </div>
    </section>
    <section id="the-setpropertyunobservehandler-method">
      <h3 id="x8-11-the-setpropertyunobservehandler-method">
      <bdi class="secno">8.11</bdi> The <dfn data-export=""
      data-dfn-type="method" id=
      "dom-exposedthing-setpropertyunobservehandler" data-idl=
      "operation" data-title="setPropertyUnobserveHandler()"
      data-dfn-for="ExposedThing" data-type="ExposedThing" data-lt=
      "setPropertyUnobserveHandler()|setPropertyUnobserveHandler(name, handler)"
      data-local-lt=
      "ExposedThing.setPropertyUnobserveHandler|ExposedThing.setPropertyUnobserveHandler()|setPropertyUnobserveHandler">
      <code>setPropertyUnobserveHandler()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-setpropertyunobservehandler-method"></a></h3>
      <p>Takes as arguments <var data-type="string">name</var> and
      <var data-type="PropertyReadHandler">handler</var>. Sets the
      service handler that defines what to do when a request is
      received for unobserving the specified <a href=
      "#dfn-properties" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-properties-61">Property</a> matched by
      <var data-type="string">name</var>. Throws on error. Returns
      a reference to <var>this</var> object for supporting
      chaining.</p>
      <p>The <var data-type="PropertyReadHandler">handler</var>
      callback function should implement what to do when an
      unobserve request is received by the implementation.</p>
      <p>There <em class="rfc2119">MUST</em> be at most one handler
      for any given <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-properties-62">Property</a>, so newly added
      handlers <em class="rfc2119">MUST</em> replace the previous
      handlers. If no handler is initialized for any given <a href=
      "#dfn-properties" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-properties-63">Property</a>, implementations
      <em class="rfc2119">SHOULD</em> implement a default handler
      based on the <a href="#dfn-thing-descriptions" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-thing-descriptions-26">Thing
      Description</a>.</p>
      <div>
        When the method is invoked given <var data-type=
        "string">name</var> and <var data-type=
        "PropertyReadHandler">handler</var>, implementations
        <em class="rfc2119">MUST</em> run the following steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If a <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-properties-64">Property</a> interaction with
          <var data-type="string">name</var> is not found,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a>
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>Set the <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[unobserveHandler]] on
            <var>interaction</var> to <var data-type=
            "PropertyReadHandler">handler</var>.
          </li>
        </ol>
      </div>
    </section>
    <section id="handling-property-unobserve-requests">
      <h3 id="x8-12-handling-property-unobserve-requests">
      <bdi class="secno">8.12</bdi> Handling <a href=
      "#dfn-properties" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-properties-65">Property</a> unobserve
      requests<a class="self-link" aria-label="§" href=
      "#handling-property-unobserve-requests"></a></h3>
      <div>
        When a network request for unobserving a <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn"
        id="ref-for-dfn-properties-66">Property</a> <var data-type=
        "string">name</var> with <var data-type=
        "InteractionOptions">options</var> is received by the
        implementation, run the following steps:
        <ol>
          <li>If this operation is not supported, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-40">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>If this operation is not allowed, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notallowederror"><code>
            NotAllowedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-41">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>Let <var>property</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">name</var>. If it does not exist, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          in the reply and abort these steps.
          </li>
          <li>If there is an [[unobserveHandler]] of type
          <a data-link-type="idl" data-type="callback" href=
          "https://heycam.github.io/webidl/#Function"><code>Function</code></a>
          defined for <var data-type="string">name</var> on
          <var>property</var>, invoke that with <var data-type=
          "InteractionOptions">options</var>, send back a reply
          following the <a href="#dfn-protocol-bindings" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-42">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Let <var>sender</var> be the matching observer found
          in <var>property</var>'s <a href=
          "#dfn-internal-observer-list" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-internal-observer-list-2">internal observer
          list</a>. If not found, send back a <a data-link-type=
          "idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          in the reply and abort these steps.
          </li>
          <li>Remove <var>sender</var> from <var>property</var>'s
          <a href="#dfn-internal-observer-list" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-internal-observer-list-3">internal
            observer list</a> and send back a reply following the
            <a href="#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-43">Protocol
            Bindings</a>.
          </li>
        </ol>
      </div>
    </section>
    <section id="the-emitpropertychange-method">
      <h3 id="x8-13-the-emitpropertychange-method"><bdi class=
      "secno">8.13</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-exposedthing-emitpropertychange" data-idl=
      "operation" data-title="emitPropertyChange()" data-dfn-for=
      "ExposedThing" data-type="Promise" data-lt=
      "emitPropertyChange()|emitPropertyChange(name)"
      data-local-lt="ExposedThing.emitPropertyChange|ExposedThing.emitPropertyChange()|emitPropertyChange">
      <code>emitPropertyChange()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-emitpropertychange-method"></a></h3>
      <div>
        Takes the <var data-type="string">name</var> argument,
        denoting a <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-properties-67">Property</a> name. Triggers
        emitting a notification to all observers of the specified
        <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-properties-68">Property</a> with the data
        obtained from the observe handler or the read handler
        associated with that <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-69">Property</a>. The method
        <em class="rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>property</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If a <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-properties-70">Property</a> with the name
          <var data-type="string">name</var> is not found, reject
          <var data-type="Promise">promise</var> with
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>Let <var data-type="function">handler</var> be
          <code>null.</code></li>
          <li>If there is an [[observeHandler]]
            <a data-link-type="dfn" href=
            "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> on <var>property</var>, let
            <var data-type="function">handler</var> be that.
          </li>
          <li>Otherwise, if there is a [[readHandler]]
          <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> associated with <var data-type=
            "string">name</var> on <var>property</var>, let
            <var data-type="function">handler</var> be that.
          </li>
          <li>If <var data-type="function">handler</var> is
          <code>null</code>, abort these steps.</li>
          <li>Let <var data-type="Promise">promise</var> be the
          result of invoking <var data-type=
          "function">handler</var> wih <code>null</code>.</li>
          <li>If <var data-type="Promise">promise</var> rejects,
          abort these steps.</li>
          <li>If <var data-type="Promise">promise</var> resolves
          with <var>data</var>, then for each <var>observer</var>
          in <var>property</var>'s <a href=
          "#dfn-internal-observer-list" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-internal-observer-list-4">internal observer
          list</a>, run the following sub-steps:
            <ol>
              <li>Let <var>options</var> be the interaction options
              saved with <var>observer</var>.</li>
              <li>Create a <var>reply</var> from <var>data</var>
              and <var>options</var> according to the <a href=
              "#dfn-protocol-bindings" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-protocol-bindings-44">Protocol
              Bindings</a>.
              </li>
              <li>Send <var>reply</var> to
              <var>observer</var>.</li>
            </ol>
          </li>
        </ol>
      </div>
    </section>
    <section data-dfn-for="PropertyWriteHandler" id=
    "the-propertywritehandler-callback">
      <h3 id="x8-14-the-propertywritehandler-callback"><bdi class=
      "secno">8.14</bdi> The <dfn data-export="" data-dfn-type=
      "callback" id="dom-propertywritehandler" data-idl="callback"
      data-title="PropertyWriteHandler" data-dfn-for=
      ""><code>PropertyWriteHandler</code></dfn> callback<a class=
      "self-link" aria-label="§" href=
      "#the-propertywritehandler-callback"></a></h3>
      <p>A function that is called when an external request for
      writing a <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-properties-71">Property</a> is received and
      defines what to do with such requests. Takes as argument
      <var data-type="InteractionOutput">value</var> and returns a
      <a data-link-type="idl" href=
      "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>,
      resolved when the value of the <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-72">Property</a> - identified by the
      name provided when setting the handler has been updated -, or
      rejects with an error if the property is not found or the
      value cannot be updated.</p>
      <div class="note" id="issue-container-generatedID-18">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-11" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">Note that the code in this callback function
        can read the property before updating it in order to find
        out the old value, if needed. Therefore the old value is
        not provided to this function.</p>
      </div>
      <div class="note" role="note" id=
      "issue-container-generatedID-19">
        <div role="heading" class="note-title marker" id="h-note-6"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">The value is provided by implementations as an
        <a data-link-type="idl" href="#dom-interactionoutput"
        class="internalDFN" id=
        "ref-for-dom-interactionoutput-22"><code><code>InteractionOutput</code></code></a>
        object in order to be able to represent values that are not
        described by a <a href="#dfn-dataschema" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-dataschema-13">DataSchema</a>, such as
        streams.</p>
      </div>
    </section>
    <section id="the-setpropertywritehandler-method">
      <h3 id="x8-15-the-setpropertywritehandler-method"><bdi class=
      "secno">8.15</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-exposedthing-setpropertywritehandler"
      data-idl="operation" data-title="setPropertyWriteHandler()"
      data-dfn-for="ExposedThing" data-type="ExposedThing" data-lt=
      "setPropertyWriteHandler()|setPropertyWriteHandler(name, handler)"
      data-local-lt=
      "ExposedThing.setPropertyWriteHandler|ExposedThing.setPropertyWriteHandler()|setPropertyWriteHandler">
      <code>setPropertyWriteHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-setpropertywritehandler-method"></a></h3>
      <p>Takes as arguments <var data-type="string">name</var> and
      <var data-type="PropertyWriteHandler">handler</var>. Sets the
      service handler that defines what to do when a request is
      received for writing the <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-73">Property</a> matched by
      <var data-type="string">name</var> given when setting the
      handler. Throws on error. Returns a reference to
      <var>this</var> object for supporting chaining.</p>
      <div class="note" role="note" id=
      "issue-container-generatedID-20">
        <div role="heading" class="note-title marker" id="h-note-7"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">Note that even for readonly <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn"
        id="ref-for-dfn-properties-74">Properties</a> it is
        possible to specify a write handler, as explained in
        <a href=
        "https://github.com/w3c/wot-scripting-api/issues/199">Issue
        199</a>. In this case, the write handler may define in an
        application-specific way to fail the request.</p>
      </div>
      <p>There <em class="rfc2119">MUST</em> be at most one write
      handler for any given <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-75">Property</a>, so newly added
      handlers <em class="rfc2119">MUST</em> replace the previous
      handlers. If no write handler is initialized for any given
      <a href="#dfn-properties" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-properties-76">Property</a>,
      implementations <em class="rfc2119">SHOULD</em> implement
      default property update if the <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-properties-77">Property</a> is writeable and
      notifying observers on change if the <a href=
      "#dfn-properties" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-properties-78">Property</a> is observable,
      based on the <a href="#dfn-thing-descriptions" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-thing-descriptions-27">Thing
      Description</a>.</p>
      <div>
        When the method is invoked given <var data-type=
        "string">name</var> and <var data-type=
        "PropertyWriteHandler">handler</var>, implementations
        <em class="rfc2119">MUST</em> run the following steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If a <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-properties-79">Property</a> interaction with
          <var data-type="string">name</var> is not found,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a>
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>Set the <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[writeHandler]] on
            <var>interaction</var> to <var data-type=
            "PropertyWriteHandler">handler</var>.
          </li>
        </ol>
      </div>
    </section>
    <section id="handling-requests-for-writing-a-property">
      <h3 id="x8-16-handling-requests-for-writing-a-property">
      <bdi class="secno">8.16</bdi> Handling requests for writing a
      Property<a class="self-link" aria-label="§" href=
      "#handling-requests-for-writing-a-property"></a></h3>
      <div>
        When a network request for writing a <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn"
        id="ref-for-dfn-properties-80">Property</a> <var data-type=
        "string">name</var> with a new value <var data-type=
        "InteractionOutput">value</var> and <var data-type=
        "InteractionOptions">options</var> is received,
        implementations <em class="rfc2119">MUST</em> run the
        following <dfn id="dfn-update-property-steps">update
        property steps</dfn>, given <var data-type=
        "string">name</var>, <var data-type=
        "InteractionOutput">value</var>, <var data-type=
        "InteractionOptions">options</var> and <var>mode</var> set
        to <code>"single"</code>:
        <ol>
          <li>If this operation is not supported, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-45">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>If this operation is not allowed, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notallowederror"><code>
            NotAllowedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-46">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If a <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-properties-81">Property</a> with
          <var data-type="string">name</var> does not exist, return
          a <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          in the reply and abort these steps.
          </li>
          <li>Let <var data-type="function">handler</var> be
          <code>null</code>.</li>
          <li>If there is a user provided <a data-link-type="dfn"
          href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[writeHandler]] on
            <var>interaction</var>, let <var data-type=
            "function">handler</var> be that.
          </li>
          <li>Otherwise, if there is a default write handler
          provided by the implementation, let <var data-type=
          "function">handler</var> be that.</li>
          <li>Otherwise, if <var data-type="function">handler</var>
          is <code>null</code>, send back a <a data-link-type="idl"
            data-type="exception" href=
            "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> with the reply and abort
            these steps.
          </li>
          <li>Let <var>promise</var> be the result of invoking
          <var data-type="function">handler</var> with
          <var data-type="string">name</var> and <var data-type=
          "InteractionOptions">options</var>. If it fails, return
          the error in the reply and abort these steps.</li>
          <li>If <var>mode</var> is <code>"single"</code>, reply to
          the request reporting success, following the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-47">Protocol Bindings</a>
          and abort these steps.
          </li>
        </ol>
      </div>
    </section>
    <section id=
    "handling-requests-for-writing-multiple-properties">
      <h3 id=
      "x8-17-handling-requests-for-writing-multiple-properties">
      <bdi class="secno">8.17</bdi> Handling requests for writing
      multiple Properties<a class="self-link" aria-label="§" href=
      "#handling-requests-for-writing-multiple-properties"></a></h3>
      <div>
        When a network request for writing multiple <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn"
        id="ref-for-dfn-properties-82">Properties</a> given in an
        object <var>propertyNames</var> is received with
        <var data-type="InteractionOptions">options</var>, run the
        following steps:
        <ol>
          <li>If this operation is not supported, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-48">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>If this operation is not allowed, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notallowederror"><code>
            NotAllowedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-49">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>For each property with key <var>name</var> and value
          <var>value</var> defined in <var>propertyNames</var>, run
          the <a href="#dfn-update-property-steps" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-update-property-steps-1">update property
          steps</a> with <var>name</var>, <var>value</var>,
          <var data-type="InteractionOptions">options</var> and
          <var>mode</var> set to <code>"multiple"</code>. If that
          fails, reply to the request with that error and abort
          these steps.
          </li>
          <li>Reply to the request by sending a single reply
          according to the <a href="#dfn-protocol-bindings"
            class="internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-50">Protocol
            Bindings</a>.
          </li>
        </ol>
      </div>
    </section>
    <section data-dfn-for="ActionHandler" id=
    "the-actionhandler-callback">
      <h3 id="x8-18-the-actionhandler-callback"><bdi class=
      "secno">8.18</bdi> The <dfn data-export="" data-dfn-type=
      "callback" id="dom-actionhandler" data-idl="callback"
      data-title="ActionHandler" data-dfn-for=
      ""><code>ActionHandler</code></dfn> callback<a class=
      "self-link" aria-label="§" href=
      "#the-actionhandler-callback"></a></h3>
      <p>A function that is called when an external request for
      invoking an <a href="#dfn-actions" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-actions-19">Action</a>
      is received and defines what to do with such requests. It is
      invoked with <var data-type="InteractionOutput">params</var>
      and optionally with an <var data-type=
      "InteractionOptions">options</var> object. It returns a
      <a data-link-type="idl" href=
      "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
      that rejects with an error or resolves with the value
      returned by the <a href="#dfn-actions" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-actions-20">Action</a>
      as <a data-link-type="idl" href="#dom-interactioninput"
      class="internalDFN" id=
      "ref-for-dom-interactioninput-13"><code><code>InteractionInput</code></code></a>.</p>
      <div class="note" role="note" id=
      "issue-container-generatedID-21">
        <div role="heading" class="note-title marker" id="h-note-8"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">Application scripts <em class=
        "rfc2119">MAY</em> return a <a data-link-type="idl"
        data-type="interface" href=
        "https://streams.spec.whatwg.org/#readablestream"><code>ReadableStream</code></a>
        object from an <a data-link-type="idl" href=
        "#dom-actionhandler" class="internalDFN" id=
        "ref-for-dom-actionhandler-3"><code><code>ActionHandler</code></code></a>.
        Implementations will then use the stream for constructing
        the <a href="#dfn-actions" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-actions-21">Action</a>'s response.</p>
      </div>
    </section>
    <section id="the-setactionhandler-method">
      <h3 id="x8-19-the-setactionhandler-method"><bdi class=
      "secno">8.19</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-exposedthing-setactionhandler" data-idl=
      "operation" data-title="setActionHandler()" data-dfn-for=
      "ExposedThing" data-type="ExposedThing" data-lt=
      "setActionHandler()|setActionHandler(name, action)"
      data-local-lt=
      "ExposedThing.setActionHandler|ExposedThing.setActionHandler()|setActionHandler">
      <code>setActionHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-setactionhandler-method"></a></h3>
      <p>Takes as arguments <var data-type="string">name</var> and
      <var data-type="ActionHandler">action</var>. Sets the handler
      function that defines what to do when a request is received
      to invoke the <a href="#dfn-actions" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-actions-22">Action</a>
      matched by <var data-type="string">name</var>. Throws on
      error. Returns a reference to <var>this</var> object for
      supporting chaining.</p>
      <p>The <var data-type="ActionHandler">action</var> callback
      function will implement an <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-actions-23">Action</a> and <em class=
      "rfc2119">SHOULD</em> be called by implementations when a
      request for invoking the <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-actions-24">Action</a> is received from the
      underlying platform.</p>
      <p>There <em class="rfc2119">MUST</em> be at most one handler
      for any given <a href="#dfn-actions" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-actions-25">Action</a>,
      so newly added handlers <em class="rfc2119">MUST</em> replace
      the previous handlers.</p>
      <div>
        When the method is invoked given <var data-type=
        "string">name</var> and <var data-type=
        "ActionHandler">action</var>, run the following steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>actions</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If an <a href="#dfn-actions" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-actions-26">Action</a> with name
          <var data-type="string">name</var> is not found,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>Set the <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[actionHandler]] on
            <var>interaction</var> to <var data-type=
            "ActionHandler">action</var>.
          </li>
        </ol>
      </div>
    </section>
    <section id="handling-action-requests">
      <h3 id="x8-20-handling-action-requests"><bdi class=
      "secno">8.20</bdi> Handling <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-actions-27">Action</a> requests<a class=
      "self-link" aria-label="§" href=
      "#handling-action-requests"></a></h3>
      <div>
        When a network request for invoking the <a href=
        "#dfn-actions" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-actions-28">Action</a> identified by
        <var data-type="string">name</var> is received with
        <var>inputs</var> and optionally with <var data-type=
        "InteractionOptions">options</var>, run the following
        steps:
        <ol>
          <li>If this operation is not supported, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-51">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>If this operation is not allowed, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notallowederror"><code>
            NotAllowedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-52">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>properties</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If an <a href="#dfn-actions" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-actions-29">Action</a> identified by
          <var data-type="string">name</var> does not exist, return
          a <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          in the reply and abort these steps.
          </li>
          <li>Let <var data-type="function">handler</var> be
          <code>null</code>.</li>
          <li>If there is a user provided <a data-link-type="dfn"
          href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[actionHandler]] on
            <var>interaction</var>, let <var data-type=
            "function">handler</var> be its value.
          </li>
          <li>If <var data-type="function">handler</var> is <code>
            null</code>, return a <a data-link-type="idl"
            data-type="exception" href=
            "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> with the reply created by
            following the <a href="#dfn-protocol-bindings" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-53">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>Let <var>promise</var> be the result of invoking
          <var data-type="function">handler</var> with
          <var data-type="string">name</var>, <var>inputs</var> and
          <var data-type="InteractionOptions">options</var>.</li>
          <li>If <var>promise</var> rejects, send the error with
          the reply and abort these steps.</li>
          <li>When <var>promise</var> resolves with
            <var data-type="InteractionInput">data</var>, use
            <var data-type="InteractionInput">data</var> to create
            and send the reply according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-54">Protocol
            Bindings</a>.
          </li>
        </ol>
      </div>
    </section>
    <section data-dfn-for="EventListenerHandler" id=
    "the-eventlistenerhandler-callback">
      <h3 id="x8-21-the-eventlistenerhandler-callback"><bdi class=
      "secno">8.21</bdi> The <dfn data-export="" data-dfn-type=
      "callback" id="dom-eventlistenerhandler" data-idl="callback"
      data-title="EventListenerHandler" data-dfn-for=
      ""><code>EventListenerHandler</code></dfn> callback<a class=
      "self-link" aria-label="§" href=
      "#the-eventlistenerhandler-callback"></a></h3>
      <p>A function that is called when an associated <a href=
      "#dfn-events" class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-21">Event</a> is triggered and provides
      the data to be sent with the <a href="#dfn-events" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-22">Event</a> to subscribers. Returns a
      <a data-link-type="idl" href=
      "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
      that resolves with <a data-link-type="idl" href=
      "#dom-interactioninput" class="internalDFN" id=
      "ref-for-dom-interactioninput-14"><code><code>InteractionInput</code></code></a>
      value that represents the <a href="#dfn-events" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-23">Event</a> data, or rejects with an
      error.</p>
      <div class="note" role="note" id=
      "issue-container-generatedID-22">
        <div role="heading" class="note-title marker" id="h-note-9"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">Applications <em class="rfc2119">MAY</em>
        return <a data-link-type="idl" data-type="interface" href=
        "https://streams.spec.whatwg.org/#readablestream"><code>ReadableStream</code></a>
        from an <a data-link-type="idl" href=
        "#dom-eventlistenerhandler" class="internalDFN" id=
        "ref-for-dom-eventlistenerhandler-3"><code><code>EventListenerHandler</code></code></a>
        Implementations will then use the stream provided in
        <a data-link-type="idl" href="#dom-interactionoutput"
        class="internalDFN" id=
        "ref-for-dom-interactionoutput-23"><code><code>InteractionOutput</code></code></a>
        when constructing the event notification.</p>
      </div>
    </section>
    <section data-dfn-for="EventSubscriptionHandler" id=
    "the-eventsubscriptionhandler-callback">
      <h3 id="x8-22-the-eventsubscriptionhandler-callback">
      <bdi class="secno">8.22</bdi> The <dfn data-export=""
      data-dfn-type="callback" id="dom-eventsubscriptionhandler"
      data-idl="callback" data-title="EventSubscriptionHandler"
      data-dfn-for=""><code>EventSubscriptionHandler</code></dfn>
      callback<a class="self-link" aria-label="§" href=
      "#the-eventsubscriptionhandler-callback"></a></h3>
      <p>A function that is called when an external request for
      subscribing to an <a href="#dfn-events" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-events-24">Event</a> is
      received and defines what to do with such requests. It is
      invoked with an <var data-type=
      "InteractionOptions">options</var> object provided by the
      implementation and coming from subscribers. It returns a
      <a data-link-type="idl" href=
      "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
      that rejects with an error or resolves when the subscription
      is accepted.</p>
    </section>
    <section id="the-seteventsubscribehandler-method">
      <h3 id="x8-23-the-seteventsubscribehandler-method">
      <bdi class="secno">8.23</bdi> The <dfn data-export=""
      data-dfn-type="method" id=
      "dom-exposedthing-seteventsubscribehandler" data-idl=
      "operation" data-title="setEventSubscribeHandler()"
      data-dfn-for="ExposedThing" data-type="ExposedThing" data-lt=
      "setEventSubscribeHandler()|setEventSubscribeHandler(name, handler)"
      data-local-lt=
      "ExposedThing.setEventSubscribeHandler|ExposedThing.setEventSubscribeHandler()|setEventSubscribeHandler">
      <code>setEventSubscribeHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-seteventsubscribehandler-method"></a></h3>
      <p>Takes as arguments <var data-type="string">name</var> and
      <var data-type="EventSubscriptionHandler">handler</var>. Sets
      the handler function that defines what to do when a
      subscription request is received for the specified <a href=
      "#dfn-events" class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-25">Event</a> matched by <var data-type=
      "string">name</var>. Throws on error. Returns a reference to
      <var>this</var> object for supporting chaining.</p>
      <p>The <var data-type=
      "EventSubscriptionHandler">handler</var> callback function
      <em class="rfc2119">SHOULD</em> implement what to do when an
      subscribe request is received, for instance necessary
      initializations. Note that the handler for emitting <a href=
      "#dfn-events" class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-26">Events</a> is set separately.</p>
      <p>There <em class="rfc2119">MUST</em> be at most one event
      subscribe handler for any given <a href="#dfn-events" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-27">Event</a>, so newly added handlers
      <em class="rfc2119">MUST</em> replace the previous
      handlers.</p>
      <div>
        When the method is invoked given <var data-type=
        "string">name</var> and <var data-type=
        "EventSubscriptionHandler">handler</var>, run the following
        steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>events</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If an <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-events-28">Event</a>
          with the name <var data-type="string">name</var> is not
          found, <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>Set the <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[subscribeHandler]] on
            <var>interaction</var> to <var data-type=
            "EventSubscriptionHandler">handler</var>.
          </li>
          <li>Return <code>this</code>.</li>
        </ol>
      </div>
    </section>
    <section id="handling-event-subscribe-requests">
      <h3 id="x8-24-handling-event-subscribe-requests"><bdi class=
      "secno">8.24</bdi> Handling <a href="#dfn-events" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-29">Event</a> subscribe requests<a class=
      "self-link" aria-label="§" href=
      "#handling-event-subscribe-requests"></a></h3>
      <div>
        When an <a href="#dfn-events" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-events-30">Event</a>
        subscription request for <var>name</var> is received by the
        underlying platform with optional <var data-type=
        "InteractionOptions">options</var>, run the following
        steps:
        <ol>
          <li>If this operation is not supported, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-55">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>If this operation is not allowed, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notallowederror"><code>
            NotAllowedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-56">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>events</var>'s <var>name</var>.</li>
          <li>If an <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-events-31">Event</a>
          with the name <var>name</var> is not found, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>If <var>name</var> has an associated
          [[subscribeHandler]] <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a>, invoke it with <var data-type=
            "InteractionOptions">options</var> and abort these
            steps.
          </li>
          <li>Otherwise, if no [[subscribeHandler]] is defined,
          then implement the default subscriber mechanism:
            <ol>
              <li>Let <var>subscriber</var> be a tuple formed of
              <var data-type="InteractionOptions">options</var>
              (from which <var>uriVariables</var> and
              <var>data</var> may be used) and the subscriber
              information needed to create an <a href="#dfn-events"
                class="internalDFN" data-link-type="dfn" id=
                "ref-for-dfn-events-32">Event</a> notification
                response.
              </li>
              <li>Add <var>subscriber</var> to the <a href=
              "#dfn-internal-listener-list" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-internal-listener-list-1">internal
              listener list</a> of <var>interaction</var>.
              </li>
            </ol>
          </li>
        </ol>
      </div>
    </section>
    <section id="the-seteventunsubscribehandler-method">
      <h3 id="x8-25-the-seteventunsubscribehandler-method">
      <bdi class="secno">8.25</bdi> The <dfn data-export=""
      data-dfn-type="method" id=
      "dom-exposedthing-seteventunsubscribehandler" data-idl=
      "operation" data-title="setEventUnsubscribeHandler()"
      data-dfn-for="ExposedThing" data-type="ExposedThing" data-lt=
      "setEventUnsubscribeHandler()|setEventUnsubscribeHandler(name, handler)"
      data-local-lt=
      "ExposedThing.setEventUnsubscribeHandler|ExposedThing.setEventUnsubscribeHandler()|setEventUnsubscribeHandler">
      <code>setEventUnsubscribeHandler()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-seteventunsubscribehandler-method"></a></h3>
      <p>Takes as arguments <var data-type="string">name</var> and
      <var data-type="EventSubscriptionHandler">handler</var>. Sets
      the handler function that defines what to do when the
      specified <a href="#dfn-events" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-events-33">Event</a>
      matched by <var data-type="string">name</var> is unsubscribed
      from. Throws on error. Returns a reference to <var>this</var>
      object for supporting chaining.</p>
      <p>The <var data-type=
      "EventSubscriptionHandler">handler</var> callback function
      <em class="rfc2119">SHOULD</em> implement what to do when an
      unsubscribe request is received.</p>
      <p>There <em class="rfc2119">MUST</em> be at most one handler
      for any given <a href="#dfn-events" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-events-34">Event</a>, so
      newly added handlers <em class="rfc2119">MUST</em> replace
      the previous handlers.</p>
      <div>
        When the method is invoked with <var data-type=
        "string">name</var> and <var data-type=
        "EventSubscriptionHandler">handler</var>, run the following
        steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>events</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If an <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-events-35">Event</a>
          with the name <var data-type="string">name</var> is not
          found, <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>Set the <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[unsubscribeHandler]] on
            <var>interaction</var> to <var data-type=
            "EventSubscriptionHandler">handler</var>.
          </li>
          <li>Return <code>this</code>.</li>
        </ol>
      </div>
    </section>
    <section id="handling-event-unsubscribe-requests">
      <h3 id="x8-26-handling-event-unsubscribe-requests">
      <bdi class="secno">8.26</bdi> Handling <a href="#dfn-events"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-36">Event</a> unsubscribe
      requests<a class="self-link" aria-label="§" href=
      "#handling-event-unsubscribe-requests"></a></h3>
      <div>
        When an <a href="#dfn-events" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-events-37">Event</a>
        unsubscribe request for <var>name</var> is received by the
        underlying platform optionally with <var data-type=
        "InteractionOptions">options</var>, run the following
        steps:
        <ol>
          <li>If this operation is not supported, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-57">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>If this operation is not allowed, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notallowederror"><code>
            NotAllowedError</code></a> according to the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-58">Protocol
            Bindings</a> and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>events</var>'s <var>name</var>.</li>
          <li>If an <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-events-38">Event</a>
          with the name <var>name</var> is not found, send back a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>If <var>name</var> has an associated
          [[unsubscribeHandler]] <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> that is a function, invoke it with
            <var data-type="InteractionOptions">options</var> and
            abort these steps.
          </li>
          <li>Otherwise let <var>subscriber</var> be the tuple
          saved in <var>interaction</var>'s <a href=
          "#dfn-internal-listener-list" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-internal-listener-list-2">internal listener
          list</a>.
          </li>
          <li>Remove <var>subscriber</var> from
          <var>interaction</var>'s <a href=
          "#dfn-internal-listener-list" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-internal-listener-list-3">internal listener
          list</a>.
          </li>
          <li>Return <code>this</code>.</li>
        </ol>
      </div>
    </section>
    <section id="the-seteventhandler-method">
      <h3 id="x8-27-the-seteventhandler-method"><bdi class=
      "secno">8.27</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-exposedthing-seteventhandler" data-idl=
      "operation" data-title="setEventHandler()" data-dfn-for=
      "ExposedThing" data-type="ExposedThing" data-lt=
      "setEventHandler()|setEventHandler(name, eventHandler)"
      data-local-lt=
      "ExposedThing.setEventHandler|ExposedThing.setEventHandler()|setEventHandler">
      <code>setEventHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-seteventhandler-method"></a></h3>
      <p>Takes as arguments <var data-type="string">name</var> and
      <var data-type="EventListenerHandler">eventHandler</var>.
      Sets the event handler function for the specified <a href=
      "#dfn-events" class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-events-39">Event</a> matched by <var data-type=
      "string">name</var>. Throws on error. Returns a reference to
      <var>this</var> object for supporting chaining.</p>
      <p>The <var data-type=
      "EventListenerHandler">eventHandler</var> callback function
      will implement what to do when the event is emitted. It
      <em class="rfc2119">SHOULD</em> resolve with a value that
      represents the <a href="#dfn-events" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-events-40">Event</a>
      data, or reject with an error.</p>
      <p>There <em class="rfc2119">MUST</em> be at most one handler
      for any given <a href="#dfn-events" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-events-41">Event</a>, so
      newly added handlers <em class="rfc2119">MUST</em> replace
      the previous handlers.</p>
      <div>
        When the method is invoked with <var data-type=
        "string">name</var> and <var data-type=
        "EventListenerHandler">eventHandler</var>, run the
        following steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons,
          <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>events</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If an <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-events-42">Event</a>
          with the name <var data-type="string">name</var> is not
          found, <a data-link-type="dfn" data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>Set the <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[eventHandler]] of
            <var>interaction</var> to <var data-type=
            "EventListenerHandler">eventHandler</var>.
          </li>
          <li>Return <code>this</code>.</li>
        </ol>
      </div>
    </section>
    <section id="handling-events">
      <h3 id="x8-28-handling-events"><bdi class="secno">8.28</bdi>
      Handling <a href="#dfn-events" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-events-43">Events</a><a class="self-link"
      aria-label="§" href="#handling-events"></a></h3>
      <div>
        When an <a href="#dfn-events" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-events-44">Event</a>
        with name <var>name</var> is emitted with <var data-type=
        "InteractionInput">data</var> either by the underlying
        platform or by the <a href=
        "#the-emitevent-method">emitEvent()</a> method, run the
        following steps:
        <ol>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>events</var>'s <var>name</var>.</li>
          <li>If <var data-type="InteractionInput">data</var> is
          not defined or <code>null</code>,
            <ol>
              <li>Let <var>eventHandler</var> be the value of the
              [[eventHandler]] <a data-link-type="dfn" href=
              "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
                internal slot</a> of <var>interaction</var>.
              </li>
              <li>If <var>eventHandler</var> is failure, abort
              these steps.</li>
              <li>Let <var data-type="InteractionInput">data</var>
              be the result of awaiting to resolve the invocation
              of <var>eventHandler</var>. If it rejects, abort
              these steps.</li>
            </ol>
          </li>
          <li>For each <var>subscriber</var> in the <a href=
          "#dfn-internal-listener-list" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-internal-listener-list-4">internal listener
          list</a> of <var>interaction</var>, run the following
          sub-steps:
            <ol>
              <li>Create an <a href="#dfn-events" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-events-45">Event</a> notification <var>
                response</var> according to the <a href=
                "#dfn-protocol-bindings" class="internalDFN"
                data-link-type="dfn" id=
                "ref-for-dfn-protocol-bindings-59">Protocol
                Bindings</a> from <var data-type=
                "InteractionInput">data</var> and
                <var>subscriber</var>, including its
                <var>options</var>. If the underlying protocol
                stack permits conveying event errors and if an
                error condition has been detected by the UA, create
                <var>response</var> as an error notification
                according to the <a href="#dfn-protocol-bindings"
                class="internalDFN" data-link-type="dfn" id=
                "ref-for-dfn-protocol-bindings-60">Protocol
                Bindings</a>, using <var data-type=
                "InteractionInput">data</var>,
                <var>subscriber</var> and its <var>options</var>.
                <div class="note" role="note" id=
                "issue-container-generatedID-23">
                  <div role="heading" class="note-title marker" id=
                  "h-note-10" aria-level="4">
                    <span>Note</span>
                  </div>
                  <p class="">The error reporting is protocol
                  specific and it is encapsulated by
                  implementations. On the client end, the error
                  listener passed with the subscription will be
                  invoked if the client UA detects the error.</p>
                </div>
              </li>
              <li>Send <var>response</var> to the subscriber
              identified by <var>subscriber</var>.</li>
            </ol>
          </li>
        </ol>
      </div>
    </section>
    <section id="the-emitevent-method">
      <h3 id="x8-29-the-emitevent-method"><bdi class=
      "secno">8.29</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-exposedthing-emitevent" data-idl="operation"
      data-title="emitEvent()" data-dfn-for="ExposedThing"
      data-type="Promise" data-lt=
      "emitEvent()|emitEvent(name, data)" data-local-lt=
      "ExposedThing.emitEvent|ExposedThing.emitEvent()|emitEvent"><code>
      emitEvent()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-emitevent-method"></a></h3>
      <div>
        Takes as arguments <var data-type="string">name</var>
        denoting an <a href="#dfn-events" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-events-46">Event</a>
        name and <var data-type="InteractionInput">data</var>.
        Triggers emitting the <a href="#dfn-events" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-events-47">Event</a> with the given data. The
        method <em class="rfc2119">MUST</em> run the following
        steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Let <var>interaction</var> be the value of [[td]]'s
          <var>events</var>'s <var data-type=
          "string">name</var>.</li>
          <li>If an <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-events-48">Event</a>
          with the name <var data-type="string">name</var> is not
          found, reject <var data-type="Promise">promise</var> with
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notfounderror"><code>NotFoundError</code></a>
          and abort these steps.
          </li>
          <li>Make a request to the underlying platform to emit an
          <a href="#dfn-events" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-events-49">Event</a> with <var data-type=
            "InteractionInput">data</var>.
            <div class="note" role="note" id=
            "issue-container-generatedID-24">
              <div role="heading" class="note-title marker" id=
              "h-note-11" aria-level="4">
                <span>Note</span>
              </div>
              <p class="">This will trigger the <a href=
              "#handling-events">handling events</a> steps.</p>
            </div>
          </li>
        </ol>
      </div>
    </section>
    <section id="the-expose-method">
      <h3 id="x8-30-the-expose-method"><bdi class=
      "secno">8.30</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-exposedthing-expose" data-idl="operation"
      data-title="expose()" data-dfn-for="ExposedThing" data-type=
      "Promise" data-lt="expose()" data-local-lt=
      "ExposedThing.expose|ExposedThing.expose()|expose"><code>expose()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-expose-method"></a></h3>
      <div>
        Start serving external requests for the <a href=
        "#dfn-things" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-things-40">Thing</a>, so that <a href=
        "#dfn-wot-interaction" class="internalDFN" data-link-type=
        "dfn" id="ref-for-dfn-wot-interaction-18">WoT
        Interactions</a> using <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-83">Properties</a>, <a href=
        "#dfn-actions" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-actions-30">Action</a>s and <a href=
        "#dfn-events" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-events-50">Event</a>s will be possible. The
        method <em class="rfc2119">MUST</em> run the following
        steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Run the <a href="#dfn-expand-a-td" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-expand-a-td-3">expand a TD</a> steps on the
          <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> [[td]].
          </li>
          <li>Run the <a href="#dfn-validate-a-td" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-validate-a-td-2">validate a TD</a> on
          [[td]]. If that fails, reject <var data-type=
          "Promise">promise</var> with a <a data-link-type="idl"
          data-type="exception" href=
          "https://heycam.github.io/webidl/#exceptiondef-typeerror">
            <code>TypeError</code></a> and abort these steps.
          </li>
          <li>For each <a href="#dfn-properties" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-properties-84">Property</a> definition in
          [[td]]'s <var>properties</var>, initialize an |<dfn id=
          "dfn-internal-observer-list">internal observer
          list</dfn>| <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> in order to store observe request
            data needed to notify the observers on value changes.
          </li>
          <li>For each <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-events-51">Event</a>
          definition is [[td]]'s <var>events</var>, initialize an
          |<dfn id="dfn-internal-listener-list">internal listener
          list</dfn>| <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> in order to store subscription
            request data needed to notify the <a href="#dfn-events"
            class="internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-events-52">Event</a> listeners.
          </li>
          <li>Set up the <a href="#dfn-wot-interaction" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-wot-interaction-19">WoT Interactions</a>
          based on introspecting [[td]] as explained in
          [<cite><a class="bibref" data-link-type="biblio" href=
          "#bib-wot-td" title=
          "Web of Things Thing Description">WOT-TD</a></cite>] and
          [<cite><a class="bibref" data-link-type="biblio" href=
          "#bib-wot-protocol-bindings" title=
          "Web of Things Binding Templates">WOT-PROTOCOL-BINDINGS</a></cite>].
          Make a request to the underlying platform to initialize
          the <a href="#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-61">Protocol
            Bindings</a> and then start serving external requests
            for <a href="#dfn-wot-interaction" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-wot-interaction-20">WoT Interactions</a>
            (read, write and observe <a href="#dfn-properties"
            class="internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-properties-85">Properties</a>, invoke
            <a href="#dfn-actions" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-actions-31">Action</a>s and manage
            <a href="#dfn-events" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-events-53">Event</a> subscriptions), based
            on the <a href="#dfn-protocol-bindings" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-62">Protocol
            Bindings</a>. Implementations <em class=
            "rfc2119">MAY</em> reject this step for any reason
            (e.g. if they want to enforce further checks and
            constraints on interaction forms).
          </li>
          <li>If there was an error during the request, reject
          <var data-type="Promise">promise</var> with an
          <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-error-objects"><code>Error</code></a>
          object <var>error</var> with <var>error</var>'s
          <var>message</var> set to the error code seen by the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-63">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Otherwise resolve <var data-type=
          "Promise">promise</var> and abort these steps.</li>
        </ol>
      </div>
    </section>
    <section id="the-destroy-method">
      <h3 id="x8-31-the-destroy-method"><bdi class=
      "secno">8.31</bdi> The <dfn data-export="" data-dfn-type=
      "method" id="dom-exposedthing-destroy" data-idl="operation"
      data-title="destroy()" data-dfn-for="ExposedThing" data-type=
      "Promise" data-lt="destroy()" data-local-lt=
      "ExposedThing.destroy|ExposedThing.destroy()|destroy"><code>destroy()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-destroy-method"></a></h3>
      <div>
        Stop serving external requests for the <a href=
        "#dfn-things" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-things-41">Thing</a> and destroy the object.
        Note that eventual unregistering should be done before
        invoking this method. The method <em class=
        "rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var data-type="Promise">promise</var> with a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>
          and abort these steps.
          </li>
          <li>Make a request to the underlying platform to stop
          serving external requests for <a href=
          "#dfn-wot-interaction" class="internalDFN"
            data-link-type="dfn" id=
            "ref-for-dfn-wot-interaction-21">WoT Interactions</a>,
            based on the <a href="#dfn-protocol-bindings" class=
            "internalDFN" data-link-type="dfn" id=
            "ref-for-dfn-protocol-bindings-64">Protocol
            Bindings</a>.
          </li>
          <li>If there was an error during the request, reject
          <var data-type="Promise">promise</var> with an
          <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-error-objects"><code>Error</code></a>
          object <var>error</var> with its <var>message</var> set
          to the error code seen by the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-protocol-bindings-65">Protocol Bindings</a>
          and abort these steps.
          </li>
          <li>Otherwise resolve <var data-type=
          "Promise">promise</var> and abort these steps.</li>
        </ol>
      </div>
    </section>
    <section id="exposedthing-examples">
      <h3 id="x8-32-exposedthing-examples"><bdi class=
      "secno">8.32</bdi> ExposedThing Examples<a class="self-link"
      aria-label="§" href="#exposedthing-examples"></a></h3>
      <p>The next example illustrates how to create an
      <a data-link-type="idl" href="#dom-exposedthing" class=
      "internalDFN" id=
      "ref-for-dom-exposedthing-28"><code><code>ExposedThing</code></code></a>
      based on a partial <a href="#dfn-td-0" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-td-0-15">TD</a> object
      constructed beforehands.</p>
      <div class="example" id=
      "example-6-create-exposedthing-with-a-simple-property">
        <div class="marker">
          <a class="self-link" href=
          "#example-6-create-exposedthing-with-a-simple-property">Example
          <bdi>6</bdi></a><span class="example-title">: Create
          ExposedThing with a simple Property</span>
        </div>
        <pre class="highlight" aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-keyword">try</span> {
  <span class=
"hljs-keyword">let</span> temperaturePropertyDefinition = {
    <span class="hljs-attr">type</span>: <span class=
"hljs-string">"number"</span>,
    <span class="hljs-attr">minimum</span>: <span class=
"hljs-number">-50</span>,
    <span class="hljs-attr">maximum</span>: <span class=
"hljs-number">10000</span>
  };
  <span class="hljs-keyword">let</span> tdFragment = {
    <span class="hljs-attr">properties</span>: {
      <span class=
"hljs-attr">temperature</span>: temperaturePropertyDefinition
    },
    <span class="hljs-attr">actions</span>: {
      <span class="hljs-attr">reset</span>: {
        <span class="hljs-attr">description</span>: <span class=
"hljs-string">"Reset the temperature sensor"</span>,
        <span class="hljs-attr">input</span>: {
          <span class=
"hljs-attr">temperature</span>: temperatureValueDefinition
        },
        <span class="hljs-attr">output</span>: <span class=
"hljs-literal">null</span>,
        <span class="hljs-attr">forms</span>: []
      },
    },
    <span class="hljs-attr">events</span>: {
      <span class=
"hljs-attr">onchange</span>: temperatureValueDefinition
    }
  };
  <span class="hljs-keyword">let</span> thing1 = <span class=
"hljs-keyword">await</span> WOT.produce(tdFragment);
  <span class="hljs-comment">// initialize Properties</span>
  <span class=
"hljs-keyword">await</span> thing1.writeProperty(<span class=
"hljs-string">"temperature"</span>, <span class=
"hljs-number">0</span>);
  <span class="hljs-comment">// add service handlers</span>
  thing1.setPropertyReadHandler(<span class=
"hljs-string">"temperature"</span>, () =&gt; {
     <span class=
"hljs-keyword">return</span> readLocalTemperatureSensor();  <span class="hljs-comment">// Promise</span>
  });
  <span class="hljs-comment">// start serving requests</span>
  <span class="hljs-keyword">await</span> thing1.expose();
} <span class="hljs-keyword">catch</span> (err) {
   <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error creating ExposedThing: "</span> + err);
}</code></pre>
      </div>
      <p>The next example illustrates how to add or modify a
      <a href="#dfn-properties" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-properties-86">Property</a> definition
      on an existing <a data-link-type="idl" href=
      "#dom-exposedthing" class="internalDFN" id=
      "ref-for-dom-exposedthing-29"><code><code>ExposedThing</code></code></a>:
      take its <var>td</var> property, add or modify it, then
      create another <a data-link-type="idl" href=
      "#dom-exposedthing" class="internalDFN" id=
      "ref-for-dom-exposedthing-30"><code><code>ExposedThing</code></code></a>
      with that.</p>
      <div class="example" id="example-7-add-an-object-property">
        <div class="marker">
          <a class="self-link" href=
          "#example-7-add-an-object-property">Example
          <bdi>7</bdi></a><span class="example-title">: Add an
          object Property</span>
        </div>
        <pre class="highlight" aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-keyword">try</span> {
  <span class=
"hljs-comment">// create a deep copy of thing1's TD</span>
  <span class="hljs-keyword">let</span> instance = <span class=
"hljs-built_in">JSON</span>.parse(<span class=
"hljs-built_in">JSON</span>.stringify(thing1.td));
  <span class="hljs-keyword">const</span> statusValueDefinition = {
    <span class="hljs-attr">type</span>: <span class=
"hljs-string">"object"</span>,
    <span class="hljs-attr">properties</span>: {
      <span class="hljs-attr">brightness</span>: {
        <span class="hljs-attr">type</span>: <span class=
"hljs-string">"number"</span>,
        <span class="hljs-attr">minimum</span>: <span class=
"hljs-number">0.0</span>,
        <span class="hljs-attr">maximum</span>: <span class=
"hljs-number">100.0</span>,
        <span class="hljs-attr">required</span>: <span class=
"hljs-literal">true</span>
      },
      <span class="hljs-attr">rgb</span>: {
        <span class="hljs-attr">type</span>: <span class=
"hljs-string">"array"</span>,
        <span class="hljs-string">"minItems"</span>: <span class=
"hljs-number">3</span>,
        <span class="hljs-string">"maxItems"</span>: <span class=
"hljs-number">3</span>,
        <span class="hljs-attr">items</span> : {
            <span class="hljs-string">"type"</span> : <span class=
"hljs-string">"number"</span>,
            <span class=
"hljs-string">"minimum"</span>: <span class="hljs-number">0</span>,
            <span class=
"hljs-string">"maximum"</span>: <span class="hljs-number">255</span>
        }
      }
  };
  instance[<span class="hljs-string">"name"</span>] = <span class=
"hljs-string">"mySensor"</span>;
  instance.properties[<span class=
"hljs-string">"brightness"</span>] = {
    <span class="hljs-attr">type</span>: <span class=
"hljs-string">"number"</span>,
    <span class="hljs-attr">minimum</span>: <span class=
"hljs-number">0.0</span>,
    <span class="hljs-attr">maximum</span>: <span class=
"hljs-number">100.0</span>,
    <span class="hljs-attr">required</span>: <span class=
"hljs-literal">true</span>,
  };
  instance.properties[<span class=
"hljs-string">"status"</span>] = statusValueDefinition;
  instance.actions[<span class=
"hljs-string">"getStatus"</span>] = {
    <span class="hljs-attr">description</span>: <span class=
"hljs-string">"Get status object"</span>,
    <span class="hljs-attr">input</span>: <span class=
"hljs-literal">null</span>,
    <span class="hljs-attr">output</span>: {
      <span class=
"hljs-attr">status</span> : statusValueDefinition;
    },
    <span class="hljs-attr">forms</span>: [...]
  };
  instance.events[<span class=
"hljs-string">"onstatuschange"</span>] = statusValueDefinition;
  instance.forms = [...];  <span class=
"hljs-comment">// update</span>
  <span class="hljs-keyword">var</span> thing2 = <span class=
"hljs-keyword">new</span> ExposedThing(instance);
  <span class="hljs-comment">// <span class=
"hljs-doctag">TODO:</span> add service handlers</span>
  <span class="hljs-keyword">await</span> thing2.expose();
  });
} <span class="hljs-keyword">catch</span> (err) {
   <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error creating ExposedThing: "</span> + err);
}</code></pre>
      </div>
    </section>
  </section>
  <section data-dfn-for="ThingDiscovery" id=
  "the-thingdiscovery-interface">
    <h2 id="x9-the-thingdiscovery-interface"><bdi class=
    "secno">9.</bdi> The <dfn data-export="" data-dfn-type=
    "interface" id="dom-thingdiscovery" data-idl="interface"
    data-title="ThingDiscovery" data-dfn-for=
    ""><code>ThingDiscovery</code></dfn> interface<a class=
    "self-link" aria-label="§" href=
    "#the-thingdiscovery-interface"></a></h2>
    <p>Discovery is a distributed application that requires
    provisioning and support from participating network nodes
    (clients, servers, directory services). This API models the
    client side of typical discovery schemes supported by various
    IoT deployments.</p>
    <p>The <a data-link-type="idl" href="#dom-thingdiscovery"
    class="internalDFN" id=
    "ref-for-dom-thingdiscovery-4"><code><code>ThingDiscovery</code></code></a>
    object is constructed given a filter and provides the
    properties and methods controlling the discovery process.</p>
    <pre class="idl def" id="webidl-989583368"><span class=
    "idlHeader"><a class="self-link" href=
    "#webidl-989583368">WebIDL</a></span><span data-idl="" class=
    "idlInterface" id="idl-def-thingdiscovery" data-title=
    "ThingDiscovery">[<span class="extAttr"><a data-type=
    "extended-attribute" href=
    "https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-type="interface"
href="#dom-thingdiscovery" id=
"ref-for-dom-thingdiscovery-5"><code>ThingDiscovery</code></a> {<span data-idl=""
class="idlConstructor" id=
"idl-def-thingdiscovery-constructor-filter" data-title=
"constructor" data-dfn-for="ThingDiscovery">
  <dfn data-export="" data-dfn-type="constructor" id=
"dom-thingdiscovery-constructor" data-idl="constructor" data-title=
"constructor" data-dfn-for="ThingDiscovery" data-lt=
"constructor()|constructor(, filter)" data-local-lt=
"ThingDiscovery.constructor|ThingDiscovery.constructor()|constructor"><code>constructor</code></dfn>(optional<span class="idlType"> <a href="#dom-thingfilter"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-thingfilter-3"><code>ThingFilter</code></a></span> <span class="idlParamName">filter</span> = null);</span><span data-idl=""
class="idlAttribute" id="idl-def-thingdiscovery-filter" data-title=
"filter" data-dfn-for="ThingDiscovery">
  readonly attribute<span class="idlType"> <a href=
"#dom-thingfilter" class="internalDFN" data-link-type="idl" id=
"ref-for-dom-thingfilter-4"><code>ThingFilter</code></a>?</span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-thingdiscovery-filter" id=
"ref-for-dom-thingdiscovery-filter-1"><code>filter</code></a>;</span><span data-idl=""
class="idlAttribute" id="idl-def-thingdiscovery-active" data-title=
"active" data-dfn-for="ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-thingdiscovery-active" id=
"ref-for-dom-thingdiscovery-active-1"><code>active</code></a>;</span><span data-idl=""
class="idlAttribute" id="idl-def-thingdiscovery-done" data-title=
"done" data-dfn-for="ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-thingdiscovery-done" id=
"ref-for-dom-thingdiscovery-done-1"><code>done</code></a>;</span><span data-idl=""
class="idlAttribute" id="idl-def-thingdiscovery-error" data-title=
"error" data-dfn-for="ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-link-type="dfn"
href=
"https://tc39.es/ecma262/#sec-error-objects">Error</a>?</span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-thingdiscovery-error" id=
"ref-for-dom-thingdiscovery-error-1"><code>error</code></a>;</span><span data-idl=""
class="idlMethod" id="idl-def-thingdiscovery-start" data-title=
"start" data-dfn-for="ThingDiscovery"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a></span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-thingdiscovery-start" id=
"ref-for-dom-thingdiscovery-start-1"><code>start</code></a>();</span><span data-idl=""
class="idlMethod" id="idl-def-thingdiscovery-next" data-title=
"next" data-dfn-for="ThingDiscovery"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-thingdescription"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-thingdescription-14"><code>ThingDescription</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-thingdiscovery-next" id=
"ref-for-dom-thingdiscovery-next-1"><code>next</code></a>();</span><span data-idl=""
class="idlMethod" id="idl-def-thingdiscovery-stop" data-title=
"stop" data-dfn-for="ThingDiscovery"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a></span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-thingdiscovery-stop" id=
"ref-for-dom-thingdiscovery-stop-1"><code>stop</code></a>();</span>
};</span></pre>
    <div class="note" id="issue-container-generatedID-25">
      <div role="heading" class="ednote-title marker" id=
      "h-ednote-12" aria-level="3">
        <span>Editor's note</span>
      </div>
      <p class="">The <a data-link-type="idl" href=
      "#dom-thingdiscovery" class="internalDFN" id=
      "ref-for-dom-thingdiscovery-6"><code><code>ThingDiscovery</code></code></a>
      interface has a <code>next()</code> method and a
      <code>done</code> property, but it is not an <a href=
      "https://tc39.es/proposal-async-iteration/">Iterable</a>.
      Look into <a href=
      "https://github.com/w3c/wot-scripting-api/issues/177">Issue
      177</a> for rationale.</p>
    </div>
    <p>The <dfn id="dfn-discovery-results">discovery results</dfn>
    <a data-link-type="dfn" href=
    "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
    internal slot</a> is an internal queue for temporarily storing
    the found <a data-link-type="idl" href="#dom-thingdescription"
    class="internalDFN" id=
    "ref-for-dom-thingdescription-15"><code><code>ThingDescription</code></code></a>
    objects until they are consumed by the application using the
    <a href="#the-next-method">next()</a> method. Implementations
    <em class="rfc2119">MAY</em> optimize the size of this queue
    based on e.g. the available resources and the frequency of
    invoking the <a href="#the-next-method">next()</a> method.</p>
    <p>The <dfn data-export="" data-dfn-type="attribute" id=
    "dom-thingdiscovery-filter" data-idl="attribute" data-title=
    "filter" data-dfn-for="ThingDiscovery" data-type="ThingFilter"
    data-lt="filter" data-local-lt=
    "ThingDiscovery.filter"><code>filter</code></dfn> property
    represents the discovery filter of type <a href=
    "#dom-thingfilter" class="internalDFN" data-link-type="idl" id=
    "ref-for-dom-thingfilter-5"><code>ThingFilter</code></a>
    specified for the discovery.</p>
    <p>The <dfn data-export="" data-dfn-type="attribute" id=
    "dom-thingdiscovery-active" data-idl="attribute" data-title=
    "active" data-dfn-for="ThingDiscovery" data-type="boolean"
    data-lt="active" data-local-lt=
    "ThingDiscovery.active"><code>active</code></dfn> property is
    <code>true</code> when the discovery is actively ongoing on
    protocol level (i.e. new <a href="#dfn-td-0" class=
    "internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-td-0-16">TD</a>s may still arrive) and
    <code>false</code> otherwise.</p>
    <p>The <dfn data-export="" data-dfn-type="attribute" id=
    "dom-thingdiscovery-done" data-idl="attribute" data-title=
    "done" data-dfn-for="ThingDiscovery" data-type="boolean"
    data-lt="done" data-local-lt=
    "ThingDiscovery.done"><code>done</code></dfn> property is
    <code>true</code> if the discovery has been completed with no
    more results to report and <a href="#dfn-discovery-results"
    class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-discovery-results-1">discovery results</a> is also
    empty.</p>
    <p>The <dfn data-export="" data-dfn-type="attribute" id=
    "dom-thingdiscovery-error" data-idl="attribute" data-title=
    "error" data-dfn-for="ThingDiscovery" data-type="Error"
    data-lt="error" data-local-lt=
    "ThingDiscovery.error"><code>error</code></dfn> property
    represents the last error that occurred during the discovery
    process. Typically used for critical errors that stop
    discovery.</p>
    <section id="constructing-thingdiscovery">
      <h3 id="x9-1-constructing-thingdiscovery"><bdi class=
      "secno">9.1</bdi> Constructing <a data-link-type="idl" href=
      "#dom-thingdiscovery" class="internalDFN" id=
      "ref-for-dom-thingdiscovery-7"><code><code>ThingDiscovery</code></code></a><a class="self-link"
      aria-label="§" href="#constructing-thingdiscovery"></a></h3>
      <div>
        To create <a data-link-type="idl" href=
        "#dom-thingdiscovery" class="internalDFN" id=
        "ref-for-dom-thingdiscovery-8"><code><code>ThingDiscovery</code></code></a>
        with a <var data-type="ThingFilter">filter</var> or type
        <a data-link-type="idl" href="#dom-thingfilter" class=
        "internalDFN" id=
        "ref-for-dom-thingfilter-6"><code><code>ThingFilter</code></code></a>,
        run the following steps:
        <ol>
          <li>If <var data-type="ThingFilter">filter</var> is not
          an object or <code>null</code>, <a data-link-type="dfn"
          data-type="dfn" href=
          "https://heycam.github.io/webidl/#dfn-throw">throw</a> a
          <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#exceptiondef-typeerror">
            <code>TypeError</code></a> and abort these steps.
          </li>
          <li>Let <var data-type="ThingDiscovery">discovery</var>
          be a new <a data-link-type="idl" href=
          "#dom-thingdiscovery" class="internalDFN" id=
          "ref-for-dom-thingdiscovery-9"><code><code>ThingDiscovery</code></code></a>
          object.
          </li>
          <li>Set the <a href="#dom-thingdiscovery-filter" id=
          "ref-for-dom-thingdiscovery-filter-2">filter</a> property
          to <var data-type="ThingFilter">filter</var>.
          </li>
          <li>Set the <a href="#dom-thingdiscovery-active" id=
          "ref-for-dom-thingdiscovery-active-2">active</a> and
          <a href="#dom-thingdiscovery-done" id=
          "ref-for-dom-thingdiscovery-done-2">done</a> properties
          to <code>false</code>. Set the <a href=
          "#dom-thingdiscovery-error" id=
          "ref-for-dom-thingdiscovery-error-2">error</a> property
          to <code>null</code>.
          </li>
          <li>Return <var data-type=
          "ThingDiscovery">discovery</var>.</li>
        </ol>
      </div>
      <p>The <a href="#the-start-method">start()</a> method sets
      <a href="#dom-thingdiscovery-active" id=
      "ref-for-dom-thingdiscovery-active-3">active</a> to
      <code>true</code>. The <a href="the-stop-method">stop()</a>
      method sets the <a href="#dom-thingdiscovery-active" id=
      "ref-for-dom-thingdiscovery-active-4">active</a> property to
      <var>false</var>, but <a href="#dom-thingdiscovery-done" id=
      "ref-for-dom-thingdiscovery-done-3">done</a> may be still
      <code>false</code> if there are <a data-link-type="idl" href=
      "#dom-thingdescription" class="internalDFN" id=
      "ref-for-dom-thingdescription-16"><code><code>ThingDescription</code></code></a>
      objects in the <a href="#dfn-discovery-results" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-discovery-results-2">discovery results</a> not
      yet consumed with <a href="#the-next-method">next()</a>.</p>
      <p>During successive calls of <a href=
      "#the-next-method">next()</a>, the <a href=
      "#dom-thingdiscovery-active" id=
      "ref-for-dom-thingdiscovery-active-5">active</a> property may
      be <code>true</code> or <code>false</code>, but the <a href=
      "#dom-thingdiscovery-done" id=
      "ref-for-dom-thingdiscovery-done-4">done</a> property is set
      to <code>false</code> by <a href=
      "#the-next-method">next()</a> only when both the <a href=
      "#dom-thingdiscovery-active" id=
      "ref-for-dom-thingdiscovery-active-6">active</a> property is
      <code>false</code> and <a href="#dfn-discovery-results"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-discovery-results-3">discovery results</a> is
      empty.</p>
    </section>
    <section data-dfn-for="DiscoveryMethod" id=
    "the-discoverymethod-enumeration">
      <h3 id="x9-2-the-discoverymethod-enumeration"><bdi class=
      "secno">9.2</bdi> The <dfn data-export="" data-dfn-type=
      "typedef" id="dom-discoverymethod" data-idl="typedef"
      data-title="DiscoveryMethod" data-dfn-for=
      ""><code>DiscoveryMethod</code></dfn> enumeration<a class=
      "self-link" aria-label="§" href=
      "#the-discoverymethod-enumeration"></a></h3>
      <pre class="idl def" id="webidl-2108018476"><span class=
      "idlHeader"><a class="self-link" href=
      "#webidl-2108018476">WebIDL</a></span><span data-idl="" class=
      "idlTypedef" id="idl-def-discoverymethod" data-title=
      "DiscoveryMethod">typedef<span class="idlType"> <a data-type=
      "interface" href=
      "https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlID"
data-link-type="typedef" href="#dom-discoverymethod" id=
"ref-for-dom-discoverymethod-1"><code>DiscoveryMethod</code></a>;</span></pre>
      <p>Represents the discovery type to be used:</p>
      <ul>
        <li><dfn id="dfn-any">"any"</dfn> does not provide any
        restriction</li>
        <li>
          <dfn id="dfn-local">"local"</dfn> for discovering
          <a href="#dfn-things" class="internalDFN" data-link-type=
          "dfn" id="ref-for-dfn-things-42">Thing</a>s defined in
          the same device or connected to the device by wired or
          wireless means.
        </li>
        <li>
          <dfn id="dfn-directory">"directory"</dfn> for discovery
          based on a service provided by a <a href=
          "#dfn-thing-directory" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-thing-directory-3">Thing Directory</a>.
        </li>
        <li>
          <dfn id="dfn-multicast">"multicast"</dfn> for discovering
          <a href="#dfn-things" class="internalDFN" data-link-type=
          "dfn" id="ref-for-dfn-things-43">Thing</a>s in the
          device's network by using a supported multicast protocol.
        </li>
      </ul>
    </section>
    <section data-dfn-for="ThingFilter" id=
    "the-thingfilter-dictionary">
      <h3 id="x9-3-the-thingfilter-dictionary"><bdi class=
      "secno">9.3</bdi> The <dfn data-export="" data-dfn-type=
      "dictionary" id="dom-thingfilter" data-idl="dictionary"
      data-title="ThingFilter" data-dfn-for=
      ""><code>ThingFilter</code></dfn> dictionary<a class=
      "self-link" aria-label="§" href=
      "#the-thingfilter-dictionary"></a></h3>
      <p>Represents an object containing the constraints for
      discovering <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-things-44">Thing</a>s as
      key-value pairs.</p>
      <pre class="idl def" id="webidl-1705581706"><span class=
      "idlHeader"><a class="self-link" href=
      "#webidl-1705581706">WebIDL</a></span><span data-idl="" class=
      "idlDictionary" id="idl-def-thingfilter" data-title=
      "ThingFilter">dictionary <a class="internalDFN idlID"
      data-link-type="dictionary" href="#dom-thingfilter" id=
      "ref-for-dom-thingfilter-7"><code>ThingFilter</code></a> {<span data-idl=""
class="idlMember" id="idl-def-thingfilter-method" data-title=
"method" data-dfn-for="ThingFilter"><span class="idlType">
  (<a href="#dom-discoverymethod" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-discoverymethod-2"><code>DiscoveryMethod</code></a> or <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>)</span> <a class="internalDFN idlName"
data-link-type="dict-member" href="#dom-thingfilter-method" id=
"ref-for-dom-thingfilter-method-1"><code>method</code></a> = "any";</span><span data-idl=""
class="idlMember" id="idl-def-thingfilter-url" data-title="url"
data-dfn-for="ThingFilter"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <a class="internalDFN idlName"
data-link-type="dict-member" href="#dom-thingfilter-url" id=
"ref-for-dom-thingfilter-url-1"><code>url</code></a>;</span><span data-idl=""
class="idlMember" id="idl-def-thingfilter-query" data-title="query"
data-dfn-for="ThingFilter"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <a class="internalDFN idlName"
data-link-type="dict-member" href="#dom-thingfilter-query" id=
"ref-for-dom-thingfilter-query-1"><code>query</code></a>;</span><span data-idl=""
class="idlMember" id="idl-def-thingfilter-fragment" data-title=
"fragment" data-dfn-for="ThingFilter"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a>?</span> <a class="internalDFN idlName"
data-link-type="dict-member" href="#dom-thingfilter-fragment" id=
"ref-for-dom-thingfilter-fragment-1"><code>fragment</code></a>;</span>
};</span></pre>
      <p>The <dfn data-export="" data-dfn-type="dict-member" id=
      "dom-thingfilter-method" data-idl="field" data-title="method"
      data-dfn-for="ThingFilter" data-type=
      "DiscoveryMethod|DOMString"><code>method</code></dfn>
      property represents the discovery type that should be used in
      the discovery process. The possible values are defined by the
      <a href=
      "#the-discoverymethod-enumeration">DiscoveryMethod</a>
      enumeration that <em class="rfc2119">MAY</em> be extended by
      string values defined by solutions (with no guarantee of
      interoperability).</p>
      <p>The <dfn data-export="" data-dfn-type="dict-member" id=
      "dom-thingfilter-url" data-idl="field" data-title="url"
      data-dfn-for="ThingFilter" data-type=
      "USVString"><code>url</code></dfn> property represents
      additional information for the discovery method, such as the
      URL of the target entity serving the discovery request, for
      instance the URL of a <a href="#dfn-thing-directory" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-thing-directory-4">Thing Directory</a> (if
      <a href="#dom-thingfilter-method" id=
      "ref-for-dom-thingfilter-method-2">method</a> is
      <code>"directory"</code>), or otherwise the URL of a directly
      targeted <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-things-45">Thing</a>.</p>
      <p>The <dfn data-export="" data-dfn-type="dict-member" id=
      "dom-thingfilter-query" data-idl="field" data-title="query"
      data-dfn-for="ThingFilter" data-type=
      "USVString"><code>query</code></dfn> property represents a
      query string accepted by the implementation, for instance a
      SPARQL or JSON query. Support may be implemented locally in
      the <a href="#dfn-wot-runtime" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-wot-runtime-4">WoT
      Runtime</a> or remotely as a service in a <a href=
      "#dfn-thing-directory" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-thing-directory-5">Thing
      Directory</a>.</p>
      <p>The <dfn data-export="" data-dfn-type="dict-member" id=
      "dom-thingfilter-fragment" data-idl="field" data-title=
      "fragment" data-dfn-for="ThingFilter" data-type=
      "object"><code>fragment</code></dfn> property represents a
      template object used for matching property by property
      against discovered <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-things-46">Thing</a>s.</p>
    </section>
    <section id="the-start-method">
      <h3 id="x9-4-the-start-method"><bdi class="secno">9.4</bdi>
      The <dfn data-export="" data-dfn-type="method" id=
      "dom-thingdiscovery-start" data-idl="operation" data-title=
      "start()" data-dfn-for="ThingDiscovery" data-type="undefined"
      data-lt="start()" data-local-lt=
      "ThingDiscovery.start|ThingDiscovery.start()|start"><code>start()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-start-method"></a></h3>
      <div>
        Starts the discovery process. The method <em class=
        "rfc2119">MUST</em> run the following steps:
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, set the
          <a href="#dom-thingdiscovery-error" id=
          "ref-for-dom-thingdiscovery-error-3">error</a> property
          to a <a data-link-type="idl" data-type="exception"
            href="https://heycam.github.io/webidl/#securityerror"><code>
            SecurityError</code></a> and abort these steps.
          </li>
          <li>If discovery is not supported by the implementation,
          set the <a href="#dom-thingdiscovery-error" id=
          "ref-for-dom-thingdiscovery-error-4">error</a> property
          to <a data-link-type="idl" data-type="exception" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> and abort these steps.
          </li>
          <li>Let <var>filter</var> denote the <a href=
          "#dom-thingdiscovery-filter" id=
          "ref-for-dom-thingdiscovery-filter-3">filter</a>
          property.
          </li>
          <li>If the <var>filter</var> is defined,
            <ul>
              <li>If <var>filter</var>'s <a href=
              "#dom-thingfilter-query" id=
              "ref-for-dom-thingfilter-query-2"><var>query</var></a>
              is defined, pass it as an opaque string to the
              underlying implementation to be matched against
              discovered items. The underlying implementation is
              responsible to parse it e.g. as a SPARQL or JSON
              query and match it against the <a href=
              "#dfn-thing-descriptions" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-thing-descriptions-28">Thing
              Description</a>s found during the discovery process.
              If queries are not supported, set |this.error| to
              <a data-link-type="idl" data-type="exception" href=
              "https://heycam.github.io/webidl/#notsupportederror">
                <code>NotSupportedError</code></a> and abort these
                steps.
              </li>
            </ul>
          </li>
          <li>Create the <a href="#dfn-discovery-results" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-discovery-results-4">discovery results</a>
          <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> for storing discovered
            <a data-link-type="idl" href="#dom-thingdescription"
            class="internalDFN" id=
            "ref-for-dom-thingdescription-17"><code><code>ThingDescription</code></code></a>
            objects.
          </li>
          <li>Request the underlying platform to start the
          discovery process, with the following parameters:
            <ul>
              <li>If |filter|s <a href="#dom-thingfilter-method"
                id="ref-for-dom-thingfilter-method-3"><var>method</var></a>
                is not defined or the value is <code>"any"</code>,
                use the widest discovery method supported by the
                underlying platform.
              </li>
              <li>Otherwise if |filter|s <a href=
              "#dom-thingfilter-method" id=
              "ref-for-dom-thingfilter-method-4"><var>method</var></a>
              is <code>"local"</code>, use the local <a href=
              "#dfn-thing-directory" class="internalDFN"
              data-link-type="dfn" id=
              "ref-for-dfn-thing-directory-6">Thing Directory</a>
              for discovery. Usually that defines <a href=
              "#dfn-things" class="internalDFN" data-link-type=
              "dfn" id="ref-for-dfn-things-47">Thing</a>s deployed
              in the same device, or connected to the device in
              slave mode (e.g. sensors connected via Bluetooth or a
              serial connection).
              </li>
              <li>Otherwise if |filter|s <a href=
              "#dom-thingfilter-method" id=
              "ref-for-dom-thingfilter-method-5"><var>method</var></a>
              is <code>"directory"</code>, use the remote
                <a href="#dfn-thing-directory" class="internalDFN"
                data-link-type="dfn" id=
                "ref-for-dfn-thing-directory-7">Thing Directory</a>
                specified in |filter.url|.
              </li>
              <li>Otherwise if |filter|s <a href=
              "#dom-thingfilter-method" id=
              "ref-for-dom-thingfilter-method-6"><var>method</var></a>
              is <code>"multicast"</code>, use all the multicast
              discovery protocols supported by the underlying
              platform.
              </li>
            </ul>
          </li>
          <li>When the underlying platform has started the
          discovery process, set the <a href=
          "#dom-thingdiscovery-active" id=
          "ref-for-dom-thingdiscovery-active-7">active</a> property
          to <code>true</code>.
          </li>
          <li>Whenever a new <a href="#dfn-thing-descriptions"
          class="internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-thing-descriptions-29">Thing Description</a>
          <var data-type="ThingDescription">td</var> is discovered
          by the underlying platform, run the following sub-steps:
            <ol>
              <li>
                <a href=
                "https://fetch.spec.whatwg.org/#fetch-api">Fetch</a>
                <var data-type="ThingDescription">td</var> as a
                JSON object <var>json</var>. If that fails, set the
                <a href="#dom-thingdiscovery-error" id=
                "ref-for-dom-thingdiscovery-error-5">error</a>
                property to <a data-link-type="idl" data-type=
                "exception" href=
                "https://heycam.github.io/webidl/#syntaxerror"><code>
                SyntaxError</code></a>, discard <var data-type=
                "ThingDescription">td</var> and continue the
                discovery process.
              </li>
              <li>If <var>filter</var>'s <a href=
              "#dom-thingfilter-query" id=
              "ref-for-dom-thingfilter-query-3"><var>query</var></a>
              is defined, check if <var>json</var> is a match for
              the query. The matching algorithm is encapsulated by
              implementations. If that returns <code>false</code>,
              discard <var data-type="ThingDescription">td</var>
              and continue the discovery process.
              </li>
              <li>If <var>filter</var>'s <a href=
              "#dom-thingfilter-fragment" id=
              "ref-for-dom-thingfilter-fragment-2"><var>fragment</var></a>
              is defined, for each property defined in it, check if
              that property exists in <var>json</var>'s properties
              and has the same value. If this is <code>false</code>
              in any checks, discard <var data-type=
              "ThingDescription">td</var> and continue the
              discovery process.
              </li>
              <li>Otherwise add <var data-type="ThingDescription">
                td</var> to the <a href="#dfn-discovery-results"
                class="internalDFN" data-link-type="dfn" id=
                "ref-for-dfn-discovery-results-5">discovery
                results</a>.
              </li>
              <li>At this point implementations <em class=
              "rfc2119">MAY</em> control the flow of the discovery
              process (depending on memory constraints, for
              instance temporarily stop discovery if the queue is
              getting too large, or resume discovery when the queue
              is emptied sufficiently).</li>
            </ol>
          </li>
          <li>Whenever an error occurs during the discovery
          process,
            <ol>
              <li>Let <var>error</var> be a new
                <a data-link-type="idl" href=
                "https://tc39.es/ecma262/#sec-error-objects"><code>Error</code></a>
                object. Set <var>error</var>'s <var>name</var> to
                <code>"DiscoveryError"</code>.
              </li>
              <li>If there was an error code or message provided by
              the <a href="#dfn-protocol-bindings" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-protocol-bindings-66">Protocol
              Bindings</a>, set <var>error</var>'s
              <var>message</var> to that value as string.
              </li>
              <li>Set <a href="#dom-thingdiscovery-error" id=
              "ref-for-dom-thingdiscovery-error-6">error</a>
              property to <var>error</var>.
              </li>
              <li>If the error is irrecoverable and discovery has
              been stopped by the underlying platform, set the
              <a href="#dom-thingdiscovery-active" id=
              "ref-for-dom-thingdiscovery-active-8">active</a>
              property to <code>false</code>.
              </li>
            </ol>
          </li>
          <li>When the underlying platform reports the discovery
          process has completed, set the <a href=
          "#dom-thingdiscovery-active" id=
          "ref-for-dom-thingdiscovery-active-9">active</a> property
          to <code>false</code>.
          </li>
        </ol>
      </div>
    </section>
    <section id="the-next-method">
      <h3 id="x9-5-the-next-method"><bdi class="secno">9.5</bdi>
      The <dfn data-export="" data-dfn-type="method" id=
      "dom-thingdiscovery-next" data-idl="operation" data-title=
      "next()" data-dfn-for="ThingDiscovery" data-type="Promise"
      data-lt="next()" data-local-lt=
      "ThingDiscovery.next|ThingDiscovery.next()|next"><code>next()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-next-method"></a></h3>
      <div>
        Provides the next discovered <a data-link-type="idl" href=
        "#dom-thingdescription" class="internalDFN" id=
        "ref-for-dom-thingdescription-18"><code><code>ThingDescription</code></code></a>
        object. The method <em class="rfc2119">MUST</em> run the
        following steps:
        <ol>
          <li>Return a <a data-link-type="idl" href=
          "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a>
          <var data-type="Promise">promise</var> and execute the
          next steps <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If the <a href="#dom-thingdiscovery-active" id=
          "ref-for-dom-thingdiscovery-active-10">active</a>
          property is <code>true</code>, wait until the <a href=
          "#dfn-discovery-results" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-discovery-results-6">discovery results</a>
          <a data-link-type="dfn" href=
          "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
            internal slot</a> is not empty.
          </li>
          <li>If <a href="#dfn-discovery-results" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-discovery-results-7">discovery results</a>
          is empty and the <a href="#dom-thingdiscovery-active"
            id="ref-for-dom-thingdiscovery-active-11">active</a>
            property is <code>false</code>, set the <a href=
            "#dom-thingdiscovery-done" id=
            "ref-for-dom-thingdiscovery-done-5">done</a> property
            to <code>true</code> and reject <var data-type=
            "Promise">promise</var>.
          </li>
          <li>Remove the first <a data-link-type="idl" href=
          "#dom-thingdescription" class="internalDFN" id=
          "ref-for-dom-thingdescription-19"><code><code>ThingDescription</code></code></a>
          object <var>td</var> from <a href=
          "#dfn-discovery-results" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-discovery-results-8">discovery results</a>.
          </li>
          <li>Resolve <var data-type="Promise">promise</var> with
          <var>td</var> and abort these steps.</li>
        </ol>
      </div>
    </section>
    <section id="the-stop-method-0">
      <h3 id="x9-6-the-stop-method"><bdi class="secno">9.6</bdi>
      The <dfn data-export="" data-dfn-type="method" id=
      "dom-thingdiscovery-stop" data-idl="operation" data-title=
      "stop()" data-dfn-for="ThingDiscovery" data-type="undefined"
      data-lt="stop()" data-local-lt=
      "ThingDiscovery.stop|ThingDiscovery.stop()|stop"><code>stop()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-stop-method-0"></a></h3>
      <div>
        Stops or suppresses the discovery process. It might not be
        supported by all discovery methods and endpoints, however,
        any further discovery results or errors will be discarded
        and the discovery is marked inactive. The method <em class=
        "rfc2119">MUST</em> run the following steps:
        <ol>
          <li>Request the underlying platform to stop the discovery
          process. If this returns an error, or if it is not
          possible, for instance when discovery is based on open
          ended multicast requests, the implementation <em class=
          "rfc2119">SHOULD</em> discard subsequent discovered
          items.</li>
          <li>Set the <a href="#dom-thingdiscovery-active" id=
          "ref-for-dom-thingdiscovery-active-12">active</a>
          property to <code>false</code>.
          </li>
        </ol>
      </div>
    </section>
    <section id="discovery-examples">
      <h3 id="x9-7-discovery-examples"><bdi class="secno">9.7</bdi>
      Discovery Examples<a class="self-link" aria-label="§" href=
      "#discovery-examples"></a></h3>
      <p>The following example finds <a data-link-type="idl" href=
      "#dom-thingdescription" class="internalDFN" id=
      "ref-for-dom-thingdescription-20"><code><code>ThingDescription</code></code></a>
      objects of <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-things-48">Thing</a>s
      that are exposed by local hardware, regardless how many
      instances of <a href="#dfn-wot-runtime" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-wot-runtime-5">WoT
      Runtime</a> it is running. Note that the discovery can end
      (become inactive) before the internal <a href=
      "#dfn-discovery-results" class="internalDFN" data-link-type=
      "dfn" id="ref-for-dfn-discovery-results-9">discovery
      results</a> queue is emptied, so we need to continue reading
      <a data-link-type="idl" href="#dom-thingdescription" class=
      "internalDFN" id=
      "ref-for-dom-thingdescription-21"><code><code>ThingDescription</code></code></a>
      objects until done. This is typical with local and directory
      type discoveries.</p>
      <div class="example" id=
      "example-8-discover-things-exposed-by-local-hardware">
        <div class="marker">
          <a class="self-link" href=
          "#example-8-discover-things-exposed-by-local-hardware">Example
          <bdi>8</bdi></a><span class="example-title">: Discover
          Things exposed by local hardware</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class=
        "hljs-keyword">let</span> discovery = <span class=
        "hljs-keyword">new</span> ThingDiscovery({ <span class=
        "hljs-attr">method</span>: <span class=
        "hljs-string">"local"</span> });
<span class="hljs-keyword">do</span> {
  <span class="hljs-keyword">let</span> td = <span class=
"hljs-keyword">await</span> discovery.next();
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Found Thing Description for "</span> + td.title);
  <span class="hljs-keyword">let</span> thing = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing name: "</span> + thing.getThingDescription().title);
} <span class=
"hljs-keyword">while</span> (!discovery.done);</code></pre>
      </div>
      <p>The next example finds <a data-link-type="idl" href=
      "#dom-thingdescription" class="internalDFN" id=
      "ref-for-dom-thingdescription-22"><code><code>ThingDescription</code></code></a>
      objects of <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-things-49">Thing</a>s
      listed in a <a href="#dfn-thing-directory" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-thing-directory-8">Thing Directory</a> service.
      We set a timeout for safety.</p>
      <div class="example" id=
      "example-9-discover-things-via-directory">
        <div class="marker">
          <a class="self-link" href=
          "#example-9-discover-things-via-directory">Example
          <bdi>9</bdi></a><span class="example-title">: Discover
          Things via directory</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class=
        "hljs-keyword">let</span> discoveryFilter = {
  <span class="hljs-attr">method</span>: <span class=
"hljs-string">"directory"</span>,
  <span class="hljs-attr">url</span>: <span class=
"hljs-string">"http://directory.wotservice.org"</span>
};
<span class="hljs-keyword">let</span> discovery = <span class=
"hljs-keyword">new</span> ThingDiscovery(discoveryFilter);
setTimeout( <span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
    discovery.stop();
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery stopped after timeout."</span>);
  },
  <span class="hljs-number">3000</span>);
<span class="hljs-keyword">do</span> {
  <span class="hljs-keyword">let</span> td = <span class=
"hljs-keyword">await</span> discovery.next();
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Found Thing Description for "</span> + td.title);
  <span class="hljs-keyword">let</span> thing = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing name: "</span> + thing.getThingDescription().title);
} <span class="hljs-keyword">while</span> (!discovery.done);
<span class="hljs-keyword">if</span> (discovery.error) {
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery stopped because of an error: "</span> + error.message);
}</code></pre>
      </div>
      <p>The next example is for an open-ended multicast discovery,
      which likely won't complete soon (depending on the underlying
      protocol), so stopping it with a timeout is a good idea. It
      will likely deliver results one by one.</p>
      <div class="example" id=
      "example-10-discover-things-in-a-network">
        <div class="marker">
          <a class="self-link" href=
          "#example-10-discover-things-in-a-network">Example
          <bdi>10</bdi></a><span class="example-title">: Discover
          Things in a network</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class=
        "hljs-keyword">let</span> discovery = <span class=
        "hljs-keyword">new</span> ThingDiscovery({ <span class=
        "hljs-attr">method</span>: <span class=
        "hljs-string">"multicast"</span> });
setTimeout( <span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
    discovery.stop();
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Stopped open-ended discovery"</span>);
  },
  <span class="hljs-number">10000</span>);
<span class="hljs-keyword">do</span> {
  <span class="hljs-keyword">let</span> td = <span class=
"hljs-keyword">await</span> discovery.next();
  <span class="hljs-keyword">let</span> thing = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing name: "</span> + thing.getThingDescription().title);
} <span class=
"hljs-keyword">while</span> (!discovery.done);</code></pre>
      </div>
    </section>
  </section>
  <section id="security-and-privacy">
    <h2 id="security"><bdi class="secno">10.</bdi> Security and
    Privacy<a class="self-link" aria-label="§" href=
    "#security"></a></h2>
    <p>A detailed discussion of security and privacy considerations
    for the Web of Things, including a threat model that can be
    adapted to various circumstances, is presented in the
    informative document [<cite><a class="bibref" data-link-type=
    "biblio" href="#bib-wot-security" title=
    "Web of Things Security and Privacy Guidelines">WOT-SECURITY</a></cite>].
    This section discusses only security and privacy risks and
    possible mitigations directly relevant to the scripts and WoT
    Scripting API.</p>
    <p>A suggested set of best practices to improve security for
    WoT devices and services has been documented in
    [<cite><a class="bibref" data-link-type="biblio" href=
    "#bib-wot-security" title=
    "Web of Things Security and Privacy Guidelines">WOT-SECURITY</a></cite>].
    That document may be updated as security measures evolve.
    Following these practices does not guarantee security, but it
    might help avoid common known vulnerabilities.</p>
    <div>
      The WoT security risks and possible mitigations are
      concerning the following groups:
      <ul>
        <li>Implementors of WoT Runtimes that do not implement a
        Scripting Runtime. The [<cite><a class="bibref"
        data-link-type="biblio" href="#bib-wot-architecture" title=
        "Web of Things Architecture">WOT-ARCHITECTURE</a></cite>]
        document provides generic security guidelines for this
        group.</li>
        <li>Implementors of the WoT Scripting API in a WoT
        Scripting Runtime. This is the main scope and is covered in
        the <a href="#sec-security-consideration-runtime">Scripting
        Runtime Security and Privacy Risks</a> sub-section that
        contains normative text regarding security.
        </li>
        <li>WoT script developers, covered in the <a href=
        "#sec-security-consideration-script">Script Security and
        Privacy Risks</a> sub-section that contains informative
        recommendations concerning security.
        </li>
      </ul>
    </div>
    <section id="sec-security-consideration-runtime">
      <h3 id="x10-1-scripting-runtime-security-and-privacy-risks">
      <bdi class="secno">10.1</bdi> Scripting Runtime Security and
      Privacy Risks<a class="self-link" aria-label="§" href=
      "#sec-security-consideration-runtime"></a></h3>
      <p>This section is normative and contains specific risks
      relevant for the WoT Scripting Runtime.</p>
      <section id="sec-security-consideration-input">
        <h4 id="x10-1-1-corrupted-input-security-and-privacy-risk">
        <bdi class="secno">10.1.1</bdi> Corrupted Input Security
        and Privacy Risk<a class="self-link" aria-label="§" href=
        "#sec-security-consideration-input"></a></h4>
        <p>A typical way to compromise any process is to send it a
        corrupted input via one of the exposed interfaces. This can
        be done to a script instance using WoT interface it
        exposes.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>
            Implementors of this API <em class=
            "rfc2119">SHOULD</em> perform validation on all script
            inputs. In addition to input validation, <a href=
            "https://en.wikipedia.org/wiki/Fuzzing">fuzzing</a>
            should be used to verify that the input processing is
            done correctly. There are many tools and techniques in
            existence to do such validation. More details can be
            found in [<cite><a class="bibref" data-link-type=
            "biblio" href="#bib-wot-security" title=
            "Web of Things Security and Privacy Guidelines">WOT-SECURITY</a></cite>].
          </dd>
        </dl>
      </section>
      <section id=
      "sec-security-consideration-device-direct-access">
        <h4 id=
        "x10-1-2-physical-device-direct-access-security-and-privacy-risk">
        <bdi class="secno">10.1.2</bdi> Physical Device Direct
        Access Security and Privacy Risk<a class="self-link"
        aria-label="§" href=
        "#sec-security-consideration-device-direct-access"></a></h4>
        <p>In case a script is compromised or misbehaving, the
        underlying physical device (and potentially surrounded
        environment) can be damaged if a script can use directly
        exposed native device interfaces. If such interfaces lack
        safety checks on their inputs, they might bring the
        underlying physical device (or environment) to an unsafe
        state (i.e. device overheats and explodes).</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>The WoT Scripting Runtime <em class=
          "rfc2119">SHOULD</em> avoid directly exposing the native
          device interfaces to the script developers. Instead, a
          WoT Scripting Runtime should provide a hardware
          abstraction layer for accessing the native device
          interfaces. Such hardware abstraction layer should refuse
          to execute commands that might put the device (or
          environment) to an unsafe state. Additionally, in order
          to reduce the damage to a physical WoT device in cases a
          script gets compromised, it is important to minimize the
          number of interfaces that are exposed or accessible to a
          particular script based on its functionality.</dd>
        </dl>
      </section>
      <section id="sec-security-consideration-update-provisioning">
        <h4 id="x10-1-3-provisioning-and-update-security-risk">
        <bdi class="secno">10.1.3</bdi> Provisioning and Update
        Security Risk<a class="self-link" aria-label="§" href=
        "#sec-security-consideration-update-provisioning"></a></h4>
        <p>If the WoT Scripting Runtime supports post-manufacturing
        provisioning or updates of scripts, WoT Scripting Runtime
        or any related data (including security credentials), it
        can be a major attack vector. An attacker can try to modify
        any above described element during the update or
        provisioning process or simply provision attacker's code
        and data directly.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>Post-manufacturing provisioning or update of scripts,
          WoT Scripting Runtime or any related data should be done
          in a secure fashion. A set of recommendations for secure
          update and post-manufacturing provisioning can be found
          in [<cite><a class="bibref" data-link-type="biblio" href=
          "#bib-wot-security" title=
          "Web of Things Security and Privacy Guidelines">WOT-SECURITY</a></cite>].</dd>
        </dl>
      </section>
      <section id="sec-security-consideration-credentials-storage">
        <h4 id=
        "x10-1-4-security-credentials-storage-security-and-privacy-risk">
        <bdi class="secno">10.1.4</bdi> Security Credentials
        Storage Security and Privacy Risk<a class="self-link"
        aria-label="§" href=
        "#sec-security-consideration-credentials-storage"></a></h4>
        <p>Typically the WoT Scripting Runtime needs to store the
        security credentials that are provisioned to a WoT device
        to operate in WoT network. If an attacker can compromise
        the confidentiality or integrity of these credentials, then
        it can obtain access to the WoT assets, impersonate WoT
        things or devices or create Denial-Of-Service (DoS)
        attacks.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>The WoT Scripting Runtime should securely store the
          provisioned security credentials, guaranteeing their
          integrity and confidentiality. In case there are more
          than one tenant on a single WoT-enabled device, a WoT
          Scripting Runtime should guarantee isolation of each
          tenant provisioned security credentials. Additionally, in
          order to minimize a risk that provisioned security
          credentials get compromised, the WoT Scripting Runtime
          should not expose any API for scripts to query the
          provisioned security credentials.</dd>
        </dl>
      </section>
    </section>
    <section id="sec-security-consideration-script" class=
    "informative">
      <h3 id="x10-2-script-security-and-privacy-risks"><bdi class=
      "secno">10.2</bdi> Script Security and Privacy Risks<a class=
      "self-link" aria-label="§" href=
      "#sec-security-consideration-script"></a></h3>
      <p><em>This section is non-normative.</em></p>
      <p>This section describes specific risks relevant for script
      developers.</p>
      <section id="sec-security-consideration-script-input">
        <h4 id=
        "x10-2-1-corrupted-script-input-security-and-privacy-risk">
        <bdi class="secno">10.2.1</bdi> Corrupted Script Input
        Security and Privacy Risk<a class="self-link" aria-label=
        "§" href=
        "#sec-security-consideration-script-input"></a></h4>
        <p>A script instance may receive data formats defined by
        the TD, or data formats defined by the applications. While
        the WoT Scripting Runtime <em class="rfc2119">SHOULD</em>
        perform validation on all input fields defined by the TD,
        scripts may be still exploited by input data.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>
            Script developers should perform validation on all
            application defined script inputs. In addition to input
            validation, <a href=
            "https://en.wikipedia.org/wiki/Fuzzing">fuzzing</a>
            could be used to verify that the input processing is
            done correctly. There are many tools and techniques in
            existence to do such validation. More details can be
            found in [<cite><a class="bibref" data-link-type=
            "biblio" href="#bib-wot-security" title=
            "Web of Things Security and Privacy Guidelines">WOT-SECURITY</a></cite>].
          </dd>
        </dl>
      </section>
      <section id="sec-security-consideration-script-processing">
        <h4 id="x10-2-2-denial-of-service-security-risk">
        <bdi class="secno">10.2.2</bdi> Denial Of Service Security
        Risk<a class="self-link" aria-label="§" href=
        "#sec-security-consideration-script-processing"></a></h4>
        <p>If a script performs a heavy functional processing on
        received requests before the request is authenticated, it
        presents a great risk for Denial-Of-Service (DOS)
        attacks.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>Scripts should avoid heavy functional processing
          without prior successful authentication of requestor. The
          set of recommended authentication mechanisms can be found
          in [<cite><a class="bibref" data-link-type="biblio" href=
          "#bib-wot-security" title=
          "Web of Things Security and Privacy Guidelines">WOT-SECURITY</a></cite>].</dd>
        </dl>
      </section>
    </section>
  </section>
  <section id="terminology-and-conventions">
    <h2 id="x11-terminology-and-conventions"><bdi class=
    "secno">11.</bdi> Terminology and conventions<a class=
    "self-link" aria-label="§" href=
    "#terminology-and-conventions"></a></h2>
    <p>The generic WoT terminology is defined in [<cite><a class=
    "bibref" data-link-type="biblio" href="#bib-wot-architecture"
    title=
    "Web of Things Architecture">WOT-ARCHITECTURE</a></cite>]:
    <dfn data-lt="Things|Thing" id="dfn-things">Thing</dfn>,
    <dfn data-lt="Thing Descriptions|Thing Description"
    data-plurals="thing descriptions" id=
    "dfn-thing-descriptions">Thing Description</dfn> (in short
    <dfn id="dfn-td-0">TD</dfn>), <dfn id="dfn-web-of-things">Web
    of Things</dfn> (in short <b><i>WoT</i></b>), <dfn id=
    "dfn-wot-interface">WoT Interface</dfn>, <dfn id=
    "dfn-protocol-bindings">Protocol Bindings</dfn>, <dfn id=
    "dfn-wot-runtime">WoT Runtime</dfn>, <dfn data-lt=
    "consume|consume a TD|consuming a TD|Consuming a Thing Description"
    id="dfn-consume">Consuming a Thing Description</dfn>, <dfn id=
    "dfn-thing-directory">Thing Directory</dfn>, <dfn data-lt=
    "Properties|Property" data-plurals="properties" id=
    "dfn-properties">Property</dfn>, <dfn data-lt="Actions|Action"
    data-plurals="actions" id="dfn-actions">Action</dfn>,
    <dfn data-lt="Events|WoT-Event|Event" data-plurals="events" id=
    "dfn-events">Event</dfn>, <a href=
    "https://www.w3.org/TR/wot-thing-description/#dataschema"><dfn id="dfn-dataschema">
    DataSchema</dfn></a>, <a href=
    "https://www.w3.org/TR/wot-thing-description/#form"><dfn id=
    "dfn-form">Form</dfn></a> etc.</p>
    <p><dfn data-plurals="WoT Interactions|wot interactions" id=
    "dfn-wot-interaction">WoT Interaction</dfn> is a synonym for
    <a href=
    "https://w3c.github.io/wot-architecture/#dfn-interaction-affordance">
    <dfn id="dfn-interaction-affordance">Interaction
    Affordance</dfn></a>. An <a href="#dfn-interaction-affordance"
    class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-interaction-affordance-1">Interaction
    Affordance</a> (or shortly, affordance) is the term used in
    [<cite><a class="bibref" data-link-type="biblio" href=
    "#bib-wot-td" title=
    "Web of Things Thing Description">WOT-TD</a></cite>] when
    referring to <a href="#dfn-things" class="internalDFN"
    data-link-type="dfn" id="ref-for-dfn-things-50">Thing</a>
    capabilities, as explained in <a href=
    "https://github.com/w3c/wot-thing-description/issues/282">TD
    issue 282</a>. However, this term is not well understood
    outside the <a href="#dfn-td-0" class="internalDFN"
    data-link-type="dfn" id="ref-for-dfn-td-0-17">TD</a> semantic
    context. Hence for the sake of readability, this document will
    use the previous term <a href="#dfn-wot-interaction" class=
    "internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-wot-interaction-22">WoT interaction</a> or,
    simply, <em>interaction</em> instead.</p>
    <p><dfn id="dfn-wot-network-interface">WoT network
    interface</dfn> synonym for <a href="#dfn-wot-interface" class=
    "internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-wot-interface-5">WoT Interface</a></p>
    <p><dfn id="dfn-json-ld">JSON-LD</dfn> is defined in
    [<cite><a class="bibref" data-link-type="biblio" href=
    "#bib-json-ld" title="JSON-LD 1.0">JSON-LD</a></cite>] as a
    JSON document that is augmented with support for Linked
    Data.</p>
    <p><dfn id="dfn-json-schema">JSON Schema</dfn> is defined in
    <a href="https://json-schema.org/specification.html">these
    specifications</a>.</p>
    <p>The terms <dfn id="dfn-url" data-no-export=""><a href=
    "https://url.spec.whatwg.org/#concept-url">URL</a></dfn>,
    <dfn id="dfn-url-scheme" data-no-export=""><a href=
    "https://url.spec.whatwg.org/#concept-url-scheme">URL
    scheme</a></dfn>, <dfn id="dfn-url-host" data-no-export=
    ""><a href="https://url.spec.whatwg.org/#concept-url-host">URL
    host</a></dfn>, <dfn id="dfn-url-path" data-no-export=
    ""><a href="https://url.spec.whatwg.org/#concept-url-path">URL
    path</a></dfn>, <dfn id="dfn-url-record" data-no-export=
    ""><a href="https://url.spec.whatwg.org/#concept-url">URL
    record</a></dfn>, <dfn id="dfn-parse-a-url" data-no-export=
    ""><a href="https://url.spec.whatwg.org/#parse-a-url">parse a
    URL</a></dfn>, <dfn id="dfn-absolute-url-string"
    data-no-export=""><a href=
    "https://url.spec.whatwg.org/#absolute-url-string">absolute-URL
    string</a></dfn>, <dfn id="dfn-path-absolute-url-string"
    data-no-export=""><a href=
    "https://url.spec.whatwg.org/#path-absolute-url-string">path-absolute-URL
    string</a></dfn>, <dfn id="dfn-basic-url-parser"
    data-no-export=""><a href=
    "https://url.spec.whatwg.org/#concept-basic-url-parser">basic
    URL parser</a></dfn> are defined in [<cite><a class="bibref"
    data-link-type="biblio" href="#bib-url" title=
    "URL Standard">URL</a></cite>].</p>
    <p>The terms <dfn id="dfn-mime-type" data-no-export=""><a href=
    "https://mimesniff.spec.whatwg.org/#mime-type">MIME
    type</a></dfn>, <dfn id="dfn-parsing-a-mime-type"
    data-no-export=""><a href=
    "https://mimesniff.spec.whatwg.org/#parsing-a-mime-type">Parsing
    a MIME type</a></dfn>, <dfn id="dfn-serializing-a-mime-type"
    data-no-export=""><a href=
    "https://mimesniff.spec.whatwg.org/#serializing-a-mime-type">Serializing
    a MIME type</a></dfn>, <dfn id="dfn-valid-mime-type-string"
    data-no-export=""><a href=
    "https://mimesniff.spec.whatwg.org/#valid-mime-type">valid MIME
    type string</a></dfn>, <dfn id="dfn-json-mime-type"
    data-no-export=""><a href=
    "https://mimesniff.spec.whatwg.org/#json-mime-type">JSON MIME
    type</a></dfn> are defined in [<cite><a class="bibref"
    data-link-type="biblio" href="#bib-mimesniff" title=
    "MIME Sniffing Standard">MIMESNIFF</a></cite>].</p>
    <p>The terms <dfn id="dfn-utf-8-encoding" data-no-export=
    ""><a href="https://encoding.spec.whatwg.org/#utf-8">UTF-8
    encoding</a></dfn>, <dfn id="dfn-utf-8-decode" data-no-export=
    ""><a href=
    "https://encoding.spec.whatwg.org/#utf-8-decode">UTF-8
    decode</a></dfn>, <dfn id="dfn-encode" data-no-export=
    ""><a href=
    "https://encoding.spec.whatwg.org/#encode">encode</a></dfn>,
    <dfn id="dfn-decode" data-no-export=""><a href=
    "https://encoding.spec.whatwg.org/#decode">decode</a></dfn> are
    defined in [<cite><a class="bibref" data-link-type="biblio"
    href="#bib-encoding" title=
    "Encoding Standard">ENCODING</a></cite>].</p>
    <p><dfn id="dfn-string" data-no-export=""><a href=
    "https://infra.spec.whatwg.org/#string">string</a></dfn>,
    <dfn id="dfn-parse-json-from-bytes" data-no-export=""><a href=
    "https://infra.spec.whatwg.org/#parse-json-from-bytes">parse
    JSON from bytes</a></dfn> and <dfn id=
    "dfn-serialize-json-to-bytes" data-no-export=""><a href=
    "https://infra.spec.whatwg.org/#serialize-json-to-bytes">serialize
    JSON to bytes</a></dfn>, are defined in [<cite><a class=
    "bibref" data-link-type="biblio" href="#bib-infra" title=
    "Infra Standard">INFRA</a></cite>].</p>
    <p><dfn id="dfn-promise" data-no-export=""><a href=
    "https://tc39.es/ecma262/#sec-promise-objects"></a><a data-link-type="idl"
    href=
    "https://tc39.es/ecma262/#sec-promise-objects"><code>Promise</code></a></dfn>,
    <dfn id="dfn-error" data-no-export=""><a href=
    "https://tc39.es/ecma262/#sec-error-objects">Error</a></dfn>,
    <dfn id="dfn-json" data-no-export=""><a href=
    "https://tc39.es/ecma262/#sec-json-object">JSON</a></dfn>,
    <dfn id="dfn-json-stringify" data-no-export=""><a href=
    "https://tc39.es/ecma262/#sec-json.stringify">JSON.stringify</a></dfn>,
    <dfn id="dfn-json-parse" data-no-export=""><a href=
    "https://tc39.es/ecma262/#sec-json.parse">JSON.parse</a></dfn>,
    <dfn id="dfn-internal-method" data-no-export=""><a href=
    "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
    internal method</a></dfn> and <dfn data-plurals=
    "internal slots" id="dfn-internal-slot" data-no-export=
    ""><a href=
    "https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">
    internal slot</a></dfn> are defined in [<cite><a class="bibref"
    data-link-type="biblio" href="#bib-ecmascript" title=
    "ECMAScript Language Specification">ECMASCRIPT</a></cite>].</p>
    <p>The terms <dfn id="dfn-browsing-context" data-no-export=
    ""><a href=
    "https://html.spec.whatwg.org/multipage/#browsing-context">browsing
    context</a></dfn>, <dfn id="dfn-top-level-browsing-context"
    data-no-export=""><a href=
    "https://html.spec.whatwg.org/multipage/#top-level-browsing-context">
    top-level browsing context</a></dfn>, <dfn id=
    "dfn-global-object" data-no-export=""><a href=
    "https://html.spec.whatwg.org/multipage/#global-object">global
    object</a></dfn>, <dfn id="dfn-current-settings-object"
    data-no-export=""><a href=
    "https://html.spec.whatwg.org/multipage/#current-settings-object">
    current settings object</a></dfn>, executing algorithms
    <dfn id="dfn-in-parallel" data-no-export=""><a href=
    "https://html.spec.whatwg.org/multipage/#in-parallel">in
    parallel</a></dfn> are defined in [<cite><a class="bibref"
    data-link-type="biblio" href="#bib-html5" title=
    "HTML5">HTML5</a></cite>] and are used in the context of
    browser implementations.</p>
    <p>The term <a href=
    "https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">
    <dfn id="dfn-secure-context">secure context</dfn></a> is
    defined in [<cite><a class="bibref" data-link-type="biblio"
    href="#bib-webappsec" title=
    "Secure Contexts">WEBAPPSEC</a></cite>].</p>
    <p><dfn id="dfn-iana-media-type">IANA media type</dfn>s
    (formerly known as MIME types) are defined in <a href=
    "http://tools.ietf.org/html/rfc2046">RFC2046</a>.</p>
    <p>The terms <dfn id="dfn-hyperlink-reference">hyperlink
    reference</dfn> and <dfn id="dfn-relation-type">relation
    type</dfn> are defined in [<cite><a class="bibref"
    data-link-type="biblio" href="#bib-html5" title=
    "HTML5">HTML5</a></cite>] and <a href=
    "https://tools.ietf.org/html/rfc8288">RFC8288</a>.</p>
  </section>
  <section class="appendix" id="api-design-rationale">
    <h2 id="a-api-design-rationale"><bdi class="secno">A.</bdi> API
    design rationale<a class="self-link" aria-label="§" href=
    "#api-design-rationale"></a></h2>
    <p>API rationale usually belongs to a separate document, but in
    the WoT case the complexity of the context justifies including
    basic rationale here.</p>
    <section id="approaches-to-wot-application-development">
      <h3 id="a-1-approaches-to-wot-application-development">
      <bdi class="secno">A.1</bdi> Approaches to WoT application
      development<a class="self-link" aria-label="§" href=
      "#approaches-to-wot-application-development"></a></h3>
      <p>The WoT Interest Group and Working Group have explored
      different approaches to application development for WoT that
      have been all implemented and tested.</p>
      <section id="no-scripting-api">
        <h4 id="a-1-1-no-scripting-api"><bdi class=
        "secno">A.1.1</bdi> No Scripting API<a class="self-link"
        aria-label="§" href="#no-scripting-api"></a></h4>
        <p>It is possible to develop WoT applications that only use
        the <a href="#dfn-wot-network-interface" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-wot-network-interface-1">WoT network
        interface</a>, typically exposed by a WoT gateway that
        presents a REST-ful API towards clients and implements IoT
        protocol plugins that communicate with supported IoT
        deployments. One such implementation is the <a href=
        "https://iot.mozilla.org/">Mozilla WebThings</a>
        platform.</p>
      </section>
      <section id="simple-scripting-api">
        <h4 id="a-1-2-simple-scripting-api"><bdi class=
        "secno">A.1.2</bdi> Simple Scripting API<a class=
        "self-link" aria-label="§" href=
        "#simple-scripting-api"></a></h4>
        <p>WoT <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn" id="ref-for-dfn-things-51">Thing</a>s
        show good synergy with software objects, so a <a href=
        "#dfn-things" class="internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-things-52">Thing</a> can be represented as a
        software object, with <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-properties-87">Properties</a> represented as
        object properties, <a href="#dfn-actions" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-actions-32">Action</a>s as methods, and
        <a href="#dfn-events" class="internalDFN" data-link-type=
        "dfn" id="ref-for-dfn-events-54">Event</a>s as events. In
        addition, metadata is stored in special properties.
        Consuming and exposing is done with factory methods that
        produce a software object that directly represents a remote
        <a href="#dfn-things" class="internalDFN" data-link-type=
        "dfn" id="ref-for-dfn-things-53">Thing</a> and its
        interactions. One such implementation is the <a href=
        "https://github.com/draggett/arena-webhub">Arena Web
        Hub</a> project.</p>
        <p>In the next example, a <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-things-54">Thing</a> that represents
        interactions with a lock would look like the following: the
        <var>status</var> property and the <code>open()</code>
        method are directly exposed on the object.</p>
        <div class="example" id=
        "example-11-open-a-lock-with-a-simple-api">
          <div class="marker">
            <a class="self-link" href=
            "#example-11-open-a-lock-with-a-simple-api">Example
            <bdi>11</bdi></a><span class="example-title">: Open a
            lock with a simple API</span>
          </div>
          <pre aria-busy="false"><code class=
          "hljs javascript"><span class=
          "hljs-keyword">let</span> lock = <span class=
          "hljs-keyword">await</span> WoT.consume(‘https:<span class=
          "hljs-comment">//td.my.com/lock-00123’);</span>
<span class="hljs-built_in">console</span>.log(lock.status);
lock.open(<span class=
"hljs-string">'withThisKey'</span>);</code></pre>
        </div>
      </section>
      <section id=
      "this-api-aligned-with-the-web-of-things-thing-description-specification">
        <h4 id=
        "a-1-3-this-api-aligned-with-the-web-of-things-thing-description-specification">
        <bdi class="secno">A.1.3</bdi> This API, aligned with the
        <cite><a href=
        "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
        Web of Things Thing Description</a></cite>
        specification<a class="self-link" aria-label="§" href=
        "#this-api-aligned-with-the-web-of-things-thing-description-specification"></a></h4>
        <p>Since the direct mapping of <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn" id=
        "ref-for-dfn-things-55">Thing</a>s to software objects have
        had some challenges, this specification takes another
        approach that exposes software objects to represent the
        <a href="#dfn-things" class="internalDFN" data-link-type=
        "dfn" id="ref-for-dfn-things-56">Thing</a> metadata as data
        property and the WoT interactions as methods. One
        implementation is <a href=
        "https://github.com/eclipse/thingweb.node-wot">node-wot</a>
        in the the <a href="http://www.thingweb.io/">Eclipse
        ThingWeb</a> project, which is the current reference
        implementation of the API specified in this document.</p>
        <p>The same example now would look like the following: the
        <var>status</var> property and the <code>open()</code>
        method are represented indirectly.</p>
        <div class="example" id="example-12-open-a-lock">
          <div class="marker">
            <a class="self-link" href=
            "#example-12-open-a-lock">Example
            <bdi>12</bdi></a><span class="example-title">: Open a
            lock</span>
          </div>
          <pre aria-busy="false"><code class=
          "hljs javascript"><span class=
          "hljs-keyword">let</span> res = <span class=
          "hljs-keyword">await</span> fetch(‘https:<span class=
          "hljs-comment">//td.my.com/lock-00123’);</span>
<span class="hljs-keyword">let</span> td = <span class=
"hljs-keyword">await</span> res.json();
<span class="hljs-keyword">let</span> lock = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
<span class=
"hljs-built_in">console</span>.log(lock.readProperty(‘status’));
lock.invokeAction(‘open’, <span class=
"hljs-string">'withThisKey'</span>);</code></pre>
        </div>
      </section>
      <p>In conclusion, the WoT WG decided to explore the third
      option that closely follows the <cite><a href=
      "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
      Web of Things Thing Description</a></cite> specification.
      Based on this, a simple API can also be implemented. Since
      Scripting is an optional module in WoT, this leaves room for
      applications that only use the <a href=
      "#dfn-wot-network-interface" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-wot-network-interface-2">WoT network
      interface</a>. Therefore all three approaches above are
      supported by the <cite><a href=
      "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
      Web of Things Thing Description</a></cite> specification.</p>
      <p>Moreover, the <a href="#dfn-wot-network-interface" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-network-interface-3">WoT network
      interface</a> can be implemented in many languages and
      runtimes. Consider this API an example for what needs to be
      taken into consideration when designing a Scripting API for
      WoT.</p>
    </section>
    <section id="fetching-and-validating-a-td">
      <h3 id="a-2-fetching-and-validating-a-td"><bdi class=
      "secno">A.2</bdi> Fetching and validating a TD<a class=
      "self-link" aria-label="§" href=
      "#fetching-and-validating-a-td"></a></h3>
      <p>The <code>fetch(url)</code> method has been part of this
      API in earlier versions. However, now fetching a <a href=
      "#dfn-td-0" class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-td-0-18">TD</a> given a URL should be done with
      an external method, such as the <a href=
      "https://fetch.spec.whatwg.org/#fetch-api">Fetch API</a> or a
      HTTP client library, which offer already standardized options
      on specifying fetch details. The reason is that while simple
      fetch operations (covering most use cases) could be done in
      this API, when various fetch options were needed, there was
      no point in duplicating existing work to re-expose those
      options in this API.</p>
      <p>Since fetching a <a href="#dfn-td-0" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-td-0-19">TD</a> has been
      scoped out, and <a href="#dfn-td-0" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-td-0-20">TD</a>
      validation is defined externally in the <cite><a href=
      "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
      Web of Things Thing Description</a></cite> specification,
      that is scoped out, too. This specification expects a
      <a href="#dfn-td-0" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-td-0-21">TD</a> as <a href=
      "https://infra.spec.whatwg.org/#parse-json-from-bytes">parsed
      JSON object</a> that has been validated according to the
      <cite><a href=
      "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
      Web of Things Thing Description</a></cite> specification.</p>
    </section>
    <section id="factory-vs-constructors">
      <h3 id="a-3-factory-vs-constructors"><bdi class=
      "secno">A.3</bdi> Factory vs constructors<a class="self-link"
      aria-label="§" href="#factory-vs-constructors"></a></h3>
      <p>The factory methods for consuming and exposing <a href=
      "#dfn-things" class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-things-57">Thing</a>s are asynchronous and fully
      validate the input <a href="#dfn-td-0" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-td-0-22">TD</a>. In
      addition, one can also construct <a data-link-type="idl"
      href="#dom-consumedthing" class="internalDFN" id=
      "ref-for-dom-consumedthing-22"><code><code>ConsumedThing</code></code></a>
      and <a data-link-type="idl" href="#dom-exposedthing" class=
      "internalDFN" id=
      "ref-for-dom-exposedthing-31"><code><code>ExposedThing</code></code></a>
      by providing a parsed and validated <a href="#dfn-td-0"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-td-0-23">TD</a>. Platform initialization is then
      done when needed during the WoT interactions.</p>
    </section>
    <section id="observers">
      <h3 id="a-4-observers"><bdi class="secno">A.4</bdi>
      Observers<a class="self-link" aria-label="§" href=
      "#observers"></a></h3>
      <p>Earlier drafts used the <a href=
      "https://github.com/tc39/proposal-observable">Observer</a>
      construct, but since it has not become standard, a new design
      was needed that was light enough for embedded
      implementations. Therefore observing <a href=
      "#dfn-properties" class="internalDFN" data-link-type="dfn"
      id="ref-for-dfn-properties-88">Property</a> changes and
      handling WoT <a href="#dfn-events" class="internalDFN"
      data-link-type="dfn" id="ref-for-dfn-events-55">Event</a>s is
      done with callback registrations.</p>
    </section>
    <section id="using-events">
      <h3 id="a-5-using-events"><bdi class="secno">A.5</bdi> Using
      Events<a class="self-link" aria-label="§" href=
      "#using-events"></a></h3>
      <div>
        This API ended up not using software events at all, for the
        following reasons:
        <ul>
          <li>Subscription to WoT <a href="#dfn-events" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-events-56">Event</a>s may be different from
          handling software events (subscription might need
          parameters, might involve security tokens etc).
          </li>
          <li>Most implementations are for Node.js and browser
          implementations will likely be libraries (because
          possible dependency management issues in native
          implementations), using Events has been challenging.</li>
          <li>Observing <a href="#dfn-properties" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-properties-89">Property</a> changes and
          handling WoT <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-events-57">Event</a>s is done with the
          solution above.
          </li>
        </ul>
      </div>
    </section>
    <section id="polymorphic-functions">
      <h3 id="a-6-polymorphic-functions"><bdi class=
      "secno">A.6</bdi> Polymorphic functions<a class="self-link"
      aria-label="§" href="#polymorphic-functions"></a></h3>
      <p>The reason to use function names like
      <code>readProperty()</code>,
      <code>readMultipleProperties()</code> etc. instead of a
      generic polymorphic <code>read()</code> function is that the
      current names map exactly to the <code>"op"</code> vocabulary
      from the <a href=
      "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#form">
      Form</a> definition in the <cite><a href=
      "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
      Web of Things Thing Description</a></cite> specification.</p>
    </section>
  </section>
  <section class="appendix" id="Changes">
    <h2 id="b-changes"><bdi class="secno">B.</bdi> Changes<a class=
    "self-link" aria-label="§" href="#Changes"></a></h2>
    <div>
      The following is a list of major changes to the document.
      Major versions of this specification are the following:
      <ul>
        <li>First Public Working Draft <a href=
        "https://www.w3.org/TR/2017/WD-wot-scripting-api-20170914/">
          September 2017</a>.
        </li>
        <li>Working Draft <a href=
        "https://www.w3.org/TR/2018/WD-wot-scripting-api-20180405/">
          April 2018</a>.
        </li>
        <li>Working Draft <a href=
        "https://www.w3.org/TR/2018/WD-wot-scripting-api-20181129/">
          November 2018</a>.
        </li>
        <li>Working draft <a href=
        "https://www.w3.org/TR/2019/WD-wot-scripting-api-20191028/">
          October 2019</a>.
        </li>
        <li>This version, introducing the following major changes:
          <ul>
            <li>Added support for <code>formIndex</code>,
            <code>InteractionData</code> including streams.</li>
            <li>Cleaned up the specification prose, aligned
            terminology and used modern ReSpec.</li>
            <li>Improved algorithm descriptions, included
            illustrative figures.</li>
          </ul>
        </li>
      </ul>
    </div>
    <p>For a complete list of changes, see the <a href=
    "https://github.com/w3c/wot-scripting-api/commits/master">github
    change log</a>. You can also view the <a href=
    "https://github.com/w3c/wot-scripting-api/issues?page=1&amp;state=closed">
    recently closed issues</a>.</p>
  </section>
  <section class="appendix" id="idl-index">
    <h2 id="c-full-web-idl"><bdi class="secno">C.</bdi> Full Web
    IDL<a class="self-link" aria-label="§" href=
    "#idl-index"></a></h2>
    <pre class="idl def" id="actual-idl-index"><span class=
    "idlHeader"><a class="self-link" href=
    "#actual-idl-index">WebIDL</a></span><span data-idl="" class=
    "idlTypedef" data-title="ThingDescription">typedef<span class=
    "idlType"> <a data-type="interface" href=
    "https://heycam.github.io/webidl/#idl-object">object</a></span> <a class="internalDFN idlID"
data-link-type="typedef" href="#dom-thingdescription" id=
"ref-for-dom-thingdescription-23"><code>ThingDescription</code></a>;</span>

<span data-idl="" class="idlNamespace" data-title=
"WOT">[<span class="extAttr"><a data-type="extended-attribute"
href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
namespace <a class="internalDFN idlID" data-link-type="namespace"
href="#dom-wot" id=
"ref-for-dom-wot-5"><code>WOT</code></a> {<span class=
"idlSectionComment">
  // methods defined in UA conformance classes
</span>};</span>

<span data-idl="" class="idlNamespace" data-title=
"WOT">partial namespace <a class="internalDFN idlID"
data-link-type="namespace" href="#dom-wot" id=
"ref-for-dom-wot-6"><code>WOT</code></a> {<span data-idl="" class=
"idlMethod" data-title="consume" data-dfn-for="WOT"><span class=
"idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-consumedthing"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-consumedthing-23"><code>ConsumedThing</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-wot-consume" id=
"ref-for-dom-wot-consume-2"><code>consume</code></a>(<span class=
"idlType"><a href="#dom-thingdescription" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-thingdescription-24"><code>ThingDescription</code></a></span> <span class="idlParamName">td</span>);</span>
};</span>

<span data-idl="" class="idlNamespace" data-title=
"WOT">partial namespace <a class="internalDFN idlID"
data-link-type="namespace" href="#dom-wot" id=
"ref-for-dom-wot-7"><code>WOT</code></a> {<span data-idl="" class=
"idlMethod" data-title="produce" data-dfn-for="WOT"><span class=
"idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-exposedthing"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-exposedthing-32"><code>ExposedThing</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-wot-produce" id=
"ref-for-dom-wot-produce-2"><code>produce</code></a>(<span class=
"idlType"><a href="#dom-thingdescription" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-thingdescription-25"><code>ThingDescription</code></a></span> <span class="idlParamName">td</span>);</span>
};</span>

<span data-idl="" class="idlNamespace" data-title=
"WOT">partial namespace <a class="internalDFN idlID"
data-link-type="namespace" href="#dom-wot" id=
"ref-for-dom-wot-8"><code>WOT</code></a> {<span data-idl="" class=
"idlMethod" data-title="discover" data-dfn-for="WOT"><span class=
"idlType">
  <a href="#dom-thingdiscovery" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-thingdiscovery-10"><code>ThingDiscovery</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-wot-discover" id=
"ref-for-dom-wot-discover-2"><code>discover</code></a>(optional<span class="idlType"> <a href="#dom-thingfilter"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-thingfilter-8"><code>ThingFilter</code></a></span> <span class="idlParamName">filter</span> = null);</span>
};</span>

<span data-idl="" class="idlTypedef" data-title=
"DataSchemaValue">typedef<span class="idlType"> <a data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <a class=
"internalDFN idlID" data-link-type="typedef" href=
"#dom-dataschemavalue" id=
"ref-for-dom-dataschemavalue-3"><code>DataSchemaValue</code></a>;</span><span data-idl=""
class="idlTypedef" data-title="InteractionInput">
typedef<span class="idlType"> (<a data-type="interface" href=
"https://streams.spec.whatwg.org/#readablestream">ReadableStream</a> or <a href="#dom-dataschemavalue"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-dataschemavalue-4"><code>DataSchemaValue</code></a>)</span> <a class="internalDFN idlID"
data-link-type="typedef" href="#dom-interactioninput" id=
"ref-for-dom-interactioninput-15"><code>InteractionInput</code></a>;</span>

<span data-idl="" class="idlInterface" data-title=
"InteractionOutput">[<span class="extAttr"><a data-type=
"extended-attribute" href=
"https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-type="interface"
href="#dom-interactionoutput" id=
"ref-for-dom-interactionoutput-24"><code>InteractionOutput</code></a> {<span data-idl=""
class="idlAttribute" data-title="data" data-dfn-for=
"InteractionOutput">
  readonly attribute<span class="idlType"> <a data-type="interface"
href=
"https://streams.spec.whatwg.org/#readablestream">ReadableStream</a>?</span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-interactionoutput-data" id=
"ref-for-dom-interactionoutput-data-2"><code>data</code></a>;</span><span data-idl=""
class="idlAttribute" data-title="dataUsed" data-dfn-for=
"InteractionOutput">
  readonly attribute<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-interactionoutput-dataused"
id=
"ref-for-dom-interactionoutput-dataused-2"><code>dataUsed</code></a>;</span><span data-idl=""
class="idlAttribute" data-title="form" data-dfn-for=
"InteractionOutput">
  readonly attribute<span class="idlType"> <a href="#dfn-form"
class="internalDFN" data-link-type="dfn" id=
"ref-for-dfn-form-28">Form</a>?</span> <a class=
"internalDFN idlName" data-link-type="attribute" href=
"#dom-interactionoutput-form" id=
"ref-for-dom-interactionoutput-form-2"><code>form</code></a>;</span><span data-idl=""
class="idlAttribute" data-title="schema" data-dfn-for=
"InteractionOutput">
  readonly attribute<span class="idlType"> <a href=
"#dfn-dataschema" class="internalDFN" data-link-type="dfn" id=
"ref-for-dfn-dataschema-14">DataSchema</a>?</span> <a class=
"internalDFN idlName" data-link-type="attribute" href=
"#dom-interactionoutput-schema" id=
"ref-for-dom-interactionoutput-schema-2"><code>schema</code></a>;</span><span data-idl=""
class="idlMethod" data-title="arrayBuffer" data-dfn-for=
"InteractionOutput"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-ArrayBuffer">ArrayBuffer</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-interactionoutput-arraybuffer"
id=
"ref-for-dom-interactionoutput-arraybuffer-2"><code>arrayBuffer</code></a>();</span><span data-idl=""
class="idlMethod" data-title="value" data-dfn-for=
"InteractionOutput"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-interactionoutput-value" id=
"ref-for-dom-interactionoutput-value-2"><code>value</code></a>();</span>
};</span>

<span data-idl="" class="idlInterface" data-title=
"ConsumedThing">[<span class="extAttr"><a data-type=
"extended-attribute" href=
"https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-type="interface"
href="#dom-consumedthing" id=
"ref-for-dom-consumedthing-24"><code>ConsumedThing</code></a> {<span data-idl=""
class="idlConstructor" data-title="constructor" data-dfn-for=
"ConsumedThing">
  <dfn data-export="" data-dfn-type="constructor" data-idl=
"constructor" data-title="constructor" data-dfn-for="ConsumedThing"
data-lt="constructor()|constructor(td)" data-local-lt=
"ConsumedThing.constructor|ConsumedThing.constructor()|constructor"><code>constructor</code></dfn>(<span class="idlType"><a href="#dom-thingdescription"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-thingdescription-26"><code>ThingDescription</code></a></span> <span class="idlParamName">td</span>);</span><span data-idl=""
class="idlMethod" data-title="readProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-interactionoutput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionoutput-25"><code>InteractionOutput</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-readproperty" id=
"ref-for-dom-consumedthing-readproperty-2"><code>readProperty</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">propertyName</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-15"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="readAllProperties" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-propertymap"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-propertymap-7"><code>PropertyMap</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-readallproperties"
id=
"ref-for-dom-consumedthing-readallproperties-2"><code>readAllProperties</code></a>(optional<span class="idlType"> <a href="#dom-interactionoptions"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionoptions-16"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="readMultipleProperties" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-propertymap"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-propertymap-8"><code>PropertyMap</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-consumedthing-readmultipleproperties" id=
"ref-for-dom-consumedthing-readmultipleproperties-2"><code>readMultipleProperties</code></a>(<span class="idlType">
                              <a data-type="dfn" href=
"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>&gt;</span> <span class="idlParamName">propertyNames</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-17"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="writeProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-writeproperty" id=
"ref-for-dom-consumedthing-writeproperty-2"><code>writeProperty</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">propertyName</span>,<span class="idlType">
                              <a href="#dom-interactioninput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactioninput-16"><code>InteractionInput</code></a></span> <span class="idlParamName">value</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-18"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="writeMultipleProperties"
data-dfn-for="ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-consumedthing-writemultipleproperties" id=
"ref-for-dom-consumedthing-writemultipleproperties-2"><code>writeMultipleProperties</code></a>(<span class="idlType"><a href="#dom-propertymap"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-propertymap-9"><code>PropertyMap</code></a></span> <span class="idlParamName">valueMap</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-19"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="invokeAction" data-dfn-for=
"ConsumedThing"><span class="idlType"><span class=
"idlSectionComment">
  /*Promise&lt;undefined&gt; writeAllProperties(PropertyMap valueMap,
                              optional InteractionOptions options = null);*/
  </span><a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-interactionoutput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionoutput-26"><code>InteractionOutput</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-invokeaction" id=
"ref-for-dom-consumedthing-invokeaction-2"><code>invokeAction</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">actionName</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactioninput" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactioninput-17"><code>InteractionInput</code></a></span> <span class="idlParamName">params</span> = null,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-20"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="observeProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-subscription"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-subscription-10"><code>Subscription</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-observeproperty"
id=
"ref-for-dom-consumedthing-observeproperty-2"><code>observeProperty</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
                              <a href="#dom-interactionlistener"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionlistener-4"><code>InteractionListener</code></a></span> <span class="idlParamName">listener</span>,
                              optional<span class=
"idlType"> <a href="#dom-errorlistener" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-errorlistener-4"><code>ErrorListener</code></a></span> <span class="idlParamName">onerror</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-21"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="subscribeEvent" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-subscription"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-subscription-11"><code>Subscription</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-consumedthing-subscribeevent"
id="ref-for-dom-consumedthing-subscribeevent-2"><code>subscribeEvent</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
                              <a href="#dom-interactionlistener"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionlistener-5"><code>InteractionListener</code></a></span> <span class="idlParamName">listener</span>,
                              optional<span class=
"idlType"> <a href="#dom-errorlistener" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-errorlistener-5"><code>ErrorListener</code></a></span> <span class="idlParamName">onerror</span>,
                              optional<span class=
"idlType"> <a href="#dom-interactionoptions" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoptions-22"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="getThingDescription" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a href="#dom-thingdescription" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-thingdescription-27"><code>ThingDescription</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-consumedthing-getthingdescription" id=
"ref-for-dom-consumedthing-getthingdescription-2"><code>getThingDescription</code></a>();</span>
};</span><span data-idl="" class="idlDictionary" data-title=
"InteractionOptions">

dictionary <a class="internalDFN idlID" data-link-type="dictionary"
href="#dom-interactionoptions" id=
"ref-for-dom-interactionoptions-23"><code>InteractionOptions</code></a> {<span data-idl=""
class="idlMember" data-title="formIndex" data-dfn-for=
"InteractionOptions"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName"
data-link-type="dict-member" href=
"#dom-interactionoptions-formindex" id=
"ref-for-dom-interactionoptions-formindex-2"><code>formIndex</code></a>;</span><span data-idl=""
class="idlMember" data-title="uriVariables" data-dfn-for=
"InteractionOptions"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <a class="internalDFN idlName"
data-link-type="dict-member" href=
"#dom-interactionoptions-urivariables" id=
"ref-for-dom-interactionoptions-urivariables-2"><code>uriVariables</code></a>;</span><span data-idl=""
class="idlMember" data-title="data" data-dfn-for=
"InteractionOptions"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <a class=
"internalDFN idlName" data-link-type="dict-member" href=
"#dom-interactionoptions-data" id=
"ref-for-dom-interactionoptions-data-2"><code>data</code></a>;</span>
};</span><span data-idl="" class="idlInterface" data-title=
"Subscription">

[<span class="extAttr"><a data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-type="interface"
href="#dom-subscription" id=
"ref-for-dom-subscription-12"><code>Subscription</code></a> {<span data-idl=""
class="idlAttribute" data-title="active" data-dfn-for=
"Subscription">
  readonly attribute<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-subscription-active" id=
"ref-for-dom-subscription-active-3"><code>active</code></a>;</span><span data-idl=""
class="idlMethod" data-title="stop" data-dfn-for=
"Subscription"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-subscription-stop" id=
"ref-for-dom-subscription-stop-2"><code>stop</code></a>(optional<span class="idlType"> <a href="#dom-interactionoptions"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionoptions-24"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span>
};</span><span data-idl="" class="idlTypedef" data-title=
"PropertyMap">

typedef<span class="idlType"> <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <a class="internalDFN idlID"
data-link-type="typedef" href="#dom-propertymap" id=
"ref-for-dom-propertymap-10"><code>PropertyMap</code></a>;</span><span data-idl=""
class="idlCallback" data-title="InteractionListener">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-interactionlistener" id=
"ref-for-dom-interactionlistener-6"><code>InteractionListener</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a></span>(<span class="idlType"><a href="#dom-interactionoutput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactionoutput-27"><code>InteractionOutput</code></a></span> <span class="idlParamName">data</span>);</span><span data-idl=""
class="idlCallback" data-title="ErrorListener">
callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-errorlistener" id=
"ref-for-dom-errorlistener-6"><code>ErrorListener</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a></span>(<span class="idlType"><a data-link-type="dfn"
href=
"https://tc39.es/ecma262/#sec-error-objects">Error</a></span> <span class="idlParamName">error</span>);</span>

<span data-idl="" class="idlInterface" data-title=
"ExposedThing">[<span class="extAttr"><a data-type=
"extended-attribute" href=
"https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-type="interface"
href="#dom-exposedthing" id=
"ref-for-dom-exposedthing-33"><code>ExposedThing</code></a> {<span data-idl=""
class="idlMethod" data-title="setPropertyReadHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-34"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-setpropertyreadhandler" id=
"ref-for-dom-exposedthing-setpropertyreadhandler-2"><code>setPropertyReadHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-propertyreadhandler" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-propertyreadhandler-5"><code>PropertyReadHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" data-title="setPropertyWriteHandler"
data-dfn-for="ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-35"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-setpropertywritehandler" id=
"ref-for-dom-exposedthing-setpropertywritehandler-2"><code>setPropertyWriteHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-propertywritehandler" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-propertywritehandler-3"><code>PropertyWriteHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" data-title="setPropertyObserveHandler"
data-dfn-for="ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-36"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-setpropertyobservehandler" id=
"ref-for-dom-exposedthing-setpropertyobservehandler-2"><code>setPropertyObserveHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-propertyreadhandler" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-propertyreadhandler-6"><code>PropertyReadHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" data-title="setPropertyUnobserveHandler"
data-dfn-for="ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-37"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-setpropertyunobservehandler" id=
"ref-for-dom-exposedthing-setpropertyunobservehandler-2"><code>setPropertyUnobserveHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-propertyreadhandler" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-propertyreadhandler-7"><code>PropertyReadHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" data-title="emitPropertyChange" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-emitpropertychange"
id=
"ref-for-dom-exposedthing-emitpropertychange-2"><code>emitPropertyChange</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>);</span><span data-idl=""
class="idlMethod" data-title="setActionHandler" data-dfn-for=
"ExposedThing"><span class="idlType">

  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-38"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-setactionhandler"
id=
"ref-for-dom-exposedthing-setactionhandler-2"><code>setActionHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType"> <a href="#dom-actionhandler"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-actionhandler-4"><code>ActionHandler</code></a></span> <span class="idlParamName">action</span>);</span><span data-idl=""
class="idlMethod" data-title="setEventSubscribeHandler"
data-dfn-for="ExposedThing"><span class="idlType">

  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-39"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-seteventsubscribehandler" id=
"ref-for-dom-exposedthing-seteventsubscribehandler-2"><code>setEventSubscribeHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-eventsubscriptionhandler" class=
"internalDFN" data-link-type="idl" id=
"ref-for-dom-eventsubscriptionhandler-4"><code>EventSubscriptionHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" data-title="setEventUnsubscribeHandler"
data-dfn-for="ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-40"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-seteventunsubscribehandler" id=
"ref-for-dom-exposedthing-seteventunsubscribehandler-2"><code>setEventUnsubscribeHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-eventsubscriptionhandler" class=
"internalDFN" data-link-type="idl" id=
"ref-for-dom-eventsubscriptionhandler-5"><code>EventSubscriptionHandler</code></a></span> <span class="idlParamName">handler</span>);</span><span data-idl=""
class="idlMethod" data-title="setEventHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl" id=
"ref-for-dom-exposedthing-41"><code>ExposedThing</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-seteventhandler"
id="ref-for-dom-exposedthing-seteventhandler-2"><code>setEventHandler</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-eventlistenerhandler" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-eventlistenerhandler-4"><code>EventListenerHandler</code></a></span> <span class="idlParamName">eventHandler</span>);</span><span data-idl=""
class="idlMethod" data-title="emitEvent" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-emitevent" id=
"ref-for-dom-exposedthing-emitevent-2"><code>emitEvent</code></a>(<span class="idlType"><a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a href="#dom-interactioninput" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactioninput-18"><code>InteractionInput</code></a></span> <span class="idlParamName">data</span>);</span><span data-idl=""
class="idlMethod" data-title="expose" data-dfn-for=
"ExposedThing"><span class="idlType">

  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-expose" id=
"ref-for-dom-exposedthing-expose-3"><code>expose</code></a>();</span><span data-idl=""
class="idlMethod" data-title="destroy" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-exposedthing-destroy" id=
"ref-for-dom-exposedthing-destroy-2"><code>destroy</code></a>();</span><span data-idl=""
class="idlMethod" data-title="getThingDescription" data-dfn-for=
"ExposedThing"><span class="idlType">

  <a href="#dom-thingdescription" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-thingdescription-28"><code>ThingDescription</code></a></span> <a class="internalDFN idlName"
data-link-type="method" href=
"#dom-exposedthing-getthingdescription" id=
"ref-for-dom-exposedthing-getthingdescription-2"><code>getThingDescription</code></a>();</span>
};</span><span data-idl="" class="idlCallback" data-title=
"PropertyReadHandler">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-propertyreadhandler" id=
"ref-for-dom-propertyreadhandler-8"><code>PropertyReadHandler</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span>(
        optional<span class="idlType"> <a href=
"#dom-interactionoptions" class="internalDFN" data-link-type="idl"
id=
"ref-for-dom-interactionoptions-25"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" data-title="PropertyWriteHandler">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-propertywritehandler" id=
"ref-for-dom-propertywritehandler-4"><code>PropertyWriteHandler</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span>(<span class="idlType">
        <a href="#dom-interactionoutput" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoutput-28"><code>InteractionOutput</code></a></span> <span class="idlParamName">value</span>,
        optional<span class="idlType"> <a href=
"#dom-interactionoptions" class="internalDFN" data-link-type="idl"
id=
"ref-for-dom-interactionoptions-26"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" data-title="ActionHandler">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-actionhandler" id=
"ref-for-dom-actionhandler-5"><code>ActionHandler</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-interactioninput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactioninput-19"><code>InteractionInput</code></a>&gt;</span>(<span class="idlType">
        <a href="#dom-interactionoutput" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-interactionoutput-29"><code>InteractionOutput</code></a></span> <span class="idlParamName">params</span>,
        optional<span class="idlType"> <a href=
"#dom-interactionoptions" class="internalDFN" data-link-type="idl"
id=
"ref-for-dom-interactionoptions-27"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" data-title="EventSubscriptionHandler">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-eventsubscriptionhandler" id=
"ref-for-dom-eventsubscriptionhandler-6"><code>EventSubscriptionHandler</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a>&gt;</span>(
        optional<span class="idlType"> <a href=
"#dom-interactionoptions" class="internalDFN" data-link-type="idl"
id=
"ref-for-dom-interactionoptions-28"><code>InteractionOptions</code></a></span> <span class="idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" data-title="EventListenerHandler">

callback <a class="internalDFN idlID" data-link-type="callback"
href="#dom-eventlistenerhandler" id=
"ref-for-dom-eventlistenerhandler-5"><code>EventListenerHandler</code></a> =<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-interactioninput"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-interactioninput-20"><code>InteractionInput</code></a>&gt;</span>();</span>

<span data-idl="" class="idlInterface" data-title=
"ThingDiscovery">[<span class="extAttr"><a data-type=
"extended-attribute" href=
"https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute"
href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-type="interface"
href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-lt="WorkerGlobalScope"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-type="interface"
href="#dom-thingdiscovery" id=
"ref-for-dom-thingdiscovery-11"><code>ThingDiscovery</code></a> {<span data-idl=""
class="idlConstructor" data-title="constructor" data-dfn-for=
"ThingDiscovery">
  <dfn data-export="" data-dfn-type="constructor" data-idl=
"constructor" data-title="constructor" data-dfn-for=
"ThingDiscovery" data-lt="constructor()|constructor(, filter)"
data-local-lt=
"ThingDiscovery.constructor|ThingDiscovery.constructor()|constructor"><code>constructor</code></dfn>(optional<span class="idlType"> <a href="#dom-thingfilter"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-thingfilter-9"><code>ThingFilter</code></a></span> <span class="idlParamName">filter</span> = null);</span><span data-idl=""
class="idlAttribute" data-title="filter" data-dfn-for=
"ThingDiscovery">
  readonly attribute<span class="idlType"> <a href=
"#dom-thingfilter" class="internalDFN" data-link-type="idl" id=
"ref-for-dom-thingfilter-10"><code>ThingFilter</code></a>?</span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-thingdiscovery-filter" id=
"ref-for-dom-thingdiscovery-filter-4"><code>filter</code></a>;</span><span data-idl=""
class="idlAttribute" data-title="active" data-dfn-for=
"ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-thingdiscovery-active" id=
"ref-for-dom-thingdiscovery-active-13"><code>active</code></a>;</span><span data-idl=""
class="idlAttribute" data-title="done" data-dfn-for=
"ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-thingdiscovery-done" id=
"ref-for-dom-thingdiscovery-done-6"><code>done</code></a>;</span><span data-idl=""
class="idlAttribute" data-title="error" data-dfn-for=
"ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-link-type="dfn"
href=
"https://tc39.es/ecma262/#sec-error-objects">Error</a>?</span> <a class="internalDFN idlName"
data-link-type="attribute" href="#dom-thingdiscovery-error" id=
"ref-for-dom-thingdiscovery-error-7"><code>error</code></a>;</span><span data-idl=""
class="idlMethod" data-title="start" data-dfn-for=
"ThingDiscovery"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a></span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-thingdiscovery-start" id=
"ref-for-dom-thingdiscovery-start-2"><code>start</code></a>();</span><span data-idl=""
class="idlMethod" data-title="next" data-dfn-for=
"ThingDiscovery"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-thingdescription"
class="internalDFN" data-link-type="idl" id=
"ref-for-dom-thingdescription-29"><code>ThingDescription</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-thingdiscovery-next" id=
"ref-for-dom-thingdiscovery-next-2"><code>next</code></a>();</span><span data-idl=""
class="idlMethod" data-title="stop" data-dfn-for=
"ThingDiscovery"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-undefined">undefined</a></span> <a class="internalDFN idlName"
data-link-type="method" href="#dom-thingdiscovery-stop" id=
"ref-for-dom-thingdiscovery-stop-2"><code>stop</code></a>();</span>
};</span>

<span data-idl="" class="idlTypedef" data-title=
"DiscoveryMethod">typedef<span class="idlType"> <a data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlID"
data-link-type="typedef" href="#dom-discoverymethod" id=
"ref-for-dom-discoverymethod-3"><code>DiscoveryMethod</code></a>;</span>

<span data-idl="" class="idlDictionary" data-title=
"ThingFilter">dictionary <a class="internalDFN idlID"
data-link-type="dictionary" href="#dom-thingfilter" id=
"ref-for-dom-thingfilter-11"><code>ThingFilter</code></a> {<span data-idl=""
class="idlMember" data-title="method" data-dfn-for=
"ThingFilter"><span class="idlType">
  (<a href="#dom-discoverymethod" class="internalDFN"
data-link-type="idl" id=
"ref-for-dom-discoverymethod-4"><code>DiscoveryMethod</code></a> or <a data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>)</span> <a class="internalDFN idlName"
data-link-type="dict-member" href="#dom-thingfilter-method" id=
"ref-for-dom-thingfilter-method-7"><code>method</code></a> = "any";</span><span data-idl=""
class="idlMember" data-title="url" data-dfn-for=
"ThingFilter"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <a class="internalDFN idlName"
data-link-type="dict-member" href="#dom-thingfilter-url" id=
"ref-for-dom-thingfilter-url-2"><code>url</code></a>;</span><span data-idl=""
class="idlMember" data-title="query" data-dfn-for=
"ThingFilter"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <a class="internalDFN idlName"
data-link-type="dict-member" href="#dom-thingfilter-query" id=
"ref-for-dom-thingfilter-query-4"><code>query</code></a>;</span><span data-idl=""
class="idlMember" data-title="fragment" data-dfn-for=
"ThingFilter"><span class="idlType">
  <a data-type="interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a>?</span> <a class="internalDFN idlName"
data-link-type="dict-member" href="#dom-thingfilter-fragment" id=
"ref-for-dom-thingfilter-fragment-3"><code>fragment</code></a>;</span>
};</span></pre>
  </section>
  <section class="appendix" id="acknowledgements">
    <h2 id="d-acknowledgements"><bdi class="secno">D.</bdi>
    Acknowledgements<a class="self-link" aria-label="§" href=
    "#acknowledgements"></a></h2>
    <p>Special thanks to former editor Johannes Hund (until August
    2017, when at Siemens AG) and Kazuaki Nimura (until December
    2018) for developing this specification. Also, the editors
    would like to thank Dave Raggett, Matthias Kovatsch, Michael
    Koster, Elena Reshetova, Michael McCool as well as the other
    WoT WG members for their comments, contributions and
    guidance.</p>
  </section>
  <section id="references" class="appendix">
    <h2 id="e-references"><bdi class="secno">E.</bdi>
    References<a class="self-link" aria-label="§" href=
    "#references"></a></h2>
    <section id="normative-references">
      <h3 id="e-1-normative-references"><bdi class=
      "secno">E.1</bdi> Normative references<a class="self-link"
      aria-label="§" href="#normative-references"></a></h3>
      <dl class="bibliography">
        <dt id="bib-ecmascript">[ECMASCRIPT]</dt>
        <dd>
          <a href="https://tc39.es/ecma262/"><cite>ECMAScript
          Language Specification</cite></a>. Ecma International.
          URL: <a href=
          "https://tc39.es/ecma262/">https://tc39.es/ecma262/</a>
        </dd>
        <dt id="bib-encoding">[ENCODING]</dt>
        <dd>
          <a href=
          "https://encoding.spec.whatwg.org/"><cite>Encoding
          Standard</cite></a>. Anne van Kesteren. WHATWG. Living
          Standard. URL: <a href=
          "https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
        </dd>
        <dt id="bib-html">[HTML]</dt>
        <dd>
          <a href=
          "https://html.spec.whatwg.org/multipage/"><cite>HTML
          Standard</cite></a>. Anne van Kesteren; Domenic Denicola;
          Ian Hickson; Philip Jägenstedt; Simon Pieters. WHATWG.
          Living Standard. URL: <a href=
          "https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        </dd>
        <dt id="bib-html5">[HTML5]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/html5/"><cite>HTML5</cite></a>.
          Ian Hickson; Robin Berjon; Steve Faulkner; Travis
          Leithead; Erika Doyle Navara; Theresa O'Connor; Silvia
          Pfeiffer. W3C. 27 March 2018. W3C Recommendation. URL:
          <a href=
          "https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>
        </dd>
        <dt id="bib-infra">[INFRA]</dt>
        <dd>
          <a href="https://infra.spec.whatwg.org/"><cite>Infra
          Standard</cite></a>. Anne van Kesteren; Domenic Denicola.
          WHATWG. Living Standard. URL: <a href=
          "https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        </dd>
        <dt id="bib-json-ld">[JSON-LD]</dt>
        <dd>
          <a href="https://www.w3.org/TR/json-ld/"><cite>JSON-LD
          1.0</cite></a>. Manu Sporny; Gregg Kellogg; Markus
          Lanthaler. W3C. 16 January 2014. W3C Recommendation. URL:
          <a href=
          "https://www.w3.org/TR/json-ld/">https://www.w3.org/TR/json-ld/</a>
        </dd>
        <dt id="bib-json-schema">[JSON-SCHEMA]</dt>
        <dd>
          <a href=
          "https://tools.ietf.org/html/draft-zyp-json-schema"><cite>
          JSON Schema: core definitions and terminology</cite></a>.
          K. Zyp. Internet Engineering Task Force (IETF). 31
          January 2013. Internet-Draft. URL: <a href=
          "https://tools.ietf.org/html/draft-zyp-json-schema">https://tools.ietf.org/html/draft-zyp-json-schema</a>
        </dd>
        <dt id="bib-mimesniff">[MIMESNIFF]</dt>
        <dd>
          <a href="https://mimesniff.spec.whatwg.org/"><cite>MIME
          Sniffing Standard</cite></a>. Gordon P. Hemsley. WHATWG.
          Living Standard. URL: <a href=
          "https://mimesniff.spec.whatwg.org/">https://mimesniff.spec.whatwg.org/</a>
        </dd>
        <dt id="bib-rfc2119">[RFC2119]</dt>
        <dd>
          <a href="https://tools.ietf.org/html/rfc2119"><cite>Key
          words for use in RFCs to Indicate Requirement
          Levels</cite></a>. S. Bradner. IETF. March 1997. Best
          Current Practice. URL: <a href=
          "https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
        </dd>
        <dt id="bib-rfc8174">[RFC8174]</dt>
        <dd>
          <a href=
          "https://tools.ietf.org/html/rfc8174"><cite>Ambiguity of
          Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>.
          B. Leiba. IETF. May 2017. Best Current Practice. URL:
          <a href=
          "https://tools.ietf.org/html/rfc8174">https://tools.ietf.org/html/rfc8174</a>
        </dd>
        <dt id="bib-streams">[streams]</dt>
        <dd>
          <a href="https://streams.spec.whatwg.org/"><cite>Streams
          Standard</cite></a>. Adam Rice; Domenic Denicola; 吉野剛史
          (Takeshi Yoshino). WHATWG. Living Standard. URL: <a href=
          "https://streams.spec.whatwg.org/">https://streams.spec.whatwg.org/</a>
        </dd>
        <dt id="bib-typescript">[TYPESCRIPT]</dt>
        <dd>
          <a href=
          "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">
          <cite>TypeScript Language Specification</cite></a>.
          Microsoft. 1 October 2012. URL: <a href=
          "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">
          https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md</a>
        </dd>
        <dt id="bib-url">[URL]</dt>
        <dd>
          <a href="https://url.spec.whatwg.org/"><cite>URL
          Standard</cite></a>. Anne van Kesteren. WHATWG. Living
          Standard. URL: <a href=
          "https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
        </dd>
        <dt id="bib-webappsec">[WEBAPPSEC]</dt>
        <dd>
          <a href=
          "https://w3c.github.io/webappsec/specs/powerfulfeatures"><cite>
          Secure Contexts</cite></a>. W3C. 17 July 2015. URL:
          <a href=
          "https://w3c.github.io/webappsec/specs/powerfulfeatures">https://w3c.github.io/webappsec/specs/powerfulfeatures</a>
        </dd>
        <dt id="bib-webidl">[WEBIDL]</dt>
        <dd>
          <a href="https://heycam.github.io/webidl/"><cite>Web
          IDL</cite></a>. Boris Zbarsky. W3C. 15 December 2016. W3C
          Editor's Draft. URL: <a href=
          "https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
        </dd>
        <dt id="bib-wot-architecture">[WOT-ARCHITECTURE]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/2020/REC-wot-architecture-20200409/">
          <cite>Web of Things Architecture</cite></a>. W3C. 9 April
          2020. URL: <a href=
          "https://www.w3.org/TR/2020/REC-wot-architecture-20200409/">
          https://www.w3.org/TR/2020/REC-wot-architecture-20200409/</a>
        </dd>
        <dt id="bib-wot-protocol-bindings">
        [WOT-PROTOCOL-BINDINGS]</dt>
        <dd>
          <a href=
          "https://w3c.github.io/wot-binding-templates/"><cite>Web
          of Things Binding Templates</cite></a>. W3C. 22 July
          2020. URL: <a href=
          "https://w3c.github.io/wot-binding-templates/">https://w3c.github.io/wot-binding-templates/</a>
        </dd>
        <dt id="bib-wot-security">[WOT-SECURITY]</dt>
        <dd>
          <a href="https://w3c.github.io/wot-security/"><cite>Web
          of Things Security and Privacy Guidelines</cite></a>.
          W3C. 11 August 2020. URL: <a href=
          "https://w3c.github.io/wot-security/">https://w3c.github.io/wot-security/</a>
        </dd>
        <dt id="bib-wot-td">[WOT-TD]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
          <cite>Web of Things Thing Description</cite></a>. W3C. 9
          April 2020. URL: <a href=
          "https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/">
          https://www.w3.org/TR/2020/REC-wot-thing-description-20200409/</a>
        </dd>
      </dl>
    </section>
  </section>
  <p role="navigation" id="back-to-top"><a href=
  "#title"><abbr title="Back to Top">↑</abbr></a></p>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-user-agent">
    <div>
      <a class="self-link" href="#dfn-user-agent">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-ua">
    <div>
      <a class="self-link" href="#dfn-ua">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-ua-1">3. Conformance</a> <a href=
        "#ref-for-dfn-ua-2">(2)</a> <a href=
        "#ref-for-dfn-ua-3">(3)</a> <a href=
        "#ref-for-dfn-ua-4">(4)</a> <a href=
        "#ref-for-dfn-ua-5">(5)</a> <a href=
        "#ref-for-dfn-ua-6">(6)</a> <a href=
        "#ref-for-dfn-ua-7">(7)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-wot-consumer">
    <div>
      <a class="self-link" href="#dfn-wot-consumer">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-consumer-1">5.1 The consume()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-consumer-2">6.1 The
        InteractionInput type</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-consumer-3">6.2 The
        InteractionOutput interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-consumer-4">7. The ConsumedThing
        interface</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-wot-producer">
    <div>
      <a class="self-link" href="#dfn-wot-producer">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-producer-1">5.2 The produce()
        method</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-wot-discovery">
    <div>
      <a class="self-link" href="#dfn-wot-discovery">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-discovery-1">5.3 The discover()
        method</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingdescription">
    <div>
      <a class="self-link" href=
      "#dom-thingdescription">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1625777409">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingdescription-1">4. The
        ThingDescription type</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-2">4.3 Validating a
        Thing Description</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-3">5.1 The consume()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-4">5.2 The produce()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-5">5.3 The
        discover() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-6">7. The
        ConsumedThing interface</a> <a href=
        "#ref-for-dom-thingdescription-7">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-8">7.2 Constructing
        ConsumedThing</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-9">7.13 The
        PropertyMap type</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-10">8. The
        ExposedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-11">8.2 Constructing
        ExposedThing</a> <a href=
        "#ref-for-dom-thingdescription-12">(2)</a> <a href=
        "#ref-for-dom-thingdescription-13">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-14">9. The
        ThingDiscovery interface</a> <a href=
        "#ref-for-dom-thingdescription-15">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-16">9.1 Constructing
        ThingDiscovery</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-17">9.4 The start()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-18">9.5 The next()
        method</a> <a href=
        "#ref-for-dom-thingdescription-19">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-20">9.7 Discovery
        Examples</a> <a href=
        "#ref-for-dom-thingdescription-21">(2)</a> <a href=
        "#ref-for-dom-thingdescription-22">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdescription-23">C. Full Web
        IDL</a> <a href="#ref-for-dom-thingdescription-24">(2)</a>
        <a href="#ref-for-dom-thingdescription-25">(3)</a> <a href=
        "#ref-for-dom-thingdescription-26">(4)</a> <a href=
        "#ref-for-dom-thingdescription-27">(5)</a> <a href=
        "#ref-for-dom-thingdescription-28">(6)</a> <a href=
        "#ref-for-dom-thingdescription-29">(7)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-expand-a-td">
    <div>
      <a class="self-link" href="#dfn-expand-a-td">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-expand-a-td-1">7.2 Constructing
        ConsumedThing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-expand-a-td-2">8.2 Constructing
        ExposedThing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-expand-a-td-3">8.30 The expose()
        method</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-validate-a-td">
    <div>
      <a class="self-link" href="#dfn-validate-a-td">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-validate-a-td-1">7.2 Constructing
        ConsumedThing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-validate-a-td-2">8.30 The expose()
        method</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dom-wot">
    <div>
      <a class="self-link" href="#dom-wot">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1274931079">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-wot-1">5. The WOT namespace</a>
      </li>
      <li>
        <a href="#ref-for-dom-wot-2">5.1 The consume() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-wot-3">5.2 The produce() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-wot-4">5.3 The discover() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-wot-5">C. Full Web IDL</a> <a href=
        "#ref-for-dom-wot-6">(2)</a> <a href=
        "#ref-for-dom-wot-7">(3)</a> <a href=
        "#ref-for-dom-wot-8">(4)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-wot-api-object">
    <div>
      <a class="self-link" href="#dfn-wot-api-object">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-api-object-1">3. Conformance</a>
        <a href="#ref-for-dfn-wot-api-object-2">(2)</a> <a href=
        "#ref-for-dfn-wot-api-object-3">(3)</a> <a href=
        "#ref-for-dfn-wot-api-object-4">(4)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-wot-consume">
    <div>
      <a class="self-link" href="#dom-wot-consume">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-584946864">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-wot-consume-1">5.1 The consume()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dom-wot-consume-2">C. Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-wot-produce">
    <div>
      <a class="self-link" href="#dom-wot-produce">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146491536">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-wot-produce-1">5.2 The produce()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dom-wot-produce-2">C. Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-wot-discover">
    <div>
      <a class="self-link" href="#dom-wot-discover">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-195238906">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-wot-discover-1">5.3 The discover()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dom-wot-discover-2">C. Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactioninput">
    <div>
      <a class="self-link" href=
      "#dom-interactioninput">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1492583996">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactioninput-1">6.1 The
        InteractionInput type</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactioninput-2">6.3 Using
        InteractionInput and InteractionOutput</a> <a href=
        "#ref-for-dom-interactioninput-3">(2)</a> <a href=
        "#ref-for-dom-interactioninput-4">(3)</a> <a href=
        "#ref-for-dom-interactioninput-5">(4)</a> <a href=
        "#ref-for-dom-interactioninput-6">(5)</a> <a href=
        "#ref-for-dom-interactioninput-7">(6)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactioninput-8">7. The
        ConsumedThing interface</a> <a href=
        "#ref-for-dom-interactioninput-9">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactioninput-10">8. The
        ExposedThing interface</a> <a href=
        "#ref-for-dom-interactioninput-11">(2)</a> <a href=
        "#ref-for-dom-interactioninput-12">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactioninput-13">8.18 The
        ActionHandler callback</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactioninput-14">8.21 The
        EventListenerHandler callback</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactioninput-15">C. Full Web
        IDL</a> <a href="#ref-for-dom-interactioninput-16">(2)</a>
        <a href="#ref-for-dom-interactioninput-17">(3)</a> <a href=
        "#ref-for-dom-interactioninput-18">(4)</a> <a href=
        "#ref-for-dom-interactioninput-19">(5)</a> <a href=
        "#ref-for-dom-interactioninput-20">(6)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-dataschemavalue">
    <div>
      <a class="self-link" href=
      "#dom-dataschemavalue">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1492583996">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-dataschemavalue-1">6.1 The
        InteractionInput type</a> <a href=
        "#ref-for-dom-dataschemavalue-2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-dataschemavalue-3">C. Full Web
        IDL</a> <a href="#ref-for-dom-dataschemavalue-4">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoutput">
    <div>
      <a class="self-link" href=
      "#dom-interactionoutput">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-761188038">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoutput-1">6.2 The
        InteractionOutput interface</a> <a href=
        "#ref-for-dom-interactionoutput-2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-3">6.2.4 The create
        interaction request algorithm</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-4">6.2.5 The parse
        interaction response algorithm</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-5">6.3 Using
        InteractionInput and InteractionOutput</a> <a href=
        "#ref-for-dom-interactionoutput-6">(2)</a> <a href=
        "#ref-for-dom-interactionoutput-7">(3)</a> <a href=
        "#ref-for-dom-interactionoutput-8">(4)</a> <a href=
        "#ref-for-dom-interactionoutput-9">(5)</a> <a href=
        "#ref-for-dom-interactionoutput-10">(6)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-11">7. The
        ConsumedThing interface</a> <a href=
        "#ref-for-dom-interactionoutput-12">(2)</a> <a href=
        "#ref-for-dom-interactionoutput-13">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-14">7.4 The
        readProperty() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-15">7.10 The
        invokeAction() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-16">7.14 The
        InteractionListener callback</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-17">7.17
        ConsumedThing Examples</a> <a href=
        "#ref-for-dom-interactionoutput-18">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-19">8. The
        ExposedThing interface</a> <a href=
        "#ref-for-dom-interactionoutput-20">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-21">8.9 The
        setPropertyObserveHandler() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-22">8.14 The
        PropertyWriteHandler callback</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-23">8.21 The
        EventListenerHandler callback</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-24">C. Full Web
        IDL</a> <a href="#ref-for-dom-interactionoutput-25">(2)</a>
        <a href="#ref-for-dom-interactionoutput-26">(3)</a>
        <a href="#ref-for-dom-interactionoutput-27">(4)</a>
        <a href="#ref-for-dom-interactionoutput-28">(5)</a>
        <a href="#ref-for-dom-interactionoutput-29">(6)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoutput-data">
    <div>
      <a class="self-link" href=
      "#dom-interactionoutput-data">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-761188038">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoutput-data-1">6.2 The
        InteractionOutput interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-data-2">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoutput-dataused">
    <div>
      <a class="self-link" href=
      "#dom-interactionoutput-dataused">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-761188038">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoutput-dataused-1">6.2 The
        InteractionOutput interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-dataused-2">C. Full
        Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoutput-form">
    <div>
      <a class="self-link" href=
      "#dom-interactionoutput-form">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-761188038">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoutput-form-1">6.2 The
        InteractionOutput interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-form-2">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoutput-schema">
    <div>
      <a class="self-link" href=
      "#dom-interactionoutput-schema">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-761188038">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoutput-schema-1">6.2 The
        InteractionOutput interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-schema-2">C. Full
        Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-value">
    <div>
      <a class="self-link" href="#dfn-value">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-value-1">6.2.1 The value()
        function</a> <a href="#ref-for-dfn-value-2">(2)</a>
        <a href="#ref-for-dfn-value-3">(3)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoutput-value">
    <div>
      <a class="self-link" href=
      "#dom-interactionoutput-value">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-761188038">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoutput-value-1">6.2 The
        InteractionOutput interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-value-2">C. Full
        Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoutput-arraybuffer">
    <div>
      <a class="self-link" href=
      "#dom-interactionoutput-arraybuffer">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-761188038">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoutput-arraybuffer-1">6.2
        The InteractionOutput interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoutput-arraybuffer-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-check-data-schema">
    <div>
      <a class="self-link" href=
      "#dfn-check-data-schema">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-check-data-schema-1">6.2.1 The
        value() function</a>
      </li>
      <li>
        <a href="#ref-for-dfn-check-data-schema-2">6.2.3 The check
        data schema algorithm</a> <a href=
        "#ref-for-dfn-check-data-schema-3">(2)</a> <a href=
        "#ref-for-dfn-check-data-schema-4">(3)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-create-interaction-request">
    <div>
      <a class="self-link" href=
      "#dfn-create-interaction-request">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-create-interaction-request-1">6.2.4
        The create interaction request algorithm</a> <a href=
        "#ref-for-dfn-create-interaction-request-2">(2)</a>
        <a href="#ref-for-dfn-create-interaction-request-3">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-create-interaction-request-4">7.7 The
        writeProperty() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-create-interaction-request-5">7.8 The
        writeMultipleProperties() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-create-interaction-request-6">7.10
        The invokeAction() method</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-parse-interaction-response">
    <div>
      <a class="self-link" href=
      "#dfn-parse-interaction-response">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-parse-interaction-response-1">6.2.5
        The parse interaction response algorithm</a>
      </li>
      <li>
        <a href="#ref-for-dfn-parse-interaction-response-2">7.4 The
        readProperty() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-parse-interaction-response-3">7.5 The
        readMultipleProperties() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-parse-interaction-response-4">7.6 The
        readAllProperties() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-parse-interaction-response-5">7.9 The
        observeProperty() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-parse-interaction-response-6">7.10
        The invokeAction() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-parse-interaction-response-7">7.11
        The subscribeEvent() method</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing">
    <div>
      <a class="self-link" href="#dom-consumedthing">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-consumedthing-1">3. Conformance</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-2">5.1 The consume()
        method</a> <a href="#ref-for-dom-consumedthing-3">(2)</a>
        <a href="#ref-for-dom-consumedthing-4">(3)</a> <a href=
        "#ref-for-dom-consumedthing-5">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-6">5.2 The produce()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-7">6.2.4 The create
        interaction request algorithm</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-8">6.2.5 The parse
        interaction response algorithm</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-9">6.3 Using
        InteractionInput and InteractionOutput</a> <a href=
        "#ref-for-dom-consumedthing-10">(2)</a> <a href=
        "#ref-for-dom-consumedthing-11">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-12">7. The
        ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-13">7.1 Internal slots
        for ConsumedThing</a> <a href=
        "#ref-for-dom-consumedthing-14">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-15">7.2 Constructing
        ConsumedThing</a> <a href=
        "#ref-for-dom-consumedthing-16">(2)</a> <a href=
        "#ref-for-dom-consumedthing-17">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-18">7.3 The
        getThingDescription() method</a> <a href=
        "#ref-for-dom-consumedthing-19">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-20">7.17 ConsumedThing
        Examples</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-21">8.2 Constructing
        ExposedThing</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-22">A.3 Factory vs
        constructors</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-23">C. Full Web IDL</a>
        <a href="#ref-for-dom-consumedthing-24">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing-constructor">
    <div>
      <a class="self-link" href=
      "#dom-consumedthing-constructor">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-td">
    <div>
      <a class="self-link" href="#dfn-td">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing-getthingdescription">
    <div>
      <a class="self-link" href=
      "#dom-consumedthing-getthingdescription">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dom-consumedthing-getthingdescription-1">7. The
        ConsumedThing interface</a>
      </li>
      <li>
        <a href=
        "#ref-for-dom-consumedthing-getthingdescription-2">C. Full
        Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing-readproperty">
    <div>
      <a class="self-link" href=
      "#dom-consumedthing-readproperty">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-consumedthing-readproperty-1">7. The
        ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-readproperty-2">C. Full
        Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing-readmultipleproperties">
    <div>
      <a class="self-link" href=
      "#dom-consumedthing-readmultipleproperties">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dom-consumedthing-readmultipleproperties-1">7.
        The ConsumedThing interface</a>
      </li>
      <li>
        <a href=
        "#ref-for-dom-consumedthing-readmultipleproperties-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing-readallproperties">
    <div>
      <a class="self-link" href=
      "#dom-consumedthing-readallproperties">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-consumedthing-readallproperties-1">7.
        The ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-readallproperties-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing-writeproperty">
    <div>
      <a class="self-link" href=
      "#dom-consumedthing-writeproperty">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-consumedthing-writeproperty-1">7. The
        ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-writeproperty-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing-writemultipleproperties">
    <div>
      <a class="self-link" href=
      "#dom-consumedthing-writemultipleproperties">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dom-consumedthing-writemultipleproperties-1">7.
        The ConsumedThing interface</a>
      </li>
      <li>
        <a href=
        "#ref-for-dom-consumedthing-writemultipleproperties-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing-observeproperty">
    <div>
      <a class="self-link" href=
      "#dom-consumedthing-observeproperty">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-consumedthing-observeproperty-1">7.
        The ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-observeproperty-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing-invokeaction">
    <div>
      <a class="self-link" href=
      "#dom-consumedthing-invokeaction">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-consumedthing-invokeaction-1">7. The
        ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-invokeaction-2">C. Full
        Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-consumedthing-subscribeevent">
    <div>
      <a class="self-link" href=
      "#dom-consumedthing-subscribeevent">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-consumedthing-subscribeevent-1">7.
        The ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-consumedthing-subscribeevent-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoptions">
    <div>
      <a class="self-link" href=
      "#dom-interactionoptions">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoptions-1">7. The
        ConsumedThing interface</a> <a href=
        "#ref-for-dom-interactionoptions-2">(2)</a> <a href=
        "#ref-for-dom-interactionoptions-3">(3)</a> <a href=
        "#ref-for-dom-interactionoptions-4">(4)</a> <a href=
        "#ref-for-dom-interactionoptions-5">(5)</a> <a href=
        "#ref-for-dom-interactionoptions-6">(6)</a> <a href=
        "#ref-for-dom-interactionoptions-7">(7)</a> <a href=
        "#ref-for-dom-interactionoptions-8">(8)</a> <a href=
        "#ref-for-dom-interactionoptions-9">(9)</a> <a href=
        "#ref-for-dom-interactionoptions-10">(10)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoptions-11">8. The
        ExposedThing interface</a> <a href=
        "#ref-for-dom-interactionoptions-12">(2)</a> <a href=
        "#ref-for-dom-interactionoptions-13">(3)</a> <a href=
        "#ref-for-dom-interactionoptions-14">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoptions-15">C. Full Web
        IDL</a> <a href=
        "#ref-for-dom-interactionoptions-16">(2)</a> <a href=
        "#ref-for-dom-interactionoptions-17">(3)</a> <a href=
        "#ref-for-dom-interactionoptions-18">(4)</a> <a href=
        "#ref-for-dom-interactionoptions-19">(5)</a> <a href=
        "#ref-for-dom-interactionoptions-20">(6)</a> <a href=
        "#ref-for-dom-interactionoptions-21">(7)</a> <a href=
        "#ref-for-dom-interactionoptions-22">(8)</a> <a href=
        "#ref-for-dom-interactionoptions-23">(9)</a> <a href=
        "#ref-for-dom-interactionoptions-24">(10)</a> <a href=
        "#ref-for-dom-interactionoptions-25">(11)</a> <a href=
        "#ref-for-dom-interactionoptions-26">(12)</a> <a href=
        "#ref-for-dom-interactionoptions-27">(13)</a> <a href=
        "#ref-for-dom-interactionoptions-28">(14)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoptions-formindex">
    <div>
      <a class="self-link" href=
      "#dom-interactionoptions-formindex">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoptions-formindex-1">7.
        The ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoptions-formindex-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoptions-urivariables">
    <div>
      <a class="self-link" href=
      "#dom-interactionoptions-urivariables">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoptions-urivariables-1">7.
        The ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoptions-urivariables-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionoptions-data">
    <div>
      <a class="self-link" href=
      "#dom-interactionoptions-data">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionoptions-data-1">7. The
        ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionoptions-data-2">C. Full
        Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-propertymap">
    <div>
      <a class="self-link" href="#dom-propertymap">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-propertymap-1">7. The ConsumedThing
        interface</a> <a href="#ref-for-dom-propertymap-2">(2)</a>
        <a href="#ref-for-dom-propertymap-3">(3)</a> <a href=
        "#ref-for-dom-propertymap-4">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dom-propertymap-5">7.5 The
        readMultipleProperties() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-propertymap-6">7.6 The
        readAllProperties() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-propertymap-7">C. Full Web IDL</a>
        <a href="#ref-for-dom-propertymap-8">(2)</a> <a href=
        "#ref-for-dom-propertymap-9">(3)</a> <a href=
        "#ref-for-dom-propertymap-10">(4)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-interactionlistener">
    <div>
      <a class="self-link" href=
      "#dom-interactionlistener">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-interactionlistener-1">7. The
        ConsumedThing interface</a> <a href=
        "#ref-for-dom-interactionlistener-2">(2)</a> <a href=
        "#ref-for-dom-interactionlistener-3">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-interactionlistener-4">C. Full Web
        IDL</a> <a href=
        "#ref-for-dom-interactionlistener-5">(2)</a> <a href=
        "#ref-for-dom-interactionlistener-6">(3)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-errorlistener">
    <div>
      <a class="self-link" href="#dom-errorlistener">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-errorlistener-1">7. The ConsumedThing
        interface</a> <a href=
        "#ref-for-dom-errorlistener-2">(2)</a> <a href=
        "#ref-for-dom-errorlistener-3">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-errorlistener-4">C. Full Web IDL</a>
        <a href="#ref-for-dom-errorlistener-5">(2)</a> <a href=
        "#ref-for-dom-errorlistener-6">(3)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-subscription">
    <div>
      <a class="self-link" href="#dom-subscription">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-subscription-1">7. The ConsumedThing
        interface</a> <a href="#ref-for-dom-subscription-2">(2)</a>
        <a href="#ref-for-dom-subscription-3">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-subscription-4">7.9 The
        observeProperty() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-subscription-5">7.11 The
        subscribeEvent() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-subscription-6">7.16.1 Internal slots
        for Subscription</a> <a href=
        "#ref-for-dom-subscription-7">(2)</a> <a href=
        "#ref-for-dom-subscription-8">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-subscription-9">7.16.3 Finding an
        unsubscribe Form</a>
      </li>
      <li>
        <a href="#ref-for-dom-subscription-10">C. Full Web IDL</a>
        <a href="#ref-for-dom-subscription-11">(2)</a> <a href=
        "#ref-for-dom-subscription-12">(3)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-subscription-active">
    <div>
      <a class="self-link" href=
      "#dom-subscription-active">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-subscription-active-1">7. The
        ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-subscription-active-2">7.16.2 The
        stop() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-subscription-active-3">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-type">
    <div>
      <a class="self-link" href="#dfn-type">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-name">
    <div>
      <a class="self-link" href="#dfn-name">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-interaction">
    <div>
      <a class="self-link" href="#dfn-interaction">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-form-0">
    <div>
      <a class="self-link" href="#dfn-form-0">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-subscription-stop">
    <div>
      <a class="self-link" href=
      "#dom-subscription-stop">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1146575940">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-subscription-stop-1">7. The
        ConsumedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-subscription-stop-2">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-find-a-matching-unsubscribe-form">
    <div>
      <a class="self-link" href=
      "#dfn-find-a-matching-unsubscribe-form">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dfn-find-a-matching-unsubscribe-form-1">7.16.2
        The stop() method</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing">
    <div>
      <a class="self-link" href="#dom-exposedthing">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-exposedthing-1">3. Conformance</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-2">5.2 The produce()
        method</a> <a href="#ref-for-dom-exposedthing-3">(2)</a>
        <a href="#ref-for-dom-exposedthing-4">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-5">6.3 Using
        InteractionInput and InteractionOutput</a> <a href=
        "#ref-for-dom-exposedthing-6">(2)</a> <a href=
        "#ref-for-dom-exposedthing-7">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-8">8. The ExposedThing
        interface</a> <a href="#ref-for-dom-exposedthing-9">(2)</a>
        <a href="#ref-for-dom-exposedthing-10">(3)</a> <a href=
        "#ref-for-dom-exposedthing-11">(4)</a> <a href=
        "#ref-for-dom-exposedthing-12">(5)</a> <a href=
        "#ref-for-dom-exposedthing-13">(6)</a> <a href=
        "#ref-for-dom-exposedthing-14">(7)</a> <a href=
        "#ref-for-dom-exposedthing-15">(8)</a> <a href=
        "#ref-for-dom-exposedthing-16">(9)</a> <a href=
        "#ref-for-dom-exposedthing-17">(10)</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-18">8.1 Internal slots
        for ExposedThing</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-19">8.2 Constructing
        ExposedThing</a> <a href=
        "#ref-for-dom-exposedthing-20">(2)</a> <a href=
        "#ref-for-dom-exposedthing-21">(3)</a> <a href=
        "#ref-for-dom-exposedthing-22">(4)</a> <a href=
        "#ref-for-dom-exposedthing-23">(5)</a> <a href=
        "#ref-for-dom-exposedthing-24">(6)</a> <a href=
        "#ref-for-dom-exposedthing-25">(7)</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-26">8.3 The
        getThingDescription() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-27">8.5 The
        setPropertyReadHandler() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-28">8.32 ExposedThing
        Examples</a> <a href="#ref-for-dom-exposedthing-29">(2)</a>
        <a href="#ref-for-dom-exposedthing-30">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-31">A.3 Factory vs
        constructors</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-32">C. Full Web IDL</a>
        <a href="#ref-for-dom-exposedthing-33">(2)</a> <a href=
        "#ref-for-dom-exposedthing-34">(3)</a> <a href=
        "#ref-for-dom-exposedthing-35">(4)</a> <a href=
        "#ref-for-dom-exposedthing-36">(5)</a> <a href=
        "#ref-for-dom-exposedthing-37">(6)</a> <a href=
        "#ref-for-dom-exposedthing-38">(7)</a> <a href=
        "#ref-for-dom-exposedthing-39">(8)</a> <a href=
        "#ref-for-dom-exposedthing-40">(9)</a> <a href=
        "#ref-for-dom-exposedthing-41">(10)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-getthingdescription">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-getthingdescription">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-getthingdescription-1">8. The
        ExposedThing interface</a>
      </li>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-getthingdescription-2">C. Full
        Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-propertyreadhandler">
    <div>
      <a class="self-link" href=
      "#dom-propertyreadhandler">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-propertyreadhandler-1">8. The
        ExposedThing interface</a> <a href=
        "#ref-for-dom-propertyreadhandler-2">(2)</a> <a href=
        "#ref-for-dom-propertyreadhandler-3">(3)</a> <a href=
        "#ref-for-dom-propertyreadhandler-4">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dom-propertyreadhandler-5">C. Full Web
        IDL</a> <a href=
        "#ref-for-dom-propertyreadhandler-6">(2)</a> <a href=
        "#ref-for-dom-propertyreadhandler-7">(3)</a> <a href=
        "#ref-for-dom-propertyreadhandler-8">(4)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-setpropertyreadhandler">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-setpropertyreadhandler">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-setpropertyreadhandler-1">8. The
        ExposedThing interface</a>
      </li>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-setpropertyreadhandler-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-read-server-property">
    <div>
      <a class="self-link" href=
      "#dfn-read-server-property">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-read-server-property-1">8.7 Handling
        requests for reading multiple Properties</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-read-multiple-properties">
    <div>
      <a class="self-link" href=
      "#dfn-read-multiple-properties">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-read-multiple-properties-1">8.8
        Handling requests for reading all Properties</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-setpropertyobservehandler">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-setpropertyobservehandler">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-setpropertyobservehandler-1">8.
        The ExposedThing interface</a>
      </li>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-setpropertyobservehandler-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-setpropertyunobservehandler">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-setpropertyunobservehandler">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-setpropertyunobservehandler-1">8.
        The ExposedThing interface</a>
      </li>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-setpropertyunobservehandler-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-emitpropertychange">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-emitpropertychange">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-exposedthing-emitpropertychange-1">8.
        The ExposedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-emitpropertychange-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-propertywritehandler">
    <div>
      <a class="self-link" href=
      "#dom-propertywritehandler">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-propertywritehandler-1">8. The
        ExposedThing interface</a> <a href=
        "#ref-for-dom-propertywritehandler-2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-propertywritehandler-3">C. Full Web
        IDL</a> <a href=
        "#ref-for-dom-propertywritehandler-4">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-setpropertywritehandler">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-setpropertywritehandler">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-setpropertywritehandler-1">8.
        The ExposedThing interface</a>
      </li>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-setpropertywritehandler-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-update-property-steps">
    <div>
      <a class="self-link" href=
      "#dfn-update-property-steps">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-update-property-steps-1">8.17
        Handling requests for writing multiple Properties</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-actionhandler">
    <div>
      <a class="self-link" href="#dom-actionhandler">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-actionhandler-1">8. The ExposedThing
        interface</a> <a href=
        "#ref-for-dom-actionhandler-2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-actionhandler-3">8.18 The
        ActionHandler callback</a>
      </li>
      <li>
        <a href="#ref-for-dom-actionhandler-4">C. Full Web IDL</a>
        <a href="#ref-for-dom-actionhandler-5">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-setactionhandler">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-setactionhandler">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-exposedthing-setactionhandler-1">8.
        The ExposedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-setactionhandler-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-eventlistenerhandler">
    <div>
      <a class="self-link" href=
      "#dom-eventlistenerhandler">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-eventlistenerhandler-1">8. The
        ExposedThing interface</a> <a href=
        "#ref-for-dom-eventlistenerhandler-2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-eventlistenerhandler-3">8.21 The
        EventListenerHandler callback</a>
      </li>
      <li>
        <a href="#ref-for-dom-eventlistenerhandler-4">C. Full Web
        IDL</a> <a href=
        "#ref-for-dom-eventlistenerhandler-5">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-eventsubscriptionhandler">
    <div>
      <a class="self-link" href=
      "#dom-eventsubscriptionhandler">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-eventsubscriptionhandler-1">8. The
        ExposedThing interface</a> <a href=
        "#ref-for-dom-eventsubscriptionhandler-2">(2)</a> <a href=
        "#ref-for-dom-eventsubscriptionhandler-3">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-eventsubscriptionhandler-4">C. Full
        Web IDL</a> <a href=
        "#ref-for-dom-eventsubscriptionhandler-5">(2)</a> <a href=
        "#ref-for-dom-eventsubscriptionhandler-6">(3)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-seteventsubscribehandler">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-seteventsubscribehandler">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-seteventsubscribehandler-1">8.
        The ExposedThing interface</a>
      </li>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-seteventsubscribehandler-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-seteventunsubscribehandler">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-seteventunsubscribehandler">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-seteventunsubscribehandler-1">8.
        The ExposedThing interface</a>
      </li>
      <li>
        <a href=
        "#ref-for-dom-exposedthing-seteventunsubscribehandler-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-seteventhandler">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-seteventhandler">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-exposedthing-seteventhandler-1">8.
        The ExposedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-seteventhandler-2">C.
        Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-emitevent">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-emitevent">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-exposedthing-emitevent-1">8. The
        ExposedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-emitevent-2">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-expose">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-expose">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-exposedthing-expose-1">8. The
        ExposedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-expose-2">8.2
        Constructing ExposedThing</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-expose-3">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-internal-observer-list">
    <div>
      <a class="self-link" href=
      "#dfn-internal-observer-list">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-internal-observer-list-1">8.10
        Handling Property observe requests</a>
      </li>
      <li>
        <a href="#ref-for-dfn-internal-observer-list-2">8.12
        Handling Property unobserve requests</a> <a href=
        "#ref-for-dfn-internal-observer-list-3">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-internal-observer-list-4">8.13 The
        emitPropertyChange() method</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-internal-listener-list">
    <div>
      <a class="self-link" href=
      "#dfn-internal-listener-list">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-internal-listener-list-1">8.24
        Handling Event subscribe requests</a>
      </li>
      <li>
        <a href="#ref-for-dfn-internal-listener-list-2">8.26
        Handling Event unsubscribe requests</a> <a href=
        "#ref-for-dfn-internal-listener-list-3">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-internal-listener-list-4">8.28
        Handling Events</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-exposedthing-destroy">
    <div>
      <a class="self-link" href=
      "#dom-exposedthing-destroy">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1464445319">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-exposedthing-destroy-1">8. The
        ExposedThing interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-exposedthing-destroy-2">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingdiscovery">
    <div>
      <a class="self-link" href="#dom-thingdiscovery">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-989583368">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingdiscovery-1">3. Conformance</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-2">5.3 The discover()
        method</a> <a href="#ref-for-dom-thingdiscovery-3">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-4">9. The
        ThingDiscovery interface</a> <a href=
        "#ref-for-dom-thingdiscovery-5">(2)</a> <a href=
        "#ref-for-dom-thingdiscovery-6">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-7">9.1 Constructing
        ThingDiscovery</a> <a href=
        "#ref-for-dom-thingdiscovery-8">(2)</a> <a href=
        "#ref-for-dom-thingdiscovery-9">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-10">C. Full Web
        IDL</a> <a href="#ref-for-dom-thingdiscovery-11">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingdiscovery-constructor">
    <div>
      <a class="self-link" href=
      "#dom-thingdiscovery-constructor">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-discovery-results">
    <div>
      <a class="self-link" href=
      "#dfn-discovery-results">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-discovery-results-1">9. The
        ThingDiscovery interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-discovery-results-2">9.1 Constructing
        ThingDiscovery</a> <a href=
        "#ref-for-dfn-discovery-results-3">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-discovery-results-4">9.4 The start()
        method</a> <a href=
        "#ref-for-dfn-discovery-results-5">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-discovery-results-6">9.5 The next()
        method</a> <a href=
        "#ref-for-dfn-discovery-results-7">(2)</a> <a href=
        "#ref-for-dfn-discovery-results-8">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-discovery-results-9">9.7 Discovery
        Examples</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingdiscovery-filter">
    <div>
      <a class="self-link" href=
      "#dom-thingdiscovery-filter">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-989583368">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingdiscovery-filter-1">9. The
        ThingDiscovery interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-filter-2">9.1
        Constructing ThingDiscovery</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-filter-3">9.4 The
        start() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-filter-4">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingdiscovery-active">
    <div>
      <a class="self-link" href=
      "#dom-thingdiscovery-active">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-989583368">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingdiscovery-active-1">9. The
        ThingDiscovery interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-active-2">9.1
        Constructing ThingDiscovery</a> <a href=
        "#ref-for-dom-thingdiscovery-active-3">(2)</a> <a href=
        "#ref-for-dom-thingdiscovery-active-4">(3)</a> <a href=
        "#ref-for-dom-thingdiscovery-active-5">(4)</a> <a href=
        "#ref-for-dom-thingdiscovery-active-6">(5)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-active-7">9.4 The
        start() method</a> <a href=
        "#ref-for-dom-thingdiscovery-active-8">(2)</a> <a href=
        "#ref-for-dom-thingdiscovery-active-9">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-active-10">9.5 The
        next() method</a> <a href=
        "#ref-for-dom-thingdiscovery-active-11">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-active-12">9.6 The
        stop() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-active-13">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingdiscovery-done">
    <div>
      <a class="self-link" href=
      "#dom-thingdiscovery-done">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-989583368">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingdiscovery-done-1">9. The
        ThingDiscovery interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-done-2">9.1
        Constructing ThingDiscovery</a> <a href=
        "#ref-for-dom-thingdiscovery-done-3">(2)</a> <a href=
        "#ref-for-dom-thingdiscovery-done-4">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-done-5">9.5 The next()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-done-6">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingdiscovery-error">
    <div>
      <a class="self-link" href=
      "#dom-thingdiscovery-error">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-989583368">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingdiscovery-error-1">9. The
        ThingDiscovery interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-error-2">9.1
        Constructing ThingDiscovery</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-error-3">9.4 The
        start() method</a> <a href=
        "#ref-for-dom-thingdiscovery-error-4">(2)</a> <a href=
        "#ref-for-dom-thingdiscovery-error-5">(3)</a> <a href=
        "#ref-for-dom-thingdiscovery-error-6">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-error-7">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-discoverymethod">
    <div>
      <a class="self-link" href=
      "#dom-discoverymethod">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-2108018476">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-discoverymethod-1">9.2 The
        DiscoveryMethod enumeration</a>
      </li>
      <li>
        <a href="#ref-for-dom-discoverymethod-2">9.3 The
        ThingFilter dictionary</a>
      </li>
      <li>
        <a href="#ref-for-dom-discoverymethod-3">C. Full Web
        IDL</a> <a href="#ref-for-dom-discoverymethod-4">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-any">
    <div>
      <a class="self-link" href="#dfn-any">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-local">
    <div>
      <a class="self-link" href="#dfn-local">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-directory">
    <div>
      <a class="self-link" href="#dfn-directory">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-multicast">
    <div>
      <a class="self-link" href="#dfn-multicast">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingfilter">
    <div>
      <a class="self-link" href="#dom-thingfilter">Permalink</a>
      <span class="marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1705581706">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingfilter-1">5.3 The discover()
        method</a> <a href="#ref-for-dom-thingfilter-2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-3">9. The ThingDiscovery
        interface</a> <a href="#ref-for-dom-thingfilter-4">(2)</a>
        <a href="#ref-for-dom-thingfilter-5">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-6">9.1 Constructing
        ThingDiscovery</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-7">9.3 The ThingFilter
        dictionary</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-8">C. Full Web IDL</a>
        <a href="#ref-for-dom-thingfilter-9">(2)</a> <a href=
        "#ref-for-dom-thingfilter-10">(3)</a> <a href=
        "#ref-for-dom-thingfilter-11">(4)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingfilter-method">
    <div>
      <a class="self-link" href=
      "#dom-thingfilter-method">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1705581706">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingfilter-method-1">9.3 The
        ThingFilter dictionary</a> <a href=
        "#ref-for-dom-thingfilter-method-2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-method-3">9.4 The start()
        method</a> <a href=
        "#ref-for-dom-thingfilter-method-4">(2)</a> <a href=
        "#ref-for-dom-thingfilter-method-5">(3)</a> <a href=
        "#ref-for-dom-thingfilter-method-6">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-method-7">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingfilter-url">
    <div>
      <a class="self-link" href=
      "#dom-thingfilter-url">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1705581706">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingfilter-url-1">9.3 The
        ThingFilter dictionary</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-url-2">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingfilter-query">
    <div>
      <a class="self-link" href=
      "#dom-thingfilter-query">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1705581706">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingfilter-query-1">9.3 The
        ThingFilter dictionary</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-query-2">9.4 The start()
        method</a> <a href=
        "#ref-for-dom-thingfilter-query-3">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-query-4">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingfilter-fragment">
    <div>
      <a class="self-link" href=
      "#dom-thingfilter-fragment">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-1705581706">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingfilter-fragment-1">9.3 The
        ThingFilter dictionary</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-fragment-2">9.4 The
        start() method</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingfilter-fragment-3">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingdiscovery-start">
    <div>
      <a class="self-link" href=
      "#dom-thingdiscovery-start">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-989583368">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingdiscovery-start-1">9. The
        ThingDiscovery interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-start-2">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingdiscovery-next">
    <div>
      <a class="self-link" href=
      "#dom-thingdiscovery-next">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-989583368">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingdiscovery-next-1">9. The
        ThingDiscovery interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-next-2">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dom-thingdiscovery-stop">
    <div>
      <a class="self-link" href=
      "#dom-thingdiscovery-stop">Permalink</a> <span class=
      "marker dfn-exported" title=
      "Definition can be referenced by other specifications">exported</span>
      <a class="marker idl-block" title="Jump to IDL declaration"
      href="#webidl-989583368">IDL</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dom-thingdiscovery-stop-1">9. The
        ThingDiscovery interface</a>
      </li>
      <li>
        <a href="#ref-for-dom-thingdiscovery-stop-2">C. Full Web
        IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-things">
    <div>
      <a class="self-link" href="#dfn-things">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-things-1">Abstract</a> <a href=
        "#ref-for-dfn-things-2">(2)</a> <a href=
        "#ref-for-dfn-things-3">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-4">1. Introduction</a>
        <a href="#ref-for-dfn-things-5">(2)</a> <a href=
        "#ref-for-dfn-things-6">(3)</a> <a href=
        "#ref-for-dfn-things-7">(4)</a> <a href=
        "#ref-for-dfn-things-8">(5)</a> <a href=
        "#ref-for-dfn-things-9">(6)</a> <a href=
        "#ref-for-dfn-things-10">(7)</a> <a href=
        "#ref-for-dfn-things-11">(8)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-12">2.1 Consuming a Thing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-13">2.2 Exposing a Thing</a>
        <a href="#ref-for-dfn-things-14">(2)</a> <a href=
        "#ref-for-dfn-things-15">(3)</a> <a href=
        "#ref-for-dfn-things-16">(4)</a> <a href=
        "#ref-for-dfn-things-17">(5)</a> <a href=
        "#ref-for-dfn-things-18">(6)</a> <a href=
        "#ref-for-dfn-things-19">(7)</a> <a href=
        "#ref-for-dfn-things-20">(8)</a> <a href=
        "#ref-for-dfn-things-21">(9)</a> <a href=
        "#ref-for-dfn-things-22">(10)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-23">2.3 Discovery</a> <a href=
        "#ref-for-dfn-things-24">(2)</a> <a href=
        "#ref-for-dfn-things-25">(3)</a> <a href=
        "#ref-for-dfn-things-26">(4)</a> <a href=
        "#ref-for-dfn-things-27">(5)</a> <a href=
        "#ref-for-dfn-things-28">(6)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-29">5.1 The consume()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-30">7. The ConsumedThing
        interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-31">7.3 The
        getThingDescription() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-32">7.6 The
        readAllProperties() method</a> <a href=
        "#ref-for-dfn-things-33">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-34">7.8 The
        writeMultipleProperties() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-35">8. The ExposedThing
        interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-36">8.1 Internal slots for
        ExposedThing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-37">8.3 The
        getThingDescription() method</a> <a href=
        "#ref-for-dfn-things-38">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-39">8.8 Handling requests for
        reading all Properties</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-40">8.30 The expose()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-41">8.31 The destroy()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-42">9.2 The DiscoveryMethod
        enumeration</a> <a href="#ref-for-dfn-things-43">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-44">9.3 The ThingFilter
        dictionary</a> <a href="#ref-for-dfn-things-45">(2)</a>
        <a href="#ref-for-dfn-things-46">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-47">9.4 The start() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-48">9.7 Discovery Examples</a>
        <a href="#ref-for-dfn-things-49">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-50">11. Terminology and
        conventions</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-51">A.1.2 Simple Scripting
        API</a> <a href="#ref-for-dfn-things-52">(2)</a> <a href=
        "#ref-for-dfn-things-53">(3)</a> <a href=
        "#ref-for-dfn-things-54">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-55">A.1.3 This API, aligned
        with the Web of Things Thing Description specification</a>
        <a href="#ref-for-dfn-things-56">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-things-57">A.3 Factory vs
        constructors</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-thing-descriptions">
    <div>
      <a class="self-link" href=
      "#dfn-thing-descriptions">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-1">Abstract</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-2">1.
        Introduction</a> <a href=
        "#ref-for-dfn-thing-descriptions-3">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-4">2.1 Consuming a
        Thing</a> <a href=
        "#ref-for-dfn-thing-descriptions-5">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-6">2.2 Exposing a
        Thing</a> <a href=
        "#ref-for-dfn-thing-descriptions-7">(2)</a> <a href=
        "#ref-for-dfn-thing-descriptions-8">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-9">2.3
        Discovery</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-10">4. The
        ThingDescription type</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-11">4.2 Expanding
        a Thing Description</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-12">5.3 The
        discover() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-13">6.1 The
        InteractionInput type</a> <a href=
        "#ref-for-dfn-thing-descriptions-14">(2)</a> <a href=
        "#ref-for-dfn-thing-descriptions-15">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-16">6.2 The
        InteractionOutput interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-17">7.1 Internal
        slots for ConsumedThing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-18">7.2
        Constructing ConsumedThing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-19">7.3 The
        getThingDescription() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-20">7.12 The
        InteractionOptions dictionary</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-21">7.16.1
        Internal slots for Subscription</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-22">8.1 Internal
        slots for ExposedThing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-23">8.3 The
        getThingDescription() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-24">8.5 The
        setPropertyReadHandler() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-25">8.9 The
        setPropertyObserveHandler() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-26">8.11 The
        setPropertyUnobserveHandler() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-27">8.15 The
        setPropertyWriteHandler() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-descriptions-28">9.4 The
        start() method</a> <a href=
        "#ref-for-dfn-thing-descriptions-29">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-td-0">
    <div>
      <a class="self-link" href="#dfn-td-0">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-td-0-1">1. Introduction</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-2">2.2 Exposing a Thing</a>
        <a href="#ref-for-dfn-td-0-3">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-4">4. The ThingDescription
        type</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-5">4.1 Fetching a Thing
        Description</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-6">4.2 Expanding a Thing
        Description</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-7">4.3 Validating a Thing
        Description</a> <a href="#ref-for-dfn-td-0-8">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-9">5.1 The consume() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-10">7.6 The readAllProperties()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-11">7.7 The writeProperty()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-12">7.12 The InteractionOptions
        dictionary</a> <a href="#ref-for-dfn-td-0-13">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-14">7.17 ConsumedThing
        Examples</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-15">8.32 ExposedThing
        Examples</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-16">9. The ThingDiscovery
        interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-17">11. Terminology and
        conventions</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-18">A.2 Fetching and validating
        a TD</a> <a href="#ref-for-dfn-td-0-19">(2)</a> <a href=
        "#ref-for-dfn-td-0-20">(3)</a> <a href=
        "#ref-for-dfn-td-0-21">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-0-22">A.3 Factory vs
        constructors</a> <a href="#ref-for-dfn-td-0-23">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-web-of-things">
    <div>
      <a class="self-link" href="#dfn-web-of-things">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-web-of-things-1">Abstract</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-wot-interface">
    <div>
      <a class="self-link" href="#dfn-wot-interface">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-interface-1">Abstract</a>
        <a href="#ref-for-dfn-wot-interface-2">(2)</a> <a href=
        "#ref-for-dfn-wot-interface-3">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interface-4">1. Introduction</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interface-5">11. Terminology and
        conventions</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-protocol-bindings">
    <div>
      <a class="self-link" href=
      "#dfn-protocol-bindings">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-1">5.1 The
        consume() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-3">6.2.1 The
        value() function</a> <a href=
        "#ref-for-dfn-protocol-bindings-4">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-5">6.4 Error
        handling</a> <a href=
        "#ref-for-dfn-protocol-bindings-6">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-7">7.4 The
        readProperty() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-8">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-9">7.5 The
        readMultipleProperties() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-10">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-11">7.6 The
        readAllProperties() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-12">(2)</a> <a href=
        "#ref-for-dfn-protocol-bindings-13">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-14">7.7 The
        writeProperty() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-15">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-16">7.8 The
        writeMultipleProperties() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-17">(2)</a> <a href=
        "#ref-for-dfn-protocol-bindings-18">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-19">7.9 The
        observeProperty() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-20">7.10 The
        invokeAction() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-21">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-22">7.11 The
        subscribeEvent() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-23">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-24">7.15 The
        ErrorListener callback</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-25">7.16.2 The
        stop() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-26">(2)</a> <a href=
        "#ref-for-dfn-protocol-bindings-27">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-28">8.6 Handling
        requests for reading a Property</a> <a href=
        "#ref-for-dfn-protocol-bindings-29">(2)</a> <a href=
        "#ref-for-dfn-protocol-bindings-30">(3)</a> <a href=
        "#ref-for-dfn-protocol-bindings-31">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-32">8.7 Handling
        requests for reading multiple Properties</a> <a href=
        "#ref-for-dfn-protocol-bindings-33">(2)</a> <a href=
        "#ref-for-dfn-protocol-bindings-34">(3)</a> <a href=
        "#ref-for-dfn-protocol-bindings-35">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-36">8.8 Handling
        requests for reading all Properties</a> <a href=
        "#ref-for-dfn-protocol-bindings-37">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-38">8.10 Handling
        Property observe requests</a> <a href=
        "#ref-for-dfn-protocol-bindings-39">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-40">8.12 Handling
        Property unobserve requests</a> <a href=
        "#ref-for-dfn-protocol-bindings-41">(2)</a> <a href=
        "#ref-for-dfn-protocol-bindings-42">(3)</a> <a href=
        "#ref-for-dfn-protocol-bindings-43">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-44">8.13 The
        emitPropertyChange() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-45">8.16 Handling
        requests for writing a Property</a> <a href=
        "#ref-for-dfn-protocol-bindings-46">(2)</a> <a href=
        "#ref-for-dfn-protocol-bindings-47">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-48">8.17 Handling
        requests for writing multiple Properties</a> <a href=
        "#ref-for-dfn-protocol-bindings-49">(2)</a> <a href=
        "#ref-for-dfn-protocol-bindings-50">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-51">8.20 Handling
        Action requests</a> <a href=
        "#ref-for-dfn-protocol-bindings-52">(2)</a> <a href=
        "#ref-for-dfn-protocol-bindings-53">(3)</a> <a href=
        "#ref-for-dfn-protocol-bindings-54">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-55">8.24 Handling
        Event subscribe requests</a> <a href=
        "#ref-for-dfn-protocol-bindings-56">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-57">8.26 Handling
        Event unsubscribe requests</a> <a href=
        "#ref-for-dfn-protocol-bindings-58">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-59">8.28 Handling
        Events</a> <a href=
        "#ref-for-dfn-protocol-bindings-60">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-61">8.30 The
        expose() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-62">(2)</a> <a href=
        "#ref-for-dfn-protocol-bindings-63">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-64">8.31 The
        destroy() method</a> <a href=
        "#ref-for-dfn-protocol-bindings-65">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-protocol-bindings-66">9.4 The start()
        method</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-wot-runtime">
    <div>
      <a class="self-link" href="#dfn-wot-runtime">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-runtime-1">Abstract</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-runtime-2">1. Introduction</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-runtime-3">2.3 Discovery</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-runtime-4">9.3 The ThingFilter
        dictionary</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-runtime-5">9.7 Discovery
        Examples</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-consume">
    <div>
      <a class="self-link" href="#dfn-consume">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-consume-1">1. Introduction</a>
      </li>
      <li>
        <a href="#ref-for-dfn-consume-2">2.1 Consuming a Thing</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-thing-directory">
    <div>
      <a class="self-link" href=
      "#dfn-thing-directory">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-thing-directory-1">1.
        Introduction</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-directory-2">2.3 Discovery</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-directory-3">9.2 The
        DiscoveryMethod enumeration</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-directory-4">9.3 The
        ThingFilter dictionary</a> <a href=
        "#ref-for-dfn-thing-directory-5">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-directory-6">9.4 The start()
        method</a> <a href="#ref-for-dfn-thing-directory-7">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-thing-directory-8">9.7 Discovery
        Examples</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-properties">
    <div>
      <a class="self-link" href="#dfn-properties">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-properties-1">Abstract</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-2">1. Introduction</a>
        <a href="#ref-for-dfn-properties-3">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-4">2.1 Consuming a
        Thing</a> <a href="#ref-for-dfn-properties-5">(2)</a>
        <a href="#ref-for-dfn-properties-6">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-7">2.2 Exposing a
        Thing</a> <a href="#ref-for-dfn-properties-8">(2)</a>
        <a href="#ref-for-dfn-properties-9">(3)</a> <a href=
        "#ref-for-dfn-properties-10">(4)</a> <a href=
        "#ref-for-dfn-properties-11">(5)</a> <a href=
        "#ref-for-dfn-properties-12">(6)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-13">7.4 The readProperty()
        method</a> <a href="#ref-for-dfn-properties-14">(2)</a>
        <a href="#ref-for-dfn-properties-15">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-16">7.5 The
        readMultipleProperties() method</a> <a href=
        "#ref-for-dfn-properties-17">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-18">7.6 The
        readAllProperties() method</a> <a href=
        "#ref-for-dfn-properties-19">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-20">7.7 The
        writeProperty() method</a> <a href=
        "#ref-for-dfn-properties-21">(2)</a> <a href=
        "#ref-for-dfn-properties-22">(3)</a> <a href=
        "#ref-for-dfn-properties-23">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-24">7.8 The
        writeMultipleProperties() method</a> <a href=
        "#ref-for-dfn-properties-25">(2)</a> <a href=
        "#ref-for-dfn-properties-26">(3)</a> <a href=
        "#ref-for-dfn-properties-27">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-28">7.9 The
        observeProperty() method</a> <a href=
        "#ref-for-dfn-properties-29">(2)</a> <a href=
        "#ref-for-dfn-properties-30">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-31">7.13 The PropertyMap
        type</a> <a href="#ref-for-dfn-properties-32">(2)</a>
        <a href="#ref-for-dfn-properties-33">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-34">7.14 The
        InteractionListener callback</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-35">7.16 The Subscription
        interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-36">7.16.1 Internal slots
        for Subscription</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-37">7.16.2 The stop()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-38">8. The ExposedThing
        interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-39">8.2 Constructing
        ExposedThing</a> <a href=
        "#ref-for-dfn-properties-40">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-41">8.4 The
        PropertyReadHandler callback</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-42">8.5 The
        setPropertyReadHandler() method</a> <a href=
        "#ref-for-dfn-properties-43">(2)</a> <a href=
        "#ref-for-dfn-properties-44">(3)</a> <a href=
        "#ref-for-dfn-properties-45">(4)</a> <a href=
        "#ref-for-dfn-properties-46">(5)</a> <a href=
        "#ref-for-dfn-properties-47">(6)</a> <a href=
        "#ref-for-dfn-properties-48">(7)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-49">8.6 Handling requests
        for reading a Property</a> <a href=
        "#ref-for-dfn-properties-50">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-51">8.7 Handling requests
        for reading multiple Properties</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-52">8.8 Handling requests
        for reading all Properties</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-53">8.9 The
        setPropertyObserveHandler() method</a> <a href=
        "#ref-for-dfn-properties-54">(2)</a> <a href=
        "#ref-for-dfn-properties-55">(3)</a> <a href=
        "#ref-for-dfn-properties-56">(4)</a> <a href=
        "#ref-for-dfn-properties-57">(5)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-58">8.10 Handling Property
        observe requests</a> <a href=
        "#ref-for-dfn-properties-59">(2)</a> <a href=
        "#ref-for-dfn-properties-60">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-61">8.11 The
        setPropertyUnobserveHandler() method</a> <a href=
        "#ref-for-dfn-properties-62">(2)</a> <a href=
        "#ref-for-dfn-properties-63">(3)</a> <a href=
        "#ref-for-dfn-properties-64">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-65">8.12 Handling Property
        unobserve requests</a> <a href=
        "#ref-for-dfn-properties-66">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-67">8.13 The
        emitPropertyChange() method</a> <a href=
        "#ref-for-dfn-properties-68">(2)</a> <a href=
        "#ref-for-dfn-properties-69">(3)</a> <a href=
        "#ref-for-dfn-properties-70">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-71">8.14 The
        PropertyWriteHandler callback</a> <a href=
        "#ref-for-dfn-properties-72">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-73">8.15 The
        setPropertyWriteHandler() method</a> <a href=
        "#ref-for-dfn-properties-74">(2)</a> <a href=
        "#ref-for-dfn-properties-75">(3)</a> <a href=
        "#ref-for-dfn-properties-76">(4)</a> <a href=
        "#ref-for-dfn-properties-77">(5)</a> <a href=
        "#ref-for-dfn-properties-78">(6)</a> <a href=
        "#ref-for-dfn-properties-79">(7)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-80">8.16 Handling requests
        for writing a Property</a> <a href=
        "#ref-for-dfn-properties-81">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-82">8.17 Handling requests
        for writing multiple Properties</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-83">8.30 The expose()
        method</a> <a href="#ref-for-dfn-properties-84">(2)</a>
        <a href="#ref-for-dfn-properties-85">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-86">8.32 ExposedThing
        Examples</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-87">A.1.2 Simple Scripting
        API</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-88">A.4 Observers</a>
      </li>
      <li>
        <a href="#ref-for-dfn-properties-89">A.5 Using Events</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-actions">
    <div>
      <a class="self-link" href="#dfn-actions">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-actions-1">Abstract</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-2">1. Introduction</a>
        <a href="#ref-for-dfn-actions-3">(2)</a> <a href=
        "#ref-for-dfn-actions-4">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-5">2.1 Consuming a Thing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-6">2.2 Exposing a Thing</a>
        <a href="#ref-for-dfn-actions-7">(2)</a> <a href=
        "#ref-for-dfn-actions-8">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-9">6.3 Using InteractionInput
        and InteractionOutput</a> <a href=
        "#ref-for-dfn-actions-10">(2)</a> <a href=
        "#ref-for-dfn-actions-11">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-12">7.7 The writeProperty()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-13">7.10 The invokeAction()
        method</a> <a href="#ref-for-dfn-actions-14">(2)</a>
        <a href="#ref-for-dfn-actions-15">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-16">7.12 The
        InteractionOptions dictionary</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-17">8. The ExposedThing
        interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-18">8.2 Constructing
        ExposedThing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-19">8.18 The ActionHandler
        callback</a> <a href="#ref-for-dfn-actions-20">(2)</a>
        <a href="#ref-for-dfn-actions-21">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-22">8.19 The
        setActionHandler() method</a> <a href=
        "#ref-for-dfn-actions-23">(2)</a> <a href=
        "#ref-for-dfn-actions-24">(3)</a> <a href=
        "#ref-for-dfn-actions-25">(4)</a> <a href=
        "#ref-for-dfn-actions-26">(5)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-27">8.20 Handling Action
        requests</a> <a href="#ref-for-dfn-actions-28">(2)</a>
        <a href="#ref-for-dfn-actions-29">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-30">8.30 The expose()
        method</a> <a href="#ref-for-dfn-actions-31">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-actions-32">A.1.2 Simple Scripting
        API</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-events">
    <div>
      <a class="self-link" href="#dfn-events">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-events-1">Abstract</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-2">1. Introduction</a>
        <a href="#ref-for-dfn-events-3">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-4">2.1 Consuming a Thing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-5">2.2 Exposing a Thing</a>
        <a href="#ref-for-dfn-events-6">(2)</a> <a href=
        "#ref-for-dfn-events-7">(3)</a> <a href=
        "#ref-for-dfn-events-8">(4)</a> <a href=
        "#ref-for-dfn-events-9">(5)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-10">7.11 The subscribeEvent()
        method</a> <a href="#ref-for-dfn-events-11">(2)</a>
        <a href="#ref-for-dfn-events-12">(3)</a> <a href=
        "#ref-for-dfn-events-13">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-14">7.14 The
        InteractionListener callback</a> <a href=
        "#ref-for-dfn-events-15">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-16">7.16 The Subscription
        interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-17">7.16.1 Internal slots for
        Subscription</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-18">7.16.2 The stop()
        method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-19">8. The ExposedThing
        interface</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-20">8.2 Constructing
        ExposedThing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-21">8.21 The
        EventListenerHandler callback</a> <a href=
        "#ref-for-dfn-events-22">(2)</a> <a href=
        "#ref-for-dfn-events-23">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-24">8.22 The
        EventSubscriptionHandler callback</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-25">8.23 The
        setEventSubscribeHandler() method</a> <a href=
        "#ref-for-dfn-events-26">(2)</a> <a href=
        "#ref-for-dfn-events-27">(3)</a> <a href=
        "#ref-for-dfn-events-28">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-29">8.24 Handling Event
        subscribe requests</a> <a href=
        "#ref-for-dfn-events-30">(2)</a> <a href=
        "#ref-for-dfn-events-31">(3)</a> <a href=
        "#ref-for-dfn-events-32">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-33">8.25 The
        setEventUnsubscribeHandler() method</a> <a href=
        "#ref-for-dfn-events-34">(2)</a> <a href=
        "#ref-for-dfn-events-35">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-36">8.26 Handling Event
        unsubscribe requests</a> <a href=
        "#ref-for-dfn-events-37">(2)</a> <a href=
        "#ref-for-dfn-events-38">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-39">8.27 The setEventHandler()
        method</a> <a href="#ref-for-dfn-events-40">(2)</a>
        <a href="#ref-for-dfn-events-41">(3)</a> <a href=
        "#ref-for-dfn-events-42">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-43">8.28 Handling Events</a>
        <a href="#ref-for-dfn-events-44">(2)</a> <a href=
        "#ref-for-dfn-events-45">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-46">8.29 The emitEvent()
        method</a> <a href="#ref-for-dfn-events-47">(2)</a>
        <a href="#ref-for-dfn-events-48">(3)</a> <a href=
        "#ref-for-dfn-events-49">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-50">8.30 The expose()
        method</a> <a href="#ref-for-dfn-events-51">(2)</a>
        <a href="#ref-for-dfn-events-52">(3)</a> <a href=
        "#ref-for-dfn-events-53">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-54">A.1.2 Simple Scripting
        API</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-55">A.4 Observers</a>
      </li>
      <li>
        <a href="#ref-for-dfn-events-56">A.5 Using Events</a>
        <a href="#ref-for-dfn-events-57">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-dataschema">
    <div>
      <a class="self-link" href="#dfn-dataschema">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-dataschema-1">6. Handling interaction
        data</a> <a href="#ref-for-dfn-dataschema-2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-dataschema-3">6.1 The
        InteractionInput type</a> <a href=
        "#ref-for-dfn-dataschema-4">(2)</a> <a href=
        "#ref-for-dfn-dataschema-5">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-dataschema-6">6.2 The
        InteractionOutput interface</a> <a href=
        "#ref-for-dfn-dataschema-7">(2)</a> <a href=
        "#ref-for-dfn-dataschema-8">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-dataschema-9">6.2.1 The value()
        function</a>
      </li>
      <li>
        <a href="#ref-for-dfn-dataschema-10">7.17 ConsumedThing
        Examples</a>
      </li>
      <li>
        <a href="#ref-for-dfn-dataschema-11">8.4 The
        PropertyReadHandler callback</a>
      </li>
      <li>
        <a href="#ref-for-dfn-dataschema-12">8.6 Handling requests
        for reading a Property</a>
      </li>
      <li>
        <a href="#ref-for-dfn-dataschema-13">8.14 The
        PropertyWriteHandler callback</a>
      </li>
      <li>
        <a href="#ref-for-dfn-dataschema-14">C. Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-form">
    <div>
      <a class="self-link" href="#dfn-form">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-form-1">6. Handling interaction
        data</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-2">6.1 The InteractionInput
        type</a> <a href="#ref-for-dfn-form-3">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-4">6.2 The InteractionOutput
        interface</a> <a href="#ref-for-dfn-form-5">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-6">6.2.1 The value()
        function</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-7">7.4 The readProperty()
        method</a> <a href="#ref-for-dfn-form-8">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-9">7.5 The
        readMultipleProperties() method</a> <a href=
        "#ref-for-dfn-form-10">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-11">7.6 The readAllProperties()
        method</a> <a href="#ref-for-dfn-form-12">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-13">7.7 The writeProperty()
        method</a> <a href="#ref-for-dfn-form-14">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-15">7.8 The
        writeMultipleProperties() method</a> <a href=
        "#ref-for-dfn-form-16">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-17">7.9 The observeProperty()
        method</a> <a href="#ref-for-dfn-form-18">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-19">7.10 The invokeAction()
        method</a> <a href="#ref-for-dfn-form-20">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-21">7.11 The subscribeEvent()
        method</a> <a href="#ref-for-dfn-form-22">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-23">7.16.1 Internal slots for
        Subscription</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-24">7.16.2 The stop() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-25">7.16.3 Finding an
        unsubscribe Form</a> <a href="#ref-for-dfn-form-26">(2)</a>
        <a href="#ref-for-dfn-form-27">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-form-28">C. Full Web IDL</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-wot-interaction">
    <div>
      <a class="self-link" href=
      "#dfn-wot-interaction">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-interaction-1">Abstract</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interaction-2">2.1 Consuming a
        Thing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interaction-3">5.1 The consume()
        method</a> <a href="#ref-for-dfn-wot-interaction-4">(2)</a>
        <a href="#ref-for-dfn-wot-interaction-5">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interaction-6">6. Handling
        interaction data</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interaction-7">6.1 The
        InteractionInput type</a> <a href=
        "#ref-for-dfn-wot-interaction-8">(2)</a> <a href=
        "#ref-for-dfn-wot-interaction-9">(3)</a> <a href=
        "#ref-for-dfn-wot-interaction-10">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interaction-11">6.2 The
        InteractionOutput interface</a> <a href=
        "#ref-for-dfn-wot-interaction-12">(2)</a> <a href=
        "#ref-for-dfn-wot-interaction-13">(3)</a> <a href=
        "#ref-for-dfn-wot-interaction-14">(4)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interaction-15">6.2.1 The value()
        function</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interaction-16">7.16.1 Internal
        slots for Subscription</a> <a href=
        "#ref-for-dfn-wot-interaction-17">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interaction-18">8.30 The expose()
        method</a> <a href=
        "#ref-for-dfn-wot-interaction-19">(2)</a> <a href=
        "#ref-for-dfn-wot-interaction-20">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interaction-21">8.31 The
        destroy() method</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-interaction-22">11. Terminology
        and conventions</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-interaction-affordance">
    <div>
      <a class="self-link" href=
      "#dfn-interaction-affordance">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-interaction-affordance-1">11.
        Terminology and conventions</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-wot-network-interface">
    <div>
      <a class="self-link" href=
      "#dfn-wot-network-interface">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-network-interface-1">A.1.1 No
        Scripting API</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-network-interface-2">A.1
        Approaches to WoT application development</a> <a href=
        "#ref-for-dfn-wot-network-interface-3">(2)</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-json-ld">
    <div>
      <a class="self-link" href="#dfn-json-ld">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-json-schema">
    <div>
      <a class="self-link" href="#dfn-json-schema">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>
        <a href="#ref-for-dfn-json-schema-1">6. Handling
        interaction data</a>
      </li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-url">
    <div>
      <a class="self-link" href="#dfn-url">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-url-scheme">
    <div>
      <a class="self-link" href="#dfn-url-scheme">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-url-host">
    <div>
      <a class="self-link" href="#dfn-url-host">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-url-path">
    <div>
      <a class="self-link" href="#dfn-url-path">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-url-record">
    <div>
      <a class="self-link" href="#dfn-url-record">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-parse-a-url">
    <div>
      <a class="self-link" href="#dfn-parse-a-url">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-absolute-url-string">
    <div>
      <a class="self-link" href=
      "#dfn-absolute-url-string">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-path-absolute-url-string">
    <div>
      <a class="self-link" href=
      "#dfn-path-absolute-url-string">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-basic-url-parser">
    <div>
      <a class="self-link" href=
      "#dfn-basic-url-parser">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-mime-type">
    <div>
      <a class="self-link" href="#dfn-mime-type">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-parsing-a-mime-type">
    <div>
      <a class="self-link" href=
      "#dfn-parsing-a-mime-type">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-serializing-a-mime-type">
    <div>
      <a class="self-link" href=
      "#dfn-serializing-a-mime-type">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-valid-mime-type-string">
    <div>
      <a class="self-link" href=
      "#dfn-valid-mime-type-string">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-json-mime-type">
    <div>
      <a class="self-link" href="#dfn-json-mime-type">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-utf-8-encoding">
    <div>
      <a class="self-link" href="#dfn-utf-8-encoding">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-utf-8-decode">
    <div>
      <a class="self-link" href="#dfn-utf-8-decode">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-encode">
    <div>
      <a class="self-link" href="#dfn-encode">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-decode">
    <div>
      <a class="self-link" href="#dfn-decode">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-string">
    <div>
      <a class="self-link" href="#dfn-string">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-parse-json-from-bytes">
    <div>
      <a class="self-link" href=
      "#dfn-parse-json-from-bytes">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-serialize-json-to-bytes">
    <div>
      <a class="self-link" href=
      "#dfn-serialize-json-to-bytes">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-promise">
    <div>
      <a class="self-link" href="#dfn-promise">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-error">
    <div>
      <a class="self-link" href="#dfn-error">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id="dfn-panel-for-dfn-json">
    <div>
      <a class="self-link" href="#dfn-json">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-json-stringify">
    <div>
      <a class="self-link" href="#dfn-json-stringify">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-json-parse">
    <div>
      <a class="self-link" href="#dfn-json-parse">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-internal-method">
    <div>
      <a class="self-link" href=
      "#dfn-internal-method">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-internal-slot">
    <div>
      <a class="self-link" href="#dfn-internal-slot">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-browsing-context">
    <div>
      <a class="self-link" href=
      "#dfn-browsing-context">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-top-level-browsing-context">
    <div>
      <a class="self-link" href=
      "#dfn-top-level-browsing-context">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-global-object">
    <div>
      <a class="self-link" href="#dfn-global-object">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-current-settings-object">
    <div>
      <a class="self-link" href=
      "#dfn-current-settings-object">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-in-parallel">
    <div>
      <a class="self-link" href="#dfn-in-parallel">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-secure-context">
    <div>
      <a class="self-link" href="#dfn-secure-context">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-iana-media-type">
    <div>
      <a class="self-link" href=
      "#dfn-iana-media-type">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-hyperlink-reference">
    <div>
      <a class="self-link" href=
      "#dfn-hyperlink-reference">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <aside class="dfn-panel" hidden="" id=
  "dfn-panel-for-dfn-relation-type">
    <div>
      <a class="self-link" href="#dfn-relation-type">Permalink</a>
    </div><b>Referenced in:</b>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </aside>
  <script id="respec-dfn-panel">
  (() => {
  // @ts-check
  if (document.respec) {
  document.respec.ready.then(dfnPanel);
  } else {
  dfnPanel();
  }

  function dfnPanel() {
  /** @type {HTMLElement} */
  let panel;
  document.body.addEventListener("click", event => {
    if (!(event.target instanceof HTMLElement)) return;

    /** @type {HTMLElement} */
    const el = event.target;

    const action = deriveAction(el);
    switch (action) {
      case "show": {
        if (panel) hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = el.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        displayPanel(dfn, panel, { x: event.clientX, y: event.clientY });
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        break;
      }
    }
  });
  }

  /** @param {HTMLElement} clickTarget */
  function deriveAction(clickTarget) {
  const hitALink = !!clickTarget.closest("a");
  if (clickTarget.closest("dfn, .index-term")) {
    return hitALink ? null : "show";
  }
  if (clickTarget.closest(".dfn-panel")) {
    if (hitALink) {
      const clickedSelfLink = clickTarget.classList.contains("self-link");
      return clickedSelfLink ? "hide" : "dock";
    }
    const panel = clickTarget.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : null;
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return null;
  }

  /**
  * @param {HTMLElement} dfn
  * @param {HTMLElement} panel
  * @param {{ x: number, y: number }} clickPosition
  */
  function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }
  }

  /** @param {HTMLElement} panel */
  function hidePanel(panel) {
  panel.hidden = true;
  panel.classList.remove("docked");
  }
  })()
  </script>
  <script src=
  "https://www.w3.org/scripts/TR/2016/fixup.js"></script>
</body>
</html>
